rust/mtproxy-ffi/src/jobs/core.rs:113:    unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:122:    let refcnt = unsafe { jobs_atomic_load_c_impl(&raw const (*job).j_refcnt) };
rust/mtproxy-ffi/src/jobs/core.rs:125:    let flags = unsafe { jobs_atomic_load_c_impl(&raw const (*job).j_flags) };
rust/mtproxy-ffi/src/jobs/core.rs:129:        unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:134:    if unsafe { try_lock_job(job, sigset, 0) } != 0 {
rust/mtproxy-ffi/src/jobs/core.rs:136:        unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:142:    unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:145:    if unsafe { try_lock_job(job, 0, 0) } != 0 {
rust/mtproxy-ffi/src/jobs/core.rs:147:        unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:151:        let flags_after = unsafe { jobs_atomic_load_c_impl(&raw const (*job).j_flags) };
rust/mtproxy-ffi/src/jobs/core.rs:153:            let thread = unsafe { (*job).j_thread };
rust/mtproxy-ffi/src/jobs/core.rs:156:            unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:161:        unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:344:    unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:419:    unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:469:    unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:506:            let rc = unsafe { mtproxy_ffi_jobs_tokio_dequeue_class(job_class, 0, &raw mut out) };
rust/mtproxy-ffi/src/jobs/core.rs:516:            let rc = unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:546:            unsafe { mtproxy_ffi_jobs_tokio_dequeue_class(JOB_CLASS_IO, 0, &raw mut out) },
rust/mtproxy-ffi/src/jobs/core.rs:553:            unsafe { mtproxy_ffi_jobs_tokio_dequeue_class(JOB_CLASS_IO, 0, &raw mut out) },
rust/mtproxy-ffi/src/jobs/core.rs:603:            unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:612:            unsafe {
rust/mtproxy-ffi/src/jobs/core.rs:719:            unsafe { mtproxy_ffi_jobs_tokio_timer_queue_pop(queue_id, &raw mut out) },
rust/mtproxy-ffi/src/jobs/core.rs:726:            unsafe { mtproxy_ffi_jobs_tokio_timer_queue_pop(queue_id, &raw mut out) },
rust/mtproxy-ffi/src/jobs/core.rs:746:            unsafe { mtproxy_ffi_jobs_tokio_message_queue_pop(queue_id, &raw mut out) },
rust/mtproxy-ffi/src/jobs/core.rs:753:            unsafe { mtproxy_ffi_jobs_tokio_message_queue_pop(queue_id, &raw mut out) },
rust/mtproxy-ffi/src/compat/core.rs:339:        unsafe { (self.rpc_ready)(who) }
rust/mtproxy-ffi/src/compat/core.rs:343:        unsafe { (self.rpc_close)(who) };
rust/mtproxy-ffi/src/compat/core.rs:347:        unsafe { (self.rpc_alarm)(who) };
rust/mtproxy-ffi/src/compat/core.rs:351:        unsafe { (self.rpc_wakeup)(who) };
rust/mtproxy-ffi/src/compat/core.rs:355:        unsafe { (self.fail_connection)(who, code) };
rust/mtproxy-ffi/src/compat/core.rs:359:        unsafe { (self.job_decref)(who) };
rust/mtproxy-ffi/src/compat/core.rs:363:        unsafe { (self.event_free)(event) };
rust/mtproxy-ffi/src/compat/core.rs:819:    let Some(packet_bytes) = (unsafe { slice_from_ptr(packet, packet_count) }) else {
rust/mtproxy-ffi/src/compat/core.rs:825:    let Some(out_nonce_out) = (unsafe { mut_ref_from_ptr(out_nonce.cast::<[u8; 16]>()) }) else {
rust/mtproxy-ffi/src/compat/core.rs:828:    let Some(schema_ref) = (unsafe { mut_ref_from_ptr(out_schema) }) else {
rust/mtproxy-ffi/src/compat/core.rs:831:    let Some(key_select_ref) = (unsafe { mut_ref_from_ptr(out_key_select) }) else {
rust/mtproxy-ffi/src/compat/core.rs:834:    let Some(crypto_ts_ref) = (unsafe { mut_ref_from_ptr(out_crypto_ts) }) else {
rust/mtproxy-ffi/src/compat/core.rs:837:    let Some(extra_keys_count_ref) = (unsafe { mut_ref_from_ptr(out_extra_keys_count) }) else {
rust/mtproxy-ffi/src/compat/core.rs:840:    let Some(dh_params_select_ref) = (unsafe { mut_ref_from_ptr(out_dh_params_select) }) else {
rust/mtproxy-ffi/src/compat/core.rs:843:    let Some(has_dh_params_ref) = (unsafe { mut_ref_from_ptr(out_has_dh_params) }) else {
rust/mtproxy-ffi/src/compat/core.rs:853:        match unsafe { mut_slice_from_ptr(out_extra_key_signatures, extra_count) } {
rust/mtproxy-ffi/src/compat/core.rs:889:    let Some(packet_bytes) = (unsafe { slice_from_ptr(packet, packet_count) }) else {
rust/mtproxy-ffi/src/compat/core.rs:892:    let Some(schema_ref) = (unsafe { mut_ref_from_ptr(out_schema) }) else {
rust/mtproxy-ffi/src/compat/core.rs:895:    let Some(key_select_ref) = (unsafe { mut_ref_from_ptr(out_key_select) }) else {
rust/mtproxy-ffi/src/compat/core.rs:898:    let Some(has_dh_params_ref) = (unsafe { mut_ref_from_ptr(out_has_dh_params) }) else {
rust/mtproxy-ffi/src/compat/core.rs:932:    let Some(packet_bytes) = (unsafe { slice_from_ptr(packet, packet_count) }) else {
rust/mtproxy-ffi/src/compat/core.rs:935:    let Some(schema_ref) = (unsafe { mut_ref_from_ptr(out_schema) }) else {
rust/mtproxy-ffi/src/compat/core.rs:938:    let Some(key_select_ref) = (unsafe { mut_ref_from_ptr(out_key_select) }) else {
rust/mtproxy-ffi/src/compat/core.rs:941:    let Some(has_dh_params_ref) = (unsafe { mut_ref_from_ptr(out_has_dh_params) }) else {
rust/mtproxy-ffi/src/compat/core.rs:968:    let Some(packet_bytes) = (unsafe { slice_from_ptr(packet, packet_count) }) else {
rust/mtproxy-ffi/src/compat/core.rs:971:    let Some(flags_ref) = (unsafe { mut_ref_from_ptr(out_flags) }) else {
rust/mtproxy-ffi/src/compat/core.rs:974:    let Some(sender_pid_ref) = (unsafe { mut_ref_from_ptr(out_sender_pid) }) else {
rust/mtproxy-ffi/src/compat/core.rs:977:    let Some(peer_pid_ref) = (unsafe { mut_ref_from_ptr(out_peer_pid) }) else {
rust/mtproxy-ffi/src/compat/core.rs:991:    let Some(packet_words_ref) = (unsafe { mut_ref_from_ptr(packet_words.cast::<[i32; 3]>()) })
rust/mtproxy-ffi/src/compat/core.rs:1009:    let Some(sender_pid_ref) = (unsafe { ref_from_ptr(sender_pid) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1012:    let Some(peer_pid_ref) = (unsafe { ref_from_ptr(peer_pid) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1015:    let Some(out_packet_ref) = (unsafe { mut_slice_from_ptr(out_packet, out_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1035:    let Some(sender_pid_ref) = (unsafe { ref_from_ptr(sender_pid) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1038:    let Some(out_packet_ref) = (unsafe { mut_slice_from_ptr(out_packet, out_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1051:    let Some(enable_crc32c_ref) = (unsafe { mut_ref_from_ptr(out_enable_crc32c) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1070:    let Some(out_crypto_flags_ref) = (unsafe { mut_ref_from_ptr(out_crypto_flags) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1073:    let Some(out_in_packet_num_ref) = (unsafe { mut_ref_from_ptr(out_in_packet_num) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1076:    let Some(out_out_packet_num_ref) = (unsafe { mut_ref_from_ptr(out_out_packet_num) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1092:    let Some(out_crypto_flags_ref) = (unsafe { mut_ref_from_ptr(out_crypto_flags) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1095:    let Some(out_in_packet_num_ref) = (unsafe { mut_ref_from_ptr(out_in_packet_num) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1105:    let Some(out_crypto_flags_ref) = (unsafe { mut_ref_from_ptr(out_crypto_flags) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1205:        |port| unsafe { try_open_fn(port, try_open_ctx) != 0 },
rust/mtproxy-ffi/src/compat/core.rs:1230:        |candidate| unsafe { try_open_fn(candidate, try_open_ctx) != 0 },
rust/mtproxy-ffi/src/compat/core.rs:1284:                unsafe {
rust/mtproxy-ffi/src/compat/core.rs:1448:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1456:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1464:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1472:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1480:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1492:    let Some(name_ref) = (unsafe { ref_from_ptr(name) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1495:    let Some(kind_ref) = (unsafe { mut_ref_from_ptr(out_kind) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1498:    let Some(ip_ref) = (unsafe { mut_ref_from_ptr(out_ipv4) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1501:    let name = unsafe { CStr::from_ptr(name_ref) };
rust/mtproxy-ffi/src/compat/core.rs:1525:        let Some(values) = (unsafe { slice_from_ptr(extra_key_signatures, count) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1534:    let Some(rule_text_ref) = (unsafe { ref_from_ptr(rule_text) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1538:    let rule = unsafe { CStr::from_ptr(rule_text_ref) };
rust/mtproxy-ffi/src/compat/core.rs:1550:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_payload_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1553:    let Some(h) = (unsafe { copy_bytes::<5>(header) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1571:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_skip_bytes) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1590:    let Some(domain) = (unsafe { slice_from_ptr(domain, len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1597:    let Some(random_buf) = (unsafe { copy_bytes::<16>(random) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1611:    let Some(out_size_ref) = (unsafe { mut_ref_from_ptr(out_size) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1614:    let Some(out_profile_ref) = (unsafe { mut_ref_from_ptr(out_profile) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1650:    let Some(pos_ref) = (unsafe { mut_ref_from_ptr(pos) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1659:    let Some(response_slice) = (unsafe { slice_from_ptr(response, len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1689:    let Some(response_slice) = (unsafe { slice_from_ptr(response, resp_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1692:    let Some(expected_slice) = (unsafe { slice_from_ptr(expected, exp_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1712:    let Some(pos_ref) = (unsafe { mut_ref_from_ptr(pos) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1721:    let Some(buffer_slice) = (unsafe { mut_slice_from_ptr(buffer, len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1745:    let Some(pos_ref) = (unsafe { mut_ref_from_ptr(pos) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1757:    let Some(buffer_slice) = (unsafe { mut_slice_from_ptr(buffer, buf_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1760:    let Some(data_slice) = (unsafe { slice_from_ptr(data, dat_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1785:    let Some(pos_ref) = (unsafe { mut_ref_from_ptr(pos) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1800:    let Some(buffer_slice) = (unsafe { mut_slice_from_ptr(buffer, buf_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1803:    let Some(greases_slice) = (unsafe { slice_from_ptr(greases, grs_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1828:    let Some(pos_ref) = (unsafe { mut_ref_from_ptr(pos) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1840:    let Some(buffer_slice) = (unsafe { mut_slice_from_ptr(buffer, buf_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1843:    let Some(rand_slice) = (unsafe { slice_from_ptr(rand_bytes, rnd_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1866:    let Some(pos_ref) = (unsafe { mut_ref_from_ptr(pos) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1875:    let Some(buffer_slice) = (unsafe { mut_slice_from_ptr(buffer, buf_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1878:    let Some(key_slice) = (unsafe { slice_from_ptr(public_key, 32) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1945:    let Some(code_ref) = (unsafe { mut_ref_from_ptr(code) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1961:    let Some(out_slice) = (unsafe { mut_slice_from_ptr(out.cast::<u8>(), out_count) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1973:    let Some(date_text_ref) = (unsafe { ref_from_ptr(date_text) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1976:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_time) }) else {
rust/mtproxy-ffi/src/compat/core.rs:1979:    let text = unsafe { CStr::from_ptr(date_text_ref) };
rust/mtproxy-ffi/src/compat/core.rs:2006:    let Some(out) = (unsafe { mut_slice_from_ptr(buffer.cast::<u8>(), buffer_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2022:    let Some(headers) = (unsafe { slice_from_ptr(q_headers.cast::<u8>(), headers_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2026:    let Some(name) = (unsafe { slice_from_ptr(arg_name.cast::<u8>(), name_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2044:    let Some(sizes) = (unsafe { slice_from_ptr(buffer_sizes, count) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2056:    let Some(out_word) = (unsafe { mut_ref_from_ptr(out_prefix_word) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2059:    let Some(out_bytes) = (unsafe { mut_ref_from_ptr(out_prefix_bytes) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2074:    let Some(out_len) = (unsafe { mut_ref_from_ptr(out_payload_len) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2077:    let Some(out_bytes) = (unsafe { mut_ref_from_ptr(out_header_bytes) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2082:        let Some(arr) = (unsafe { copy_bytes::<3>(remaining_bytes) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2104:    let Some(pid_ref) = (unsafe { mut_ref_from_ptr(pid) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2121:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_selected_port) }) else {
rust/mtproxy-ffi/src/compat/core.rs:2160:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_selected_port) }) else {
rust/mtproxy-ffi/src/jobs/ffi.rs:20:    let thread = unsafe { jobs_get_this_job_thread_c_impl() };
rust/mtproxy-ffi/src/jobs/ffi.rs:23:    let jt = unsafe { &mut *thread };
rust/mtproxy-ffi/src/jobs/ffi.rs:40:    let job_ref = unsafe { &mut *job };
rust/mtproxy-ffi/src/jobs/ffi.rs:59:        unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:68:    let thread = unsafe { jobs_prepare_async_create_c_impl(custom_bytes) };
rust/mtproxy-ffi/src/jobs/ffi.rs:72:    let header_size = unsafe { jobs_async_job_header_size_c_impl() };
rust/mtproxy-ffi/src/jobs/ffi.rs:81:    let p = unsafe { malloc(alloc_size).cast::<u8>() };
rust/mtproxy-ffi/src/jobs/ffi.rs:86:    let job = unsafe { p.add(align as usize).cast::<AsyncJob>() };
rust/mtproxy-ffi/src/jobs/ffi.rs:90:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:107:    let custom_ptr = unsafe { job.cast::<u8>().add(header_size) };
rust/mtproxy-ffi/src/jobs/ffi.rs:109:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:115:        unsafe { job_timer_init(job) };
rust/mtproxy-ffi/src/jobs/ffi.rs:119:        unsafe { job_message_queue_init(job) };
rust/mtproxy-ffi/src/jobs/ffi.rs:137:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:152:    let custom_bytes = unsafe { jobs_notify_job_extra_size_c_impl() };
rust/mtproxy-ffi/src/jobs/ffi.rs:158:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:175:    let job_ref = unsafe { &mut *job };
rust/mtproxy-ffi/src/jobs/ffi.rs:180:    unsafe { unlock_job(job_tag_int, job) }
rust/mtproxy-ffi/src/jobs/ffi.rs:187:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:196:    let refcnt = unsafe { jobs_atomic_load_c_impl(&raw const (*job).j_refcnt) };
rust/mtproxy-ffi/src/jobs/ffi.rs:199:        let prev = unsafe { jobs_atomic_fetch_add_c_impl(&raw mut (*job).j_refcnt, -1) };
rust/mtproxy-ffi/src/jobs/ffi.rs:204:        unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:208:    let final_refcnt = unsafe { jobs_atomic_load_c_impl(&raw const (*job).j_refcnt) };
rust/mtproxy-ffi/src/jobs/ffi.rs:211:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:220:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:229:    unsafe { job_signal_c_impl(job_tag_int, job, signo) };
rust/mtproxy-ffi/src/jobs/ffi.rs:235:    unsafe { job_decref_c_impl(job_tag_int, job) };
rust/mtproxy-ffi/src/jobs/ffi.rs:241:    unsafe { job_incref_c_impl(job) }
rust/mtproxy-ffi/src/jobs/ffi.rs:294:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:345:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:652:    unsafe {
rust/mtproxy-ffi/src/jobs/ffi.rs:734:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:30:    unsafe { get_concurrency_boundary_ffi(out) }
rust/mtproxy-ffi/src/compat/ffi.rs:39:    unsafe { get_network_boundary_ffi(out) }
rust/mtproxy-ffi/src/compat/ffi.rs:48:    unsafe { get_rpc_boundary_ffi(out) }
rust/mtproxy-ffi/src/compat/ffi.rs:57:    unsafe { get_crypto_boundary_ffi(out) }
rust/mtproxy-ffi/src/compat/ffi.rs:68:    unsafe { get_application_boundary_ffi(out) }
rust/mtproxy-ffi/src/compat/ffi.rs:100:    unsafe { resolver_gethostbyname_plan_ffi(name, out_kind, out_ipv4) }
rust/mtproxy-ffi/src/compat/ffi.rs:128:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:157:    unsafe { net_add_nat_info_ffi(rule_text) }
rust/mtproxy-ffi/src/compat/ffi.rs:239:    unsafe { net_tcp_tls_parse_header_ffi(header, out_payload_len) }
rust/mtproxy-ffi/src/compat/ffi.rs:294:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:329:    unsafe { net_tcp_rpc_ext_domain_bucket_index_ffi(domain, len) }
rust/mtproxy-ffi/src/compat/ffi.rs:340:    unsafe { net_tcp_rpc_ext_client_random_bucket_index_ffi(random) }
rust/mtproxy-ffi/src/compat/ffi.rs:356:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:410:    unsafe { net_tcp_rpc_ext_tls_read_length_ffi(response, response_len, pos) }
rust/mtproxy-ffi/src/compat/ffi.rs:427:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:458:    unsafe { net_tcp_rpc_ext_add_length_ffi(buffer, buffer_len, pos, length) }
rust/mtproxy-ffi/src/compat/ffi.rs:477:    unsafe { net_tcp_rpc_ext_add_string_ffi(buffer, buffer_len, pos, data, data_len) }
rust/mtproxy-ffi/src/compat/ffi.rs:498:    unsafe { net_tcp_rpc_ext_add_grease_ffi(buffer, buffer_len, pos, greases, greases_len, num) }
rust/mtproxy-ffi/src/compat/ffi.rs:517:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:537:    unsafe { net_tcp_rpc_ext_add_public_key_ffi(buffer, buffer_len, pos, public_key) }
rust/mtproxy-ffi/src/compat/ffi.rs:557:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:579:    unsafe { net_http_error_msg_text_ffi(code) }
rust/mtproxy-ffi/src/compat/ffi.rs:592:    unsafe { net_http_gen_date_ffi(out, out_len, time) }
rust/mtproxy-ffi/src/compat/ffi.rs:604:    unsafe { net_http_gen_time_ffi(date_text, out_time) }
rust/mtproxy-ffi/src/compat/ffi.rs:622:    unsafe { net_http_get_header_ffi(q_headers, q_headers_len, buffer, b_len, arg_name, arg_len) }
rust/mtproxy-ffi/src/compat/ffi.rs:635:    unsafe { msg_buffers_pick_size_index_ffi(buffer_sizes, buffer_size_values, size_hint) }
rust/mtproxy-ffi/src/compat/ffi.rs:649:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:668:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:713:    let Some(out) = (unsafe { mut_ref_from_ptr(out_packet.cast::<[u8; 12]>()) }) else {
rust/mtproxy-ffi/src/compat/ffi.rs:736:    let Some(out_rem) = (unsafe { mut_ref_from_ptr(out_remaining) }) else {
rust/mtproxy-ffi/src/compat/ffi.rs:739:    let Some(out_time) = (unsafe { mut_ref_from_ptr(out_last_time) }) else {
rust/mtproxy-ffi/src/compat/ffi.rs:771:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:807:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:841:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:869:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:922:    unsafe { tcp_rpc_server_default_execute_set_pong_ffi(packet_words, packet_words_len) }
rust/mtproxy-ffi/src/compat/ffi.rs:938:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:961:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:1017:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:1064:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:1084:    unsafe { tcp_rpc_server_init_accepted_nohs_state_ffi(out_crypto_flags, out_in_packet_num) }
rust/mtproxy-ffi/src/compat/ffi.rs:1096:    unsafe { tcp_rpc_server_init_fake_crypto_state_ffi(crypto_flags, out_crypto_flags) }
rust/mtproxy-ffi/src/compat/ffi.rs:1114:    unsafe { rpc_target_normalize_pid_ffi(pid, default_ip) }
rust/mtproxy-ffi/src/compat/ffi.rs:1200:    unsafe {
rust/mtproxy-ffi/src/compat/ffi.rs:1236:    unsafe {
rust/mtproxy-ffi/src/mp_queue/core.rs:31:    unsafe { mut_ref_from_ptr(handle.cast::<MpQueueHandle>()) }
rust/mtproxy-ffi/src/mp_queue/core.rs:47:    let Some(out_handle_ref) = (unsafe { mut_ref_from_ptr(out_handle) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:76:    unsafe {
rust/mtproxy-ffi/src/mp_queue/core.rs:92:    let Some(handle_ref) = (unsafe { handle_ref(handle) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:118:    let Some(out_pos_ref) = (unsafe { mut_ref_from_ptr(out_pos) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:121:    let Some(handle_ref) = (unsafe { handle_ref(handle) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:148:    let Some(out_value_ref) = (unsafe { mut_ref_from_ptr(out_value) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:152:    let Some(handle_ref) = (unsafe { handle_ref(handle) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:175:    let Some(handle_ref) = (unsafe { handle_ref(handle) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:205:    let Some(out_pos_ref) = (unsafe { mut_ref_from_ptr(out_pos) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:208:    let Some(handle_ref) = (unsafe { handle_ref(handle) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:239:    let Some(out_value_ref) = (unsafe { mut_ref_from_ptr(out_value) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:243:    let Some(handle_ref) = (unsafe { handle_ref(handle) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:271:    let Some(out_value_ref) = (unsafe { mut_ref_from_ptr(out_value) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:275:    let Some(handle_ref) = (unsafe { handle_ref(handle) }) else {
rust/mtproxy-ffi/src/mp_queue/core.rs:303:            unsafe { mtproxy_ffi_mpq_handle_create(0, &raw mut handle) },
rust/mtproxy-ffi/src/mp_queue/core.rs:307:        assert_eq!(unsafe { mtproxy_ffi_mpq_handle_is_empty(handle) }, 1);
rust/mtproxy-ffi/src/mp_queue/core.rs:312:            unsafe { mtproxy_ffi_mpq_handle_push(handle, value, 0, &raw mut out_pos) },
rust/mtproxy-ffi/src/mp_queue/core.rs:316:        assert_eq!(unsafe { mtproxy_ffi_mpq_handle_is_empty(handle) }, 0);
rust/mtproxy-ffi/src/mp_queue/core.rs:320:            unsafe { mtproxy_ffi_mpq_handle_pop(handle, 0, &raw mut out_value) },
rust/mtproxy-ffi/src/mp_queue/core.rs:325:            unsafe { mtproxy_ffi_mpq_handle_pop(handle, 0, &raw mut out_value) },
rust/mtproxy-ffi/src/mp_queue/core.rs:329:        assert_eq!(unsafe { mtproxy_ffi_mpq_handle_destroy(handle) }, 0);
rust/mtproxy-ffi/src/mp_queue/core.rs:336:            unsafe { mtproxy_ffi_mpq_handle_create(1, &raw mut handle) },
rust/mtproxy-ffi/src/mp_queue/core.rs:344:            unsafe { mtproxy_ffi_mpq_handle_push_w(handle, value, 0, &raw mut out_pos) },
rust/mtproxy-ffi/src/mp_queue/core.rs:351:            unsafe { mtproxy_ffi_mpq_handle_pop_nw(handle, 0, &raw mut out_value) },
rust/mtproxy-ffi/src/mp_queue/core.rs:356:            unsafe { mtproxy_ffi_mpq_handle_pop_nw(handle, 1, &raw mut out_value) },
rust/mtproxy-ffi/src/mp_queue/core.rs:360:        assert_eq!(unsafe { mtproxy_ffi_mpq_handle_destroy(handle) }, 0);
rust/mtproxy-ffi/src/mp_queue/core.rs:367:            unsafe { mtproxy_ffi_mpq_handle_create(0, &raw mut handle) },
rust/mtproxy-ffi/src/mp_queue/core.rs:374:            unsafe { mtproxy_ffi_mpq_handle_push_w(handle, value, 0, &raw mut out_pos) },
rust/mtproxy-ffi/src/mp_queue/core.rs:380:            unsafe { mtproxy_ffi_mpq_handle_pop_w(handle, 0, &raw mut out_value) },
rust/mtproxy-ffi/src/mp_queue/core.rs:384:            unsafe { mtproxy_ffi_mpq_handle_pop_nw(handle, 0, &raw mut out_value) },
rust/mtproxy-ffi/src/mp_queue/core.rs:387:        assert_eq!(unsafe { mtproxy_ffi_mpq_handle_destroy(handle) }, 0);
rust/mtproxy-ffi/src/mp_queue/core.rs:394:            unsafe { mtproxy_ffi_mpq_handle_create(1, &raw mut handle) },
rust/mtproxy-ffi/src/mp_queue/core.rs:401:            let rc = unsafe {
rust/mtproxy-ffi/src/mp_queue/core.rs:411:            unsafe { mtproxy_ffi_mpq_handle_push_w(handle, value, 0, &raw mut out_pos) },
rust/mtproxy-ffi/src/mp_queue/core.rs:419:        assert_eq!(unsafe { mtproxy_ffi_mpq_handle_destroy(handle) }, 0);
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:239:    unsafe { ptr::addr_of_mut!((*job.cast::<AsyncJob>()).j_custom).cast::<T>() }
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:244:    unsafe { job_custom_ptr(c) }
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:249:    unsafe { job_custom_ptr(c) }
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:254:    unsafe { &*ptr.cast::<AtomicI32>() }
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:259:    unsafe { job_signal(1, job_incref(job), signo) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:264:    let raw = unsafe { libc::malloc(size_of::<RawMessage>()) }.cast::<RawMessage>();
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:270:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:271:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:272:    unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:282:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:283:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:284:    let conn_type = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:287:    let stop = unsafe { (*conn).status == CONN_WRITE_CLOSE };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:290:        let raw = unsafe { mpq_pop_nw((*conn).out_queue, 4) }.cast::<RawMessage>();
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:294:        let Some(write_packet) = (unsafe { (*conn_type).write_packet }) else {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:297:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:303:    let Some(flush) = (unsafe { (*conn_type).flush }) else {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:306:    unsafe { flush(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:308:    let raw = unsafe { alloc_raw_message() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:309:    if unsafe { (*conn_type).crypto_encrypt_output.is_some() && !(*conn).crypto.is_null() } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:310:        let Some(crypto_encrypt_output) = (unsafe { (*conn_type).crypto_encrypt_output }) else {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:313:        unsafe { crypto_encrypt_output(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:314:        unsafe { *raw = (*conn).out_p };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:315:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:319:        unsafe { *raw = (*conn).out };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:320:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:325:    if unsafe { (*raw).total_bytes != 0 && !(*conn).io_conn.is_null() } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:326:        let io = unsafe { socket_conn_info((*conn).io_conn) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:327:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:331:            unsafe { atomic_i32(ptr::addr_of_mut!((*io).flags)) }
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:334:        unsafe { job_signal_create_pass((*conn).io_conn, JS_RUN) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:336:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:346:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:347:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:348:    let conn_type = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:352:        let raw = unsafe { mpq_pop_nw((*conn).in_queue, 4) }.cast::<RawMessage>();
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:357:        if unsafe { !(*conn).crypto.is_null() } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:358:            unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:362:            unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:366:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:371:    if unsafe { !(*conn).crypto.is_null() } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:372:        let Some(decrypt) = (unsafe { (*conn_type).crypto_decrypt_input }) else {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:375:        assert!(unsafe { decrypt(c) } >= 0);
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:378:    let r = unsafe { (*conn).in_data.total_bytes };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:379:    let mut s = unsafe { (*conn).skip_bytes };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:381:    if let Some(data_received) = unsafe { (*conn_type).data_received } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:382:        unsafe { data_received(c, r) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:385:    let precheck = tcp_connections_core::reader_precheck_result(unsafe { (*conn).flags });
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:397:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:401:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:405:        if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:406:            unsafe { kprintf(SKIPPED_FMT.as_ptr().cast(), r1, -s) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:416:        unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:420:        if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:422:            unsafe { kprintf(FETCHED_FMT.as_ptr().cast(), r, r1, more) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:430:        unsafe { (*conn).skip_bytes },
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:431:        unsafe { (*conn).flags },
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:432:        i32::from(unsafe { (*conn).status == CONN_ERROR }),
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:435:        let bytes = unsafe { (*conn).in_data.total_bytes };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:440:        let Some(parse_execute) = (unsafe { (*conn_type).parse_execute }) else {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:443:        let res = unsafe { parse_execute(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:446:            let buffered = if unsafe { !(*conn).crypto.is_null() } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:447:                unsafe { (*conn).in_data.total_bytes }
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:449:                unsafe { (*conn).in_u.total_bytes }
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:454:                unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:466:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:467:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:468:    let crypto = unsafe { (*conn).crypto.cast::<AesCrypto>() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:471:    let aligned_len = tcp_connections_core::aes_aligned_len(unsafe { (*conn).out.total_bytes });
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:474:            unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:487:    tcp_connections_core::aes_needed_output_bytes(unsafe { (*conn).out.total_bytes })
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:491:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:492:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:493:    let crypto = unsafe { (*conn).crypto.cast::<AesCrypto>() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:496:    let aligned_len = tcp_connections_core::aes_aligned_len(unsafe { (*conn).in_u.total_bytes });
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:499:            unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:512:    tcp_connections_core::aes_needed_output_bytes(unsafe { (*conn).in_u.total_bytes })
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:516:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:517:    assert!(unsafe { !(*conn).crypto.is_null() });
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:518:    tcp_connections_core::aes_needed_output_bytes(unsafe { (*conn).out.total_bytes })
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:522:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:523:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:524:    let crypto = unsafe { (*conn).crypto.cast::<AesCrypto>() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:527:    while unsafe { (*conn).out.total_bytes != 0 } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:529:            unsafe { (*conn).out.total_bytes },
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:530:            (unsafe { (*conn).flags } & C_IS_TLS) != 0,
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:533:        if (unsafe { (*conn).flags } & C_IS_TLS) != 0 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:534:            assert!(unsafe { (*conn).left_tls_packet_length >= 0 });
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:543:                unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:552:            if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:553:                unsafe { kprintf(TLS_SEND_FMT.as_ptr().cast(), len) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:558:            unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:575:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:576:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:577:    let crypto = unsafe { (*conn).crypto.cast::<AesCrypto>() };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:580:    while unsafe { (*conn).in_u.total_bytes != 0 } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:581:        let mut len = unsafe { (*conn).in_u.total_bytes };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:582:        if (unsafe { (*conn).flags } & C_IS_TLS) != 0 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:583:            assert!(unsafe { (*conn).left_tls_packet_length >= 0 });
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:584:            if unsafe { (*conn).left_tls_packet_length == 0 } {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:587:                    if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:588:                        unsafe { kprintf(TLS_NEED_HEADER_FMT.as_ptr().cast(), need) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:595:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:607:                    if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:608:                        unsafe { kprintf(TLS_HEADER_ERR_FMT.as_ptr().cast()) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:610:                    unsafe { fail_connection(c, -1) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:614:                unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:617:                if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:618:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:623:                    unsafe { rwm_skip_data(ptr::addr_of_mut!((*conn).in_u), 5) },
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:629:            len = tcp_connections_core::tls_decrypt_chunk_len(len, unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:632:            unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:637:        if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:638:            unsafe { kprintf(TLS_READ_FMT.as_ptr().cast(), len, (*conn).in_u.total_bytes) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:641:            unsafe {
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:658:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_connections/core.rs:659:    assert!(unsafe { !(*conn).crypto.is_null() });
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:10:    unsafe { cpu_tcp_free_connection_buffers_impl(c) }
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:17:    unsafe { cpu_tcp_server_writer_impl(c) }
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:24:    unsafe { cpu_tcp_server_reader_impl(c) }
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:31:    unsafe { cpu_tcp_aes_crypto_encrypt_output_impl(c) }
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:38:    unsafe { cpu_tcp_aes_crypto_decrypt_input_impl(c) }
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:45:    unsafe { cpu_tcp_aes_crypto_needed_output_bytes_impl(c) }
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:52:    unsafe { cpu_tcp_aes_crypto_ctr128_encrypt_output_impl(c) }
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:59:    unsafe { cpu_tcp_aes_crypto_ctr128_decrypt_input_impl(c) }
rust/mtproxy-ffi/src/net_tcp_connections/ffi.rs:66:    unsafe { cpu_tcp_aes_crypto_ctr128_needed_output_bytes_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:222:    let conn = unsafe { mtproxy_ffi_net_tcp_rpc_common_conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:229:    let data = unsafe { mtproxy_ffi_net_tcp_rpc_common_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:236:    unsafe { mtproxy_ffi_net_tcp_rpc_common_precise_now() }
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:241:    let ptr = unsafe { libc::malloc(size_of::<RawMessage>()) }.cast::<RawMessage>();
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:249:        unsafe { rwm_clone(dst, src) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:251:        unsafe { *dst = *src };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:264:        unsafe { rwm_create(ptr::addr_of_mut!(raw), data.cast_const(), len) },
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:267:    unsafe { tcp_rpc_conn_send_impl(c_tag_int, c, ptr::addr_of_mut!(raw), 0) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:278:        unsafe { rwm_create(ptr::addr_of_mut!(raw), data.cast_const(), len) },
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:281:    unsafe { tcp_rpc_conn_send_init_impl(c, ptr::addr_of_mut!(raw), 0) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:293:        unsafe { rwm_create(ptr::addr_of_mut!(raw), data.cast_const(), len) },
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:296:    unsafe { tcp_rpc_conn_send_im_impl(c_tag_int, c, ptr::addr_of_mut!(raw), 0) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:304:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:305:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:308:    assert_eq!(unsafe { (*raw).total_bytes & 3 }, 0);
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:309:    let header_words = [unsafe { (*raw).total_bytes + 12 }, unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:312:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:316:    let out_raw = unsafe { alloc_raw_message() };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:317:    unsafe { copy_or_clone_message(out_raw, raw, flags) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:319:    let _ = unsafe { rwm_push_data_front(out_raw, header_words.as_ptr().cast(), 8) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:321:        unsafe { rwm_custom_crc32(out_raw, (*out_raw).total_bytes, (*data).custom_crc_partial) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:322:    let _ = unsafe { rwm_push_data(out_raw, ptr::addr_of!(crc32).cast(), 4) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:324:    let socket_conn = unsafe { (*conn).io_conn };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:327:            unsafe { mtproxy_ffi_net_tcp_rpc_common_socket_out_packet_queue(socket_conn) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:328:        let _ = unsafe { mpq_push_w(out_packet_queue, out_raw.cast(), 0) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:329:        let socket_ref = unsafe { job_incref(socket_conn) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:330:        unsafe { job_signal(1, socket_ref, JS_RUN) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:340:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:341:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:344:    assert_eq!(unsafe { (*raw).total_bytes & 3 }, 0);
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:345:    let header_words = [unsafe { (*raw).total_bytes + 12 }, unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:348:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:352:    let out_raw = unsafe { alloc_raw_message() };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:353:    unsafe { copy_or_clone_message(out_raw, raw, flags) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:355:    let _ = unsafe { rwm_push_data_front(out_raw, header_words.as_ptr().cast(), 8) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:357:        unsafe { rwm_custom_crc32(out_raw, (*out_raw).total_bytes, (*data).custom_crc_partial) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:358:    let _ = unsafe { rwm_push_data(out_raw, ptr::addr_of!(crc32).cast(), 4) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:360:    let _ = unsafe { rwm_union(ptr::addr_of_mut!((*conn).out), out_raw) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:361:    unsafe { libc::free(out_raw.cast()) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:363:    unsafe { job_signal(c_tag_int, c, JS_RUN) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:372:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:376:        assert_eq!(unsafe { (*raw).total_bytes & 3 }, 0);
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:383:        let allocated = unsafe { alloc_raw_message() };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:384:        unsafe { copy_or_clone_message(allocated, raw, flags) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:388:    let _ = unsafe { mpq_push_w((*conn).out_queue, out_raw.cast(), 0) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:389:    unsafe { job_signal(c_tag_int, c, JS_RUN) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:397:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:400:    if op == RPC_PING && unsafe { (*raw).total_bytes } == 12 {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:401:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:406:            unsafe { rwm_fetch_data(raw, pong_packet.as_mut_ptr().cast(), 12) },
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:410:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:416:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:423:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:424:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:427:    if (unsafe { (*data).flags } & (RPC_F_COMPACT | RPC_F_MEDIUM)) == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:428:        let header_words = [unsafe { (*raw).total_bytes + 12 }, unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:431:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:435:        let _ = unsafe { rwm_push_data_front(raw, header_words.as_ptr().cast(), 8) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:437:            unsafe { rwm_custom_crc32(raw, (*raw).total_bytes, (*data).custom_crc_partial) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:438:        let _ = unsafe { rwm_push_data(raw, ptr::addr_of!(crc32).cast(), 4) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:439:        let _ = unsafe { rwm_union(ptr::addr_of_mut!((*conn).out), raw) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:449:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:450:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:453:    if unsafe { (*raw).total_bytes } == 5 {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:456:            unsafe { rwm_fetch_data(raw, ptr::addr_of_mut!(flag).cast(), 1) },
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:460:        let _ = unsafe { rwm_union(ptr::addr_of_mut!((*conn).out), raw) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:464:    if (unsafe { (*conn).flags } & C_IS_TLS) != 0 && unsafe { (*conn).left_tls_packet_length } == -1
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:466:        let _ = unsafe { rwm_union(ptr::addr_of_mut!((*conn).out), raw) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:470:    if (unsafe { (*data).flags } & (RPC_F_COMPACT | RPC_F_MEDIUM)) == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:471:        return unsafe { tcp_rpc_write_packet_impl(c, raw) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:474:    if (unsafe { (*data).flags } & RPC_F_PAD) != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:475:        let x = unsafe { lrand48_j() as c_int };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:476:        let y = (unsafe { lrand48_j() } & 3) as c_int;
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:477:        assert_eq!(unsafe { rwm_push_data(raw, ptr::addr_of!(x).cast(), y) }, y);
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:480:    let len = unsafe { (*raw).total_bytes };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:482:    if (unsafe { (*data).flags } & RPC_F_PAD) == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:489:            if (unsafe { (*data).flags } & RPC_F_MEDIUM) != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:496:    let _ = unsafe { rwm_push_data_front(raw, ptr::addr_of!(prefix_word).cast(), prefix_bytes) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:497:    let _ = unsafe { rwm_union(ptr::addr_of_mut!((*conn).out), raw) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:503:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:505:    if unsafe { !(*conn).crypto.is_null() } {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:506:        let conn_type = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:508:            let pad_bytes = if let Some(needed) = unsafe { (*conn_type).crypto_needed_output_bytes }
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:510:                unsafe { needed(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:520:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:537:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:538:    let conn_type = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:540:    let flush_fn = unsafe { (*conn_type).flush };
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:542:    unsafe { flush_fn.unwrap()(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:547:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_common/core.rs:576:        unsafe { precise_now_value() },
rust/mtproxy-ffi/src/tests/core.rs:142:    let capture = unsafe { &mut *ctx.cast::<EngineSignalDispatchCapture>() };
rust/mtproxy-ffi/src/tests/core.rs:154:    let capture = unsafe { &mut *ctx.cast::<EngineNetTryOpenCapture>() };
rust/mtproxy-ffi/src/tests/core.rs:184:        unsafe { mtproxy_ffi_get_concurrency_boundary(&raw mut out) },
rust/mtproxy-ffi/src/tests/core.rs:197:    assert_eq!(unsafe { mtproxy_ffi_get_network_boundary(&raw mut out) }, 0);
rust/mtproxy-ffi/src/tests/core.rs:216:    assert_eq!(unsafe { mtproxy_ffi_get_rpc_boundary(&raw mut out) }, 0);
rust/mtproxy-ffi/src/tests/core.rs:240:    assert_eq!(unsafe { mtproxy_ffi_get_crypto_boundary(&raw mut out) }, 0);
rust/mtproxy-ffi/src/tests/core.rs:260:        unsafe { mtproxy_ffi_get_application_boundary(&raw mut out) },
rust/mtproxy-ffi/src/tests/core.rs:352:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:369:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:383:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:407:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:424:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:441:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:551:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:561:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:581:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:598:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:614:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:633:        unsafe { mtproxy_ffi_mtproto_parse_client_packet(pong.as_ptr(), pong.len(), &raw mut out) },
rust/mtproxy-ffi/src/tests/core.rs:645:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:664:        unsafe { mtproxy_ffi_mtproto_parse_client_packet(ack.as_ptr(), ack.len(), &raw mut out) },
rust/mtproxy-ffi/src/tests/core.rs:678:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:696:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:710:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:721:    unsafe { mtproxy_ffi_mtproto_ext_conn_reset() };
rust/mtproxy-ffi/src/tests/core.rs:725:        unsafe { mtproxy_ffi_mtproto_ext_conn_create(11, 22, 0, 33, 44, 55, &raw mut ext) },
rust/mtproxy-ffi/src/tests/core.rs:738:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:761:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:778:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:796:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:812:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:838:        unsafe { mtproxy_ffi_mtproto_parse_function(op.as_ptr(), op.len(), 1, &raw mut out) },
rust/mtproxy-ffi/src/tests/core.rs:846:        unsafe { mtproxy_ffi_mtproto_parse_function(op.as_ptr(), op.len(), 0, &raw mut out) },
rust/mtproxy-ffi/src/tests/core.rs:857:    let rc = unsafe { mtproxy_ffi_mtproto_cfg_preinit(3, 40, &raw mut out) };
rust/mtproxy-ffi/src/tests/core.rs:869:    let rc = unsafe { mtproxy_ffi_mtproto_cfg_preinit(3, 40, core::ptr::null_mut()) };
rust/mtproxy-ffi/src/tests/core.rs:877:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:890:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:911:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:925:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:944:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:957:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:972:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:986:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1001:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1016:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1031:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1043:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1055:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1067:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1081:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1098:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1123:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1149:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1164:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1191:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1231:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1255:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1288:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1317:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1356:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1393:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1409:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1429:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1435:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1446:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1460:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1474:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1494:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1507:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1518:    let rc = unsafe { mtproxy_ffi_mtproto_cfg_finalize(1, core::ptr::null(), 0, 0, &raw mut out) };
rust/mtproxy-ffi/src/tests/core.rs:1527:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1539:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1551:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1575:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1597:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1633:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1659:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1670:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1689:        unsafe { mtproxy_ffi_crypto_dh_first_round(g_a.as_mut_ptr(), a.as_mut_ptr()) },
rust/mtproxy-ffi/src/tests/core.rs:1697:        unsafe { mtproxy_ffi_crypto_dh_third_round(g_ab.as_mut_ptr(), g_a.as_ptr(), a.as_ptr()) },
rust/mtproxy-ffi/src/tests/core.rs:1705:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1735:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1749:        unsafe { mtproxy_ffi_aesni_crypt(ctx, input.as_ptr(), output.as_mut_ptr(), 64) },
rust/mtproxy-ffi/src/tests/core.rs:1753:    assert_eq!(unsafe { mtproxy_ffi_aesni_ctx_free(ctx) }, 0);
rust/mtproxy-ffi/src/tests/core.rs:1760:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1772:        unsafe { mtproxy_ffi_crypto_tls_generate_public_key(public_key.as_mut_ptr()) },
rust/mtproxy-ffi/src/tests/core.rs:1822:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1835:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1848:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1861:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1925:        unsafe { mtproxy_ffi_net_add_nat_info(invalid.as_ptr().cast()) },
rust/mtproxy-ffi/src/tests/core.rs:1931:    assert!(unsafe { mtproxy_ffi_net_add_nat_info(rule_a.as_ptr().cast()) } >= 0);
rust/mtproxy-ffi/src/tests/core.rs:1932:    assert!(unsafe { mtproxy_ffi_net_add_nat_info(rule_b.as_ptr().cast()) } >= 0);
rust/mtproxy-ffi/src/tests/core.rs:1945:    let msg_ptr = unsafe { mtproxy_ffi_net_http_error_msg_text(&raw mut code) };
rust/mtproxy-ffi/src/tests/core.rs:1947:    let msg = unsafe { std::ffi::CStr::from_ptr(msg_ptr) };
rust/mtproxy-ffi/src/tests/core.rs:1952:    let msg_ptr = unsafe { mtproxy_ffi_net_http_error_msg_text(&raw mut code) };
rust/mtproxy-ffi/src/tests/core.rs:1954:    let msg = unsafe { std::ffi::CStr::from_ptr(msg_ptr) };
rust/mtproxy-ffi/src/tests/core.rs:1958:    let null_msg = unsafe { mtproxy_ffi_net_http_error_msg_text(core::ptr::null_mut()) };
rust/mtproxy-ffi/src/tests/core.rs:1966:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:1975:    let date = unsafe { std::ffi::CStr::from_ptr(out.as_ptr()) };
rust/mtproxy-ffi/src/tests/core.rs:1982:    let rc = unsafe { mtproxy_ffi_net_http_gen_time(out.as_ptr(), &raw mut parsed) };
rust/mtproxy-ffi/src/tests/core.rs:1987:    let rc = unsafe { mtproxy_ffi_net_http_gen_time(invalid_tz.as_ptr().cast(), &raw mut parsed) };
rust/mtproxy-ffi/src/tests/core.rs:1991:        unsafe { mtproxy_ffi_net_http_gen_time(core::ptr::null(), &raw mut parsed) },
rust/mtproxy-ffi/src/tests/core.rs:1999:    let all_idx = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2008:    let idx = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2017:    let tiny = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2032:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2046:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2060:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2140:        unsafe { mtproxy_ffi_tcp_rpc_server_default_execute_set_pong(words.as_mut_ptr(), 3) },
rust/mtproxy-ffi/src/tests/core.rs:2180:    let built = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2195:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2222:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2235:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2251:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2276:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2289:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2300:    let error_len = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2327:        unsafe { mtproxy_ffi_rpc_target_normalize_pid(&raw mut pid, 0x7f00_0001) },
rust/mtproxy-ffi/src/tests/core.rs:2337:    let partial = unsafe { mtproxy_ffi_crc32_partial(data.as_ptr(), data.len(), u32::MAX) };
rust/mtproxy-ffi/src/tests/core.rs:2346:    let full = unsafe { mtproxy_ffi_crc32_partial(data.as_ptr(), data.len(), 0x1234_5678) };
rust/mtproxy-ffi/src/tests/core.rs:2348:    let first = unsafe { mtproxy_ffi_crc32_partial(data.as_ptr(), 8, 0x1234_5678) };
rust/mtproxy-ffi/src/tests/core.rs:2351:    let split = unsafe { mtproxy_ffi_crc32_partial(rest_ptr, rest_len, first) };
rust/mtproxy-ffi/src/tests/core.rs:2359:    let partial = unsafe { mtproxy_ffi_crc32c_partial(data.as_ptr(), data.len(), u32::MAX) };
rust/mtproxy-ffi/src/tests/core.rs:2368:        (unsafe { mtproxy_ffi_crc32_partial(data.as_ptr(), data.len(), u32::MAX) }) ^ u32::MAX;
rust/mtproxy-ffi/src/tests/core.rs:2372:    let rc = unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2390:    unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2393:    let out = unsafe { mtproxy_ffi_gf32_combine_clmul(powers.as_ptr(), 0x89ab_cdef, 17) };
rust/mtproxy-ffi/src/tests/core.rs:2400:    let rc = unsafe { mtproxy_ffi_pid_init_common(&raw mut pid) };
rust/mtproxy-ffi/src/tests/core.rs:2412:        unsafe { mtproxy_ffi_matches_pid(&raw const pid, &raw const y) },
rust/mtproxy-ffi/src/tests/core.rs:2417:        unsafe { mtproxy_ffi_matches_pid(&raw const pid, &raw const y) },
rust/mtproxy-ffi/src/tests/core.rs:2433:        unsafe { mtproxy_ffi_process_id_is_newer(&raw const a, &raw const b) },
rust/mtproxy-ffi/src/tests/core.rs:2441:    let rc = unsafe { mtproxy_ffi_cpuid_fill(&raw mut out) };
rust/mtproxy-ffi/src/tests/core.rs:2458:        unsafe { mtproxy_ffi_md5(data.as_ptr(), data.len(), digest.as_mut_ptr()) },
rust/mtproxy-ffi/src/tests/core.rs:2471:        unsafe { mtproxy_ffi_md5_hex(data.as_ptr(), data.len(), hex.as_mut_ptr()) },
rust/mtproxy-ffi/src/tests/core.rs:2486:        unsafe { mtproxy_ffi_sha1(data.as_ptr(), data.len(), digest.as_mut_ptr()) },
rust/mtproxy-ffi/src/tests/core.rs:2499:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2518:        unsafe { mtproxy_ffi_sha256(data.as_ptr(), data.len(), digest.as_mut_ptr()) },
rust/mtproxy-ffi/src/tests/core.rs:2532:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2547:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2584:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2597:    let word_ptr = unsafe { src.as_ptr().add(scan.advance) };
rust/mtproxy-ffi/src/tests/core.rs:2599:        unsafe { mtproxy_ffi_cfg_getword_len(word_ptr.cast(), src.len() - scan.advance) },
rust/mtproxy-ffi/src/tests/core.rs:2603:    let int_ptr = unsafe { word_ptr.add(9) };
rust/mtproxy-ffi/src/tests/core.rs:2606:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2628:        unsafe { mtproxy_ffi_tl_parse_query_header(query.as_ptr(), query.len(), &raw mut q) },
rust/mtproxy-ffi/src/tests/core.rs:2642:        unsafe { mtproxy_ffi_tl_parse_answer_header(answer.as_ptr(), answer.len(), &raw mut a) },
rust/mtproxy-ffi/src/tests/core.rs:2655:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2672:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2687:        unsafe {
rust/mtproxy-ffi/src/tests/core.rs:2702:        unsafe { mtproxy_ffi_read_proc_stat_file(pid, 0, &raw mut ps_live) },
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:12:    unsafe { tcp_rpc_conn_send_init_impl(c, raw, flags) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:22:    unsafe { tcp_rpc_conn_send_im_impl(c_tag_int, c, raw, flags) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:32:    unsafe { tcp_rpc_conn_send_impl(c_tag_int, c, raw, flags) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:42:    unsafe { tcp_rpc_conn_send_data_impl(c_tag_int, c, len, data) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:51:    unsafe { tcp_rpc_conn_send_data_init_impl(c, len, data) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:61:    unsafe { tcp_rpc_conn_send_data_im_impl(c_tag_int, c, len, data) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:70:    unsafe { tcp_rpc_default_execute_impl(c, op, raw) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:78:    unsafe { tcp_rpc_write_packet_impl(c, raw) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:86:    unsafe { tcp_rpc_write_packet_compact_impl(c, raw) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:91:    unsafe { tcp_rpc_flush_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:96:    unsafe { tcp_rpc_flush_packet_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:101:    unsafe { tcp_rpc_send_ping_impl(c, ping_id) }
rust/mtproxy-ffi/src/net_tcp_rpc_common/ffi.rs:124:    unsafe { tcp_add_dh_accept_impl() }
rust/mtproxy-ffi/src/server_functions/core.rs:79:    unsafe { CStr::from_ptr(ptr).to_str().ok().map(ToOwned::to_owned) }
rust/mtproxy-ffi/src/server_functions/core.rs:167:    unsafe { libc::atoi(opt.as_ptr()) }
rust/mtproxy-ffi/src/server_functions/core.rs:175:    unsafe { libc::strdup(ptr).cast_const() }
rust/mtproxy-ffi/src/server_functions/core.rs:182:            unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:193:            unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:202:            unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:218:            unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:228:            unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:240:            let _ = unsafe { libc::nice(nice_delta) };
rust/mtproxy-ffi/src/server_functions/core.rs:248:            let parsed = unsafe { parse_memory_limit_ffi(opt.as_ptr()) };
rust/mtproxy-ffi/src/server_functions/core.rs:253:            unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:268:            unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:294:    let token_bytes = unsafe { CStr::from_ptr(token_ptr).to_bytes() };
rust/mtproxy-ffi/src/server_functions/core.rs:341:            let next_ptr = unsafe { *argv.add(index + 1) };
rust/mtproxy-ffi/src/server_functions/core.rs:366:    let token_bytes = unsafe { CStr::from_ptr(token_ptr).to_bytes() };
rust/mtproxy-ffi/src/server_functions/core.rs:401:                let next_ptr = unsafe { *argv.add(index + 1) };
rust/mtproxy-ffi/src/server_functions/core.rs:434:    let mut action: libc::sigaction = unsafe { std::mem::zeroed() };
rust/mtproxy-ffi/src/server_functions/core.rs:440:    let rc = unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:447:        unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:452:            unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:466:    unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:480:    unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:487:    unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:499:    let uid = unsafe { libc::getuid() };
rust/mtproxy-ffi/src/server_functions/core.rs:501:    let euid = unsafe { libc::geteuid() };
rust/mtproxy-ffi/src/server_functions/core.rs:515:    if unsafe { libc::setgroups(1, &gid) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:527:    if unsafe { libc::setgid(gid) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:532:    if unsafe { libc::setuid(pw.pw_uid) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:541:    let uid = unsafe { libc::getuid() };
rust/mtproxy-ffi/src/server_functions/core.rs:543:    let euid = unsafe { libc::geteuid() };
rust/mtproxy-ffi/src/server_functions/core.rs:557:    if unsafe { libc::setgroups(1, &gid) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:563:    if unsafe { libc::initgroups(c_username.as_ptr(), gid) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:568:    if unsafe { libc::setgid(gid) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:573:    if unsafe { libc::setuid(pw.pw_uid) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:587:    if unsafe { libc::getrlimit(libc::RLIMIT_NOFILE, &mut rlim) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:602:    if unsafe { libc::setrlimit(libc::RLIMIT_NOFILE, &rlim) } != 0 {
rust/mtproxy-ffi/src/server_functions/core.rs:614:    let nptrs = unsafe { libc::backtrace(buffer.as_mut_ptr(), MAX_FRAMES as c_int) };
rust/mtproxy-ffi/src/server_functions/core.rs:618:        unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:643:    let pw_ptr = unsafe { libc::getpwnam(c_username.as_ptr()) };
rust/mtproxy-ffi/src/server_functions/core.rs:649:    let pw_uid = unsafe { (*pw_ptr).pw_uid };
rust/mtproxy-ffi/src/server_functions/core.rs:651:    let pw_gid = unsafe { (*pw_ptr).pw_gid };
rust/mtproxy-ffi/src/server_functions/core.rs:660:    let gr_ptr = unsafe { libc::getgrnam(c_groupname.as_ptr()) };
rust/mtproxy-ffi/src/server_functions/core.rs:666:    let gr_gid = unsafe { (*gr_ptr).gr_gid };
rust/mtproxy-ffi/src/server_functions/core.rs:680:        unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:887:    unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:901:        let token_ptr = unsafe { *argv.add(index) };
rust/mtproxy-ffi/src/server_functions/core.rs:907:        let token = unsafe { CStr::from_ptr(token_ptr).to_bytes() };
rust/mtproxy-ffi/src/server_functions/core.rs:936:    unsafe {
rust/mtproxy-ffi/src/server_functions/core.rs:1049:    *debug_thread = Some(unsafe { libc::pthread_self() });
rust/mtproxy-ffi/src/server_functions/core.rs:1058:    let c_str = unsafe { CStr::from_ptr(s) };
rust/mtproxy-ffi/src/server_functions/core.rs:1078:        unsafe { CStr::from_ptr(username_ptr) }.to_str().ok()
rust/mtproxy-ffi/src/server_functions/core.rs:1085:        unsafe { CStr::from_ptr(groupname) }.to_str().ok()
rust/mtproxy-ffi/src/server_functions/core.rs:1099:        unsafe { CStr::from_ptr(username_ptr) }.to_str().ok()
rust/mtproxy-ffi/src/vv_io/core.rs:37:        let buffer = unsafe { &mut *cell.get() };
rust/mtproxy-ffi/src/vv_io/core.rs:75:    let Some(addr) = (unsafe { copy_bytes::<16>(ipv6_bytes.cast::<u8>()) }) else {
rust/mtproxy-ffi/src/vv_io/core.rs:93:    let Some(out_bytes) = (unsafe { mut_slice_from_ptr(out, 4) }) else {
rust/mtproxy-ffi/src/vv_io/core.rs:106:        unsafe {
rust/mtproxy-ffi/src/vv_io/core.rs:125:        unsafe {
rust/mtproxy-ffi/src/vv_io/core.rs:134:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:469:    let conn = unsafe { mtproxy_ffi_net_tcp_rpc_ext_conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:476:    let data = unsafe { mtproxy_ffi_net_tcp_rpc_ext_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:483:    let funcs = unsafe { mtproxy_ffi_net_tcp_rpc_ext_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:490:    unsafe { mtproxy_ffi_net_tcp_rpc_server_precise_now() }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:582:    let domain_slice = unsafe { slice::from_raw_parts(domain, len_usize) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:587:            let info_domain = unsafe { CStr::from_ptr((*info).domain).to_bytes() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:591:            info = unsafe { (*info).next };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:593:        if unsafe { verbosity } > 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:594:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:613:    let domain_bytes = unsafe { CStr::from_ptr(domain).to_bytes() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:655:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:688:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:730:    if unsafe { mtproxy_ffi_crypto_rand_bytes(dst.as_mut_ptr(), random_len_i32) } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:743:    if unsafe { mtproxy_ffi_crypto_tls_generate_public_key(dst.as_mut_ptr()) } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:767:    if unsafe { mtproxy_ffi_crypto_rand_bytes(greases.as_mut_ptr(), greases_len_i32) } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:790:    if !unsafe { add_random(&mut result, &mut pos, 32) } {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:796:    if !unsafe { add_random(&mut result, &mut pos, 32) } {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:861:    if !unsafe { add_public_key(&mut result, &mut pos) } {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:913:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:916:        return unsafe { tls_fail_response_parse(ERR_NON_TLS_1) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:920:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:923:    let Some(server_hello_length) = (unsafe { read_length_buf(response, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:924:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:928:        return unsafe { tls_fail_response_parse(ERR_SERVER_HELLO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:931:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:935:        return unsafe { tls_fail_response_parse(ERR_NON_TLS_2) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:938:        return unsafe { tls_fail_response_parse(ERR_NON_TLS_3) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:946:        return unsafe { tls_fail_response_parse(ERR_HELLO_RETRY) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:949:        return unsafe { tls_fail_response_parse(ERR_TLS12_EMPTY_SESSION) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:952:        return unsafe { tls_fail_response_parse(ERR_NON_TLS_4) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:955:        return unsafe { tls_fail_response_parse(ERR_SERVER_HELLO_SHORT_2) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:961:        return unsafe { tls_fail_response_parse(ERR_TLS12_EXPECTED_SESSION) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:964:        return unsafe { tls_fail_response_parse(ERR_TLS12_EXPECTED_CIPHER) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:969:    let Some(extensions_length) = (unsafe { read_length_buf(response, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:970:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:974:        return unsafe { tls_fail_response_parse(ERR_WRONG_EXT_LEN) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:980:        let Some(extension_id) = (unsafe { read_length_buf(response, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:981:            return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:985:            return unsafe { tls_fail_response_parse(ERR_UNEXPECTED_EXT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:993:        let Some(extension_length) = (unsafe { read_length_buf(response, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:994:            return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:998:            return unsafe { tls_fail_response_parse(ERR_WRONG_EXT_ITEM_LEN) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1001:            return unsafe { tls_fail_response_parse(ERR_UNEXPECTED_EXT_ITEM_LEN) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1006:        return unsafe { tls_fail_response_parse(ERR_DUP_EXT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1009:        return unsafe { tls_fail_response_parse(ERR_WRONG_EXT_LIST) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1013:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1016:        return unsafe { tls_fail_response_parse(ERR_EXPECTED_CCS) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1019:        return unsafe { tls_fail_response_parse(ERR_EXPECTED_APP_DATA) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1024:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1027:    let Some(app_data_len) = (unsafe { read_length_buf(response, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1028:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1033:        return unsafe { tls_fail_response_parse(ERR_EMPTY_APP_DATA) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1037:        return unsafe { tls_fail_response_parse(ERR_TOO_SHORT) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1041:        return unsafe { tls_fail_response_parse(ERR_TOO_LONG) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1055:    let Some(cipher_suites_length) = (unsafe { read_length_buf(request, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1069:        let Some(extension_id) = (unsafe { read_length_buf(request, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1072:        let Some(extension_length) = (unsafe { read_length_buf(request, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1085:            let Some(inner_length) = (unsafe { read_length_buf(request, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1101:            let Some(domain_length) = (unsafe { read_length_buf(request, &mut pos_usize) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1118:            return unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1129:    unsafe { *libc::__errno_location() }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1134:    unsafe { libc::strerror(errno_value()) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1141:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1153:    let domain_ptr = unsafe { (*info).domain };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1158:    let host = unsafe { kdb_gethostbyname(domain_ptr) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1162:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1172:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1178:    let h_addrtype = unsafe { (*host).h_addrtype };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1185:        let fd = unsafe { libc::socket(h_addrtype, libc::SOCK_STREAM, libc::IPPROTO_TCP) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1187:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1197:        if unsafe { libc::fcntl(fd, libc::F_SETFL, libc::O_NONBLOCK) } == -1 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1198:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1210:                sin_addr: unsafe { *(h_addr.cast::<libc::in_addr>()) },
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1214:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1219:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1231:                sin6_addr: unsafe { *(h_addr.cast::<libc::in6_addr>()) },
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1235:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1244:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1254:        if e_connect == -1 && unsafe { errno_value() } != libc::EINPROGRESS {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1255:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1270:    let domain_bytes = unsafe { CStr::from_ptr(domain_ptr).to_bytes() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1274:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1290:    let start_time = unsafe { get_utime_monotonic() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1300:    while unsafe { get_utime_monotonic() } < finish_time
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1329:        let time_left = finish_time - unsafe { get_utime_monotonic() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1336:        let poll_res = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1344:            if unsafe { errno_value() } == libc::EINTR {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1364:                    let read_res = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1372:                        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1387:                        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1410:                    let read_res = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1420:                        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1439:                                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1458:                        let ok = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1494:                let write_res = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1502:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1520:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1533:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1539:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1547:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1552:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1568:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1583:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1619:    if len <= 0 || secret_cnt <= 0 || !unsafe { allow_only_tls() } {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1627:    let d = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1628:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1630:    if unsafe { (*d).crypto_flags & RPCF_COMPACT_OFF } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1631:        if unsafe { (*d).in_packet_num } != -3 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1632:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1636:        return unsafe { tcp_rpcs_parse_execute(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1639:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1642:        if unsafe { (*d).in_packet_num } != -3 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1643:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1647:        if unsafe { (*conn).flags & C_ERROR } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1650:        if unsafe { (*conn).flags & C_STOPPARSE } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1654:        let mut len = unsafe { (*conn).in_data.total_bytes };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1659:        let min_len = if unsafe { (*d).flags & RPC_F_MEDIUM } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1670:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1679:        if unsafe { (*d).in_packet_num } == -3 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1680:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1688:            if unsafe { (*conn).flags & C_IS_TLS } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1693:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1703:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1712:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1724:                assert!(unsafe { rwm_skip_data(&mut (*conn).in_data, 11) } == 11);
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1726:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1735:                if unsafe { (*conn).left_tls_packet_length } < 64 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1736:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1747:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1756:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1759:            } else if unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1764:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1780:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1789:                let info = unsafe { get_sni_domain_info_inner(&client_hello) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1791:                    return unsafe { proxy_connection_impl(c, default_domain_info()) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1794:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1803:                if unsafe { (*conn).our_port } == 80 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1804:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1811:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1815:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1818:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1821:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1824:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1828:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1835:                if unsafe { mtproxy_ffi_net_tcp_rpc_ext_have_client_random(client_random.as_ptr()) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1838:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1841:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1843:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1848:                let secret_cnt = unsafe { ext_secret_count() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1852:                    let secret_ptr = unsafe { ext_secret_at(i) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1857:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1860:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1875:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1878:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1885:                if unsafe { mtproxy_ffi_net_tcp_rpc_ext_is_allowed_timestamp_state(timestamp) } == 0
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1887:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1892:                    (unsafe { read_length_buf(&client_hello, &mut pos) })
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1894:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1898:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1904:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1919:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1922:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1926:                assert!(unsafe { rwm_skip_data(&mut (*conn).in_data, len) } == len);
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1927:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1932:                let encrypted_size = unsafe { domain_server_hello_encrypted_size_impl(info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1948:                    if unsafe { (*info).is_reversed_extension_order } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1957:                                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1981:                        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1990:                let secret_ptr = unsafe { ext_secret_at(secret_id) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1992:                    return unsafe { proxy_connection_impl(c, info) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:1995:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2000:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2011:                let msg = unsafe { libc::calloc(1, size_of::<RawMessage>()) }.cast::<RawMessage>();
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2014:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2018:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2026:            if unsafe { allow_only_tls() } && (unsafe { (*conn).flags & C_IS_TLS } == 0) {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2027:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2030:                return unsafe { proxy_connection_impl(c, default_domain_info()) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2034:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2047:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2065:            let secret_cnt = unsafe { ext_secret_count() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2070:                    let secret_ptr = unsafe { ext_secret_at(secret_id) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2075:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2093:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2099:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2107:                assert!(!unsafe { (*conn).crypto }.is_null());
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2109:                let t = unsafe { (*conn).crypto.cast::<AesCrypto>() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2110:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2121:                    if tag != 0xdddd_dddd && unsafe { allow_only_tls() } {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2122:                        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2125:                        return unsafe { proxy_connection_impl(c, default_domain_info()) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2128:                    assert!(unsafe { rwm_skip_data(&mut (*conn).in_data, 64) } == 64);
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2129:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2136:                        0xeeee_eeee => unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2139:                        0xdddd_dddd => unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2142:                        0xefef_efef => unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2148:                    let decrypt = unsafe { (*(*conn).type_).crypto_decrypt_input };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2150:                        assert!(unsafe { decrypt_fn(c) } >= 0);
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2157:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2168:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2179:            if unsafe { ext_secret_count() } > 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2180:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2187:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2192:                assert!(unsafe { rwm_skip_data(&mut (*conn).in_data, 64) } == 64);
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2196:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2203:        if unsafe { (*d).flags & RPC_F_MEDIUM } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2204:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2210:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2215:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2223:                    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2238:            || (unsafe { (*d).flags & RPC_F_PAD } == 0 && (packet_len & 3) != 0)
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2240:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2247:        if unsafe { (*funcs).max_packet_len > 0 && packet_len > (*funcs).max_packet_len } {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2248:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2260:            unsafe { rwm_skip_data(&mut (*conn).in_data, packet_len_bytes) } == packet_len_bytes
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2264:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2267:        if unsafe { (*d).flags & RPC_F_PAD } != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2268:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2275:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2284:        if unsafe { (*d).in_packet_num } < 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2285:            assert!(unsafe { (*d).in_packet_num } == -3);
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2286:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2291:        if unsafe { verbosity } > 2 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2292:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2304:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2308:            unsafe { tcp_rpcs_default_execute(c, packet_type, &mut msg) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2310:            let exec = unsafe { (*funcs).execute };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2312:                unsafe { exec_fn(c, packet_type, &mut msg) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2318:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2323:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2330:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2331:    let extra = unsafe { (*conn).extra };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2333:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2339:    let e = unsafe { job_incref(extra) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2340:    let e_conn = unsafe { conn_info(e) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2342:    let raw = unsafe { libc::malloc(size_of::<RawMessage>()) }.cast::<RawMessage>();
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2344:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2351:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2356:    if unsafe { verbosity } > 2 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2357:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2367:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2375:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2376:    if unsafe { verbosity } > 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2377:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2390:    let e = unsafe { (*conn).extra.cast::<c_void>() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2392:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2398:    unsafe { cpu_server_close_connection(c, who) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2408:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2409:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2417:        if unsafe { update_domain_info_inner(info) } == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2418:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2425:        info = unsafe { (*info).next };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2438:        let info = unsafe { *domains.add(usize::try_from(i).unwrap_or(0)) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2439:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2448:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2457:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2463:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2464:    assert!(unsafe { check_conn_functions(ptr::addr_of_mut!(ct_proxy_pass), 0) } >= 0);
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2466:    let info_ref = unsafe { &*info };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2468:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2475:    let port = if unsafe { (*conn).our_port } == 80 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2482:        unsafe { client_socket(info_ref.target.s_addr, port, 0) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2484:        unsafe { client_socket_ipv6(info_ref.target_ipv6.as_ptr(), port, SM_IPV6) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2488:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2499:    if let Some(crypto_free_fn) = unsafe { (*(*conn).type_).crypto_free } {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2500:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2505:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2509:    let ej = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2524:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2532:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2537:    let e_conn = unsafe { conn_info(ej) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2538:    assert!(!unsafe { (*e_conn).io_conn.is_null() });
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2539:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2543:    if let Some(parse_execute_fn) = unsafe { (*(*conn).type_).parse_execute } {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2544:        unsafe { parse_execute_fn(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2551:    let Some(key) = (unsafe { read_client_random_key(random) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2567:    let Some(key) = (unsafe { read_client_random_key(random) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2631:    let secret_slice = unsafe { slice::from_raw_parts(secret, 16) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2640:    unsafe { state_add_proxy_domain(domain) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2647:    unsafe { state_lookup_domain_info(domain, len) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2675:        i32::from(unsafe { (*info).server_hello_encrypted_size }),
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2676:        unsafe { (*info).use_random_encrypted_size != 0 },
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2677:        unsafe { libc::rand() },
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2682:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2683:    if unsafe { (*data).in_packet_num } != -3 {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2690:    unsafe { proxy_connection_impl(c, info) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2697:    let domain_bytes = unsafe { CStr::from_ptr(domain).to_bytes() };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2702:    let result = unsafe { libc::malloc(TLS_REQUEST_LENGTH) }.cast::<u8>();
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2706:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2729:        unsafe { slice::from_raw_parts(response, usize::try_from(len).unwrap_or(0)) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2730:    let request_session_id_slice = unsafe { slice::from_raw_parts(request_session_id, 32) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2731:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2742:    unsafe { update_domain_info_inner(info) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2750:        unsafe { slice::from_raw_parts(request, usize::try_from(len).unwrap_or(0)) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2751:    unsafe { get_sni_domain_info_inner(request_slice) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/core.rs:2755:    unsafe { parse_execute_inner(c) }
rust/mtproxy-ffi/src/server_functions/ffi.rs:11:    unsafe {
rust/mtproxy-ffi/src/server_functions/ffi.rs:29:    unsafe { sf_parse_option_add_ffi(name, arg, val, flags, func, help) }
rust/mtproxy-ffi/src/server_functions/ffi.rs:34:    unsafe { sf_parse_option_alias_ffi(name, val) }
rust/mtproxy-ffi/src/server_functions/ffi.rs:42:    unsafe { sf_parse_option_long_alias_ffi(name, alias_name) }
rust/mtproxy-ffi/src/server_functions/ffi.rs:60:    unsafe { sf_parse_engine_options_long_ffi(argc, argv) }
rust/mtproxy-ffi/src/server_functions/ffi.rs:80:    unsafe { parse_memory_limit_ffi(s) }
rust/mtproxy-ffi/src/server_functions/ffi.rs:88:    unsafe { change_user_group_ffi(username_ptr, groupname) }
rust/mtproxy-ffi/src/server_functions/ffi.rs:93:    unsafe { change_user_ffi(username_ptr) }
rust/mtproxy-ffi/src/stats/core.rs:25:    unsafe { *__errno_location() }
rust/mtproxy-ffi/src/stats/core.rs:128:    let n = unsafe { read_whole_file(proc_filename.as_bytes(), &mut buf) };
rust/mtproxy-ffi/src/stats/core.rs:135:    let page_size = unsafe {
rust/mtproxy-ffi/src/stats/core.rs:148:    unsafe {
rust/mtproxy-ffi/src/stats/core.rs:169:    let s_ref = unsafe { &mut *s };
rust/mtproxy-ffi/src/stats/core.rs:174:        let pid = unsafe { getpid() };
rust/mtproxy-ffi/src/stats/core.rs:175:        if unsafe { mtproxy_ffi_am_get_memory_usage(pid, a.as_mut_ptr(), 6) } < 0 {
rust/mtproxy-ffi/src/stats/core.rs:186:        let n = unsafe { read_whole_file(b"/proc/meminfo\0", &mut buf) };
rust/mtproxy-ffi/src/stats/core.rs:192:        let res = unsafe {
rust/mtproxy-ffi/src/stats/core.rs:222:    let mut p = unsafe { STAT_FUNC_FIRST };
rust/mtproxy-ffi/src/stats/core.rs:227:        let p_ref = unsafe { &*p };
rust/mtproxy-ffi/src/stats/core.rs:236:    let new_node = unsafe { malloc(core::mem::size_of::<StatFunEn>()) as *mut StatFunEn };
rust/mtproxy-ffi/src/stats/core.rs:241:    unsafe {
rust/mtproxy-ffi/src/stats/core.rs:262:    let sb_ref = unsafe { &mut *sb };
rust/mtproxy-ffi/src/stats/core.rs:277:    let buff = unsafe { malloc(size as usize) as *mut c_char };
rust/mtproxy-ffi/src/stats/core.rs:283:    let sb_ref = unsafe { &mut *sb };
rust/mtproxy-ffi/src/stats/core.rs:297:    let sb_ref = unsafe { &mut *sb };
rust/mtproxy-ffi/src/stats/core.rs:299:        unsafe { free(sb_ref.buff as *mut c_void) };
rust/mtproxy-ffi/src/stats/core.rs:310:    let sb_ref = unsafe { &mut *sb };
rust/mtproxy-ffi/src/stats/core.rs:316:    let buff_slice = unsafe { core::slice::from_raw_parts_mut(sb_ref.buff as *mut u8, size) };
rust/mtproxy-ffi/src/stats/core.rs:338:    let sb_ref = unsafe { &*sb };
rust/mtproxy-ffi/src/stats/core.rs:351:        let buff_slice = unsafe { core::slice::from_raw_parts(sb_ref.buff as *const u8, size) };
rust/mtproxy-ffi/src/stats/core.rs:365:    let sb_ref = unsafe { &mut *sb };
rust/mtproxy-ffi/src/stats/core.rs:368:    sb_ref.pos = unsafe { prepare_stats(sb_ref.buff, sb_ref.size) };
rust/mtproxy-ffi/src/stats/core.rs:370:    if unsafe { sb_full(sb) } {
rust/mtproxy-ffi/src/stats/core.rs:371:        unsafe { sb_truncate(sb) };
rust/mtproxy-ffi/src/stats/core.rs:376:    let mut p = unsafe { STAT_FUNC_FIRST };
rust/mtproxy-ffi/src/stats/core.rs:378:        let p_ref = unsafe { &*p };
rust/mtproxy-ffi/src/stats/core.rs:380:            unsafe { func(sb) };
rust/mtproxy-ffi/src/stats/core.rs:381:            if unsafe { sb_full(sb) } {
rust/mtproxy-ffi/src/stats/core.rs:382:                unsafe { sb_truncate(sb) };
rust/mtproxy-ffi/src/stats/core.rs:461:    if unsafe { mtproxy_ffi_am_get_memory_stats(&raw mut s, flags & 1) } == 0 {
rust/mtproxy-ffi/src/stats/core.rs:466:        unsafe { append_to_sb(sb, &formatted) };
rust/mtproxy-ffi/src/stats/core.rs:470:    if unsafe { mtproxy_ffi_am_get_memory_stats(&raw mut s, flags & 2) } == 0 {
rust/mtproxy-ffi/src/stats/core.rs:475:        unsafe { append_to_sb(sb, &formatted) };
rust/mtproxy-ffi/src/stats/core.rs:485:    let sb_ref = unsafe { &mut *sb };
rust/mtproxy-ffi/src/stats/core.rs:491:        let dest = unsafe { sb_ref.buff.offset(sb_ref.pos as isize) };
rust/mtproxy-ffi/src/stats/core.rs:492:        unsafe {
rust/mtproxy-ffi/src/stats/core.rs:499:            unsafe { *sb_ref.buff.offset(sb_ref.pos as isize) = 0 };
rust/mtproxy-ffi/src/stats/core.rs:517:    let desc_str = unsafe { CStr::from_ptr(desc) };
rust/mtproxy-ffi/src/stats/core.rs:529:    unsafe { append_to_sb(sb, &formatted) };
rust/mtproxy-ffi/src/stats/core.rs:545:        let ptr = unsafe { *base.offset(i) };
rust/mtproxy-ffi/src/stats/core.rs:547:            let value_ptr = unsafe { (ptr as *const u8).offset(offset as isize) as *const c_int };
rust/mtproxy-ffi/src/stats/core.rs:548:            res += unsafe { *value_ptr };
rust/mtproxy-ffi/src/stats/core.rs:567:        let ptr = unsafe { *base.offset(i) };
rust/mtproxy-ffi/src/stats/core.rs:569:            let value_ptr = unsafe { (ptr as *const u8).offset(offset as isize) as *const i64 };
rust/mtproxy-ffi/src/stats/core.rs:570:            res += unsafe { *value_ptr };
rust/mtproxy-ffi/src/stats/core.rs:589:        let ptr = unsafe { *base.offset(i) };
rust/mtproxy-ffi/src/stats/core.rs:592:                unsafe { (ptr as *const u8).offset(offset as isize) as *const c_double };
rust/mtproxy-ffi/src/stats/core.rs:593:            res += unsafe { *value_ptr };
rust/mtproxy-ffi/src/stats/core.rs:610:    let key_str = unsafe { CStr::from_ptr(key) };
rust/mtproxy-ffi/src/stats/core.rs:634:    let mut tm: Tm = unsafe { core::mem::zeroed() };
rust/mtproxy-ffi/src/stats/core.rs:635:    let tm_ptr = unsafe { gmtime_r(&unix_time, &raw mut tm) };
rust/mtproxy-ffi/src/stats/core.rs:640:        let l = unsafe {
rust/mtproxy-ffi/src/stats/core.rs:652:            unsafe { append_to_sb(sb, &formatted) };
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:10:    unsafe { create_request_impl(domain) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:21:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:36:    unsafe { update_domain_info_impl(info) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:44:    unsafe { get_sni_domain_info_impl(request, len) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:51:    unsafe { tcp_rpcs_compact_parse_execute_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:58:    unsafe { tcp_proxy_pass_parse_execute_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:66:    unsafe { tcp_proxy_pass_close_impl(c, who) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:74:    unsafe { tcp_proxy_pass_write_packet_impl(c, raw) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:82:    unsafe { tcp_rpc_init_proxy_domains_impl(domains, buckets) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:87:    unsafe { tcp_rpc_init_proxy_domains_state_impl() }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:95:    unsafe { proxy_connection_impl(c, info) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:100:    unsafe { tcp_rpcs_set_ext_secret_impl(secret) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:107:    unsafe { tcp_rpc_add_proxy_domain_state_impl(domain) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:115:    unsafe { lookup_domain_info_state_impl(domain, len) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:142:    unsafe { domain_server_hello_encrypted_size_impl(info) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:147:    unsafe { tcp_rpcs_ext_alarm_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:154:    unsafe { have_client_random_state_impl(random) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:162:    unsafe { add_client_random_state_impl(random, now) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:167:    unsafe { delete_old_client_randoms_state_impl(now) }
rust/mtproxy-ffi/src/net_tcp_rpc_ext_server/ffi.rs:175:    unsafe { is_allowed_timestamp_state_impl(timestamp, now) }
rust/mtproxy-ffi/src/mtproto/core.rs:21:    let raw = unsafe { slice_from_ptr(argv, count) }?;
rust/mtproxy-ffi/src/mtproto/core.rs:33:    let ptr_ref = unsafe { ref_from_ptr(ptr) }?;
rust/mtproxy-ffi/src/mtproto/core.rs:34:    let owned = unsafe { CStr::from_ptr(ptr_ref) }
rust/mtproxy-ffi/src/mtproto/core.rs:41:    unsafe { slice_from_ptr(cur.cast::<u8>(), len) }
rust/mtproxy-ffi/src/mtproto/core.rs:750:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:787:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:805:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:837:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:854:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:870:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:886:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:919:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:935:    let Some(out_current_ref) = (unsafe { mut_ref_from_ptr(out_current) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:938:    let Some(out_created_ref) = (unsafe { mut_ref_from_ptr(out_created) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:951:    let Some(ex_ref) = (unsafe { ref_from_ptr(ex) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:959:            let co = unsafe { connection_get_by_fd_generation(ex_ref.out_fd, ex_ref.out_gen) };
rust/mtproxy-ffi/src/mtproto/core.rs:961:                unsafe { mtproto_notify_remote_closed_owned(co, ex_ref.out_conn_id) };
rust/mtproxy-ffi/src/mtproto/core.rs:969:            let ci = unsafe { connection_get_by_fd_generation(ex_ref.in_fd, ex_ref.in_gen) };
rust/mtproxy-ffi/src/mtproto/core.rs:973:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:986:    let Some(ex_ref) = (unsafe { ref_from_ptr(ex) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:993:        unsafe { mtproto_ext_conn_get_by_out_conn_id_ffi(ex_ref.out_conn_id, &mut cur) };
rust/mtproxy-ffi/src/mtproto/core.rs:999:    unsafe { mtproto_notify_ext_connection_runtime_ffi(&cur, send_notifications) };
rust/mtproxy-ffi/src/mtproto/core.rs:1003:        unsafe { mtproto_ext_conn_remove_by_out_conn_id_ffi(cur.out_conn_id, &mut removed) };
rust/mtproxy-ffi/src/mtproto/core.rs:1029:    let Some(out_len_ref) = (unsafe { mut_ref_from_ptr(out_len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1032:    let Some(remote_ipv6_slice) = (unsafe { slice_from_ptr(remote_ipv6, 16) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1035:    let Some(our_ipv6_slice) = (unsafe { slice_from_ptr(our_ipv6, 16) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1038:    let Some(payload_slice) = (unsafe { slice_from_ptr(payload, payload_len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1048:        let Some(tag) = (unsafe { slice_from_ptr(proxy_tag_ptr, proxy_tag_len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1056:        let Some(origin) = (unsafe { slice_from_ptr(http_origin, http_origin_len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1059:        let Some(referer) = (unsafe { slice_from_ptr(http_referer, http_referer_len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1062:        let Some(user_agent) = (unsafe { slice_from_ptr(http_user_agent, http_user_agent_len) })
rust/mtproxy-ffi/src/mtproto/core.rs:1103:                let Some(out_slice) = (unsafe { mut_slice_from_ptr(out_buf, out_cap) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1134:    let Some(out_len_ref) = (unsafe { mut_ref_from_ptr(out_len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1159:    let Some(out_slice) = (unsafe { mut_slice_from_ptr(out_buf, out_cap) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:1172:    let unread = unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_unread(tlio_in) };
rust/mtproxy-ffi/src/mtproto/core.rs:1177:        unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_copy_through(tlio_in, tlio_out, unread, 1) };
rust/mtproxy-ffi/src/mtproto/core.rs:1183:        unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_store_end_ext(tlio_out, 0, &mut sent_kind) };
rust/mtproxy-ffi/src/mtproto/core.rs:1200:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1203:    let d = unsafe { mtproto_hts_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1208:    let unread = unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_unread(tlio_in) };
rust/mtproxy-ffi/src/mtproto/core.rs:1210:        let error_code = unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_int(tlio_in) };
rust/mtproxy-ffi/src/mtproto/core.rs:1211:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1218:        let rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1233:        let rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1247:        let tlio_out = unsafe { tl_out_state_alloc() };
rust/mtproxy-ffi/src/mtproto/core.rs:1251:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1268:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1272:    assert!(unsafe { (*conn).status == CONN_STATUS_WORKING && (*conn).pending_queries == 1 });
rust/mtproxy-ffi/src/mtproto/core.rs:1274:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1284:    let ext_rc = unsafe { mtproto_ext_conn_get_by_in_fd_ffi((*conn).fd, &mut ex) };
rust/mtproxy-ffi/src/mtproto/core.rs:1287:        unsafe { mtproto_remove_ext_connection_runtime_ffi(&ex, 1) };
rust/mtproxy-ffi/src/mtproto/core.rs:1291:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1310:    let c = unsafe { *conn_ptr };
rust/mtproxy-ffi/src/mtproto/core.rs:1313:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1316:    if unsafe { ((*c.cast::<MtprotoAsyncJobPrefix>()).j_flags & JF_COMPLETED) == 0 } {
rust/mtproxy-ffi/src/mtproto/core.rs:1317:        assert!(unsafe { (*conn).pending_queries >= 0 });
rust/mtproxy-ffi/src/mtproto/core.rs:1318:        assert!(unsafe { (*conn).pending_queries > 0 });
rust/mtproxy-ffi/src/mtproto/core.rs:1319:        assert!(unsafe { (*conn).pending_queries == 1 });
rust/mtproxy-ffi/src/mtproto/core.rs:1320:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1326:        assert!(unsafe { (*conn).pending_queries == 0 });
rust/mtproxy-ffi/src/mtproto/core.rs:1328:    unsafe { mtproto_job_decref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1336:    unsafe { mtproto_finish_postponed_http_response_ffi(data, len) }
rust/mtproxy-ffi/src/mtproto/core.rs:1346:    if unsafe { check_conn_buffers(c) } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:1347:        unsafe { mtproto_job_decref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1355:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1357:        unsafe { mtproto_job_decref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1362:    if unsafe { (*conn).type_ == http_type_ptr } {
rust/mtproxy-ffi/src/mtproto/core.rs:1363:        return unsafe { mtproto_http_send_message_ffi(c, tlio_in, flags) };
rust/mtproxy-ffi/src/mtproto/core.rs:1366:    let tlio_out = unsafe { tl_out_state_alloc() };
rust/mtproxy-ffi/src/mtproto/core.rs:1368:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1375:    if unsafe { check_conn_buffers(c) } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:1376:        unsafe { mtproto_job_decref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1379:        unsafe { mtproto_job_decref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1390:    let custom = unsafe { (*job).j_custom.as_ptr().cast_mut() };
rust/mtproxy-ffi/src/mtproto/core.rs:1396:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1400:    let base = unsafe { core::ptr::addr_of!((*conn).custom_data).cast::<u8>() as usize };
rust/mtproxy-ffi/src/mtproto/core.rs:1408:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1412:    let generation = unsafe { (*conn).generation };
rust/mtproxy-ffi/src/mtproto/core.rs:1419:        unsafe { job_decref(1, c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1425:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1429:    let base = unsafe { core::ptr::addr_of_mut!((*conn).custom_data).cast::<u8>() };
rust/mtproxy-ffi/src/mtproto/core.rs:1430:    unsafe { base.add(core::mem::size_of::<c_int>()).cast::<c_int>() }
rust/mtproxy-ffi/src/mtproto/core.rs:1435:    let ptr = unsafe { mtproto_http_query_flags_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1439:    unsafe { ptr.read_unaligned() }
rust/mtproxy-ffi/src/mtproto/core.rs:1444:    let ptr = unsafe { mtproto_http_query_flags_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1448:    unsafe { ptr.write_unaligned(value) };
rust/mtproxy-ffi/src/mtproto/core.rs:1453:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1457:    unsafe { core::ptr::addr_of_mut!((*conn).custom_data).cast::<MtprotoHtsData>() }
rust/mtproxy-ffi/src/mtproto/core.rs:1466:    let custom = unsafe { (*async_job).j_custom.as_ptr().cast_mut() };
rust/mtproxy-ffi/src/mtproto/core.rs:1476:    let custom = unsafe { (*job).j_custom.as_ptr().cast_mut() };
rust/mtproxy-ffi/src/mtproto/core.rs:1486:    let custom = unsafe { (*async_job).j_custom.as_ptr().cast_mut() };
rust/mtproxy-ffi/src/mtproto/core.rs:1521:    let cur_conf = unsafe { CurConf };
rust/mtproxy-ffi/src/mtproto/core.rs:1525:    assert!(unsafe { (*cur_conf).auth_clusters } > 0);
rust/mtproxy-ffi/src/mtproto/core.rs:1527:    let mfc = unsafe { mf_cluster_lookup_ffi(cur_conf, target_dc, 1) };
rust/mtproxy-ffi/src/mtproto/core.rs:1536:        let targets_num = unsafe { (*mfc).targets_num };
rust/mtproxy-ffi/src/mtproto/core.rs:1542:        let rand = unsafe { lrand48() };
rust/mtproxy-ffi/src/mtproto/core.rs:1545:        let targets = unsafe { (*mfc).cluster_targets };
rust/mtproxy-ffi/src/mtproto/core.rs:1547:        let s = unsafe { *targets.add(rand_idx) };
rust/mtproxy-ffi/src/mtproto/core.rs:1550:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1556:            let data = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1557:            if !data.is_null() && unsafe { (*data).extra_int == mtproto_conn_tag(c) } {
rust/mtproxy-ffi/src/mtproto/core.rs:1558:                unsafe { mtproto_job_decref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1568:    unsafe { mtproto_choose_proxy_target_impl(target_dc) }
rust/mtproxy-ffi/src/mtproto/core.rs:1577:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1583:        let data = unsafe { mtproto_rpc_data_ptr(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:1585:            unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:1588:        let tag = unsafe { mtproto_conn_tag(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:1589:        if unsafe { (*data).extra_int } == tag {
rust/mtproxy-ffi/src/mtproto/core.rs:1592:        unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:1605:        if let Some(values) = unsafe { slice_from_ptr(ip_port_override, 5) } {
rust/mtproxy-ffi/src/mtproto/core.rs:1606:            if let Some(ipv6_src) = unsafe { slice_from_ptr(ip_port_override.cast::<u8>(), 16) } {
rust/mtproxy-ffi/src/mtproto/core.rs:1613:    let conn_ref = unsafe { &*conn };
rust/mtproxy-ffi/src/mtproto/core.rs:1624:            unsafe { nat_translate_ip(ip) }
rust/mtproxy-ffi/src/mtproto/core.rs:1653:        unsafe { slice_from_ptr(core::ptr::addr_of!(proxy_tag).cast::<u8>(), 16) }?
rust/mtproxy-ffi/src/mtproto/core.rs:1657:    let http_origin_len = unsafe { cur_http_origin_len.max(0) as usize };
rust/mtproxy-ffi/src/mtproto/core.rs:1658:    let http_referer_len = unsafe { cur_http_referer_len.max(0) as usize };
rust/mtproxy-ffi/src/mtproto/core.rs:1659:    let http_user_agent_len = unsafe { cur_http_user_agent_len.max(0) as usize };
rust/mtproxy-ffi/src/mtproto/core.rs:1661:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1671:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1681:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1713:    let rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1744:    let rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1775:    let tlio_out = unsafe { tl_out_state_alloc() };
rust/mtproxy-ffi/src/mtproto/core.rs:1779:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1783:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1787:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1806:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1810:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1813:    let data = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1817:    let target_dc = unsafe { (*data).extra_int4 };
rust/mtproxy-ffi/src/mtproto/core.rs:1818:    let s = unsafe { mtproto_choose_proxy_target_impl(target_dc) };
rust/mtproxy-ffi/src/mtproto/core.rs:1820:    let unread = unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_unread(tlio_in) };
rust/mtproxy-ffi/src/mtproto/core.rs:1822:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1850:    let looked_up = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1862:    let inspect_rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1875:        return unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1890:    let data = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1894:    let target_dc = unsafe { (*data).extra_int4 };
rust/mtproxy-ffi/src/mtproto/core.rs:1895:    let s = unsafe { mtproto_choose_proxy_target_impl(target_dc) };
rust/mtproxy-ffi/src/mtproto/core.rs:1896:    let unread = unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_unread(tlio_in) };
rust/mtproxy-ffi/src/mtproto/core.rs:1898:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1915:    let tlio_out = unsafe { tl_out_state_alloc() };
rust/mtproxy-ffi/src/mtproto/core.rs:1919:    let c_ref = unsafe { job_incref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1921:        unsafe { tl_out_state_free(tlio_out) };
rust/mtproxy-ffi/src/mtproto/core.rs:1924:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1933:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1943:    let tlio_out = unsafe { tl_out_state_alloc() };
rust/mtproxy-ffi/src/mtproto/core.rs:1947:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1956:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1970:    let d = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1974:    if (unsafe { lrand48_j() } & 1) != 0 || (unsafe { (*d).flags } & RPC_F_PAD) == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:1975:        let msg = unsafe { libc::malloc(core::mem::size_of::<MtprotoRawMessage>()) }
rust/mtproxy-ffi/src/mtproto/core.rs:1981:        assert!(unsafe { rwm_create(msg, prefix.as_ptr().cast(), 1) } == 1);
rust/mtproxy-ffi/src/mtproto/core.rs:1982:        assert!(unsafe { rwm_push_data(msg, core::ptr::addr_of!(confirm).cast(), 4) } == 4);
rust/mtproxy-ffi/src/mtproto/core.rs:1983:        let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:1984:        if conn.is_null() || unsafe { (*conn).out_queue.is_null() } {
rust/mtproxy-ffi/src/mtproto/core.rs:1985:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:1991:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2001:        unsafe { rwm_create(core::ptr::addr_of_mut!(m), core::ptr::addr_of!(x).cast(), 4) } == 4
rust/mtproxy-ffi/src/mtproto/core.rs:2004:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2013:    let mut z = unsafe { lrand48_j() } & 1;
rust/mtproxy-ffi/src/mtproto/core.rs:2015:        let t = unsafe { lrand48_j() as c_int };
rust/mtproxy-ffi/src/mtproto/core.rs:2017:            unsafe { rwm_push_data(core::ptr::addr_of_mut!(m), core::ptr::addr_of!(t).cast(), 4) }
rust/mtproxy-ffi/src/mtproto/core.rs:2023:    let c_ref = unsafe { job_incref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2025:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2032:        unsafe { rwm_create(core::ptr::addr_of_mut!(m), core::ptr::addr_of!(x).cast(), 4) } == 4
rust/mtproxy-ffi/src/mtproto/core.rs:2035:    z = unsafe { lrand48_j() } & 1;
rust/mtproxy-ffi/src/mtproto/core.rs:2037:        let t = unsafe { lrand48_j() as c_int };
rust/mtproxy-ffi/src/mtproto/core.rs:2039:            unsafe { rwm_push_data(core::ptr::addr_of_mut!(m), core::ptr::addr_of!(t).cast(), 4) }
rust/mtproxy-ffi/src/mtproto/core.rs:2045:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2058:    let len = unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_unread(tlio_in) };
rust/mtproxy-ffi/src/mtproto/core.rs:2065:        let got = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2077:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2081:    let conn_fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:2082:    let conn_gen = unsafe { (*conn).generation };
rust/mtproxy-ffi/src/mtproto/core.rs:2092:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2099:            let d = unsafe { connection_get_by_fd_generation(planned.in_fd, planned.in_gen) };
rust/mtproxy-ffi/src/mtproto/core.rs:2101:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2112:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2120:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2127:            let d = unsafe { connection_get_by_fd_generation(planned.in_fd, planned.in_gen) };
rust/mtproxy-ffi/src/mtproto/core.rs:2131:                let d_data = unsafe { mtproto_rpc_data_ptr(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:2132:                if !d_data.is_null() && (unsafe { (*d_data).flags } & RPC_F_COMPACT) != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2135:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2140:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2148:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2156:            let ci = unsafe { connection_get_by_fd_generation(planned.in_fd, planned.in_gen) };
rust/mtproxy-ffi/src/mtproto/core.rs:2158:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2178:    let d = unsafe { mtproto_http_query_info_ptr(hqj) };
rust/mtproxy-ffi/src/mtproto/core.rs:2182:    let c = unsafe { (*d).conn };
rust/mtproxy-ffi/src/mtproto/core.rs:2187:    let header_size = unsafe { (*d).header_size };
rust/mtproxy-ffi/src/mtproto/core.rs:2188:    let first_line_size = unsafe { (*d).first_line_size };
rust/mtproxy-ffi/src/mtproto/core.rs:2198:    let header_ptr = unsafe { core::ptr::addr_of_mut!((*d).header).cast::<u8>() };
rust/mtproxy-ffi/src/mtproto/core.rs:2199:    let Some(header) = (unsafe { slice_from_ptr(header_ptr, header_len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:2206:    let uri_offset = unsafe { (*d).uri_offset };
rust/mtproxy-ffi/src/mtproto/core.rs:2207:    let uri_size = unsafe { (*d).uri_size };
rust/mtproxy-ffi/src/mtproto/core.rs:2228:        let mut query_flags = unsafe { mtproto_http_query_flags_get(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2231:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2237:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2242:        if unsafe { (*d).query_type } == HTQT_OPTIONS {
rust/mtproxy-ffi/src/mtproto/core.rs:2256:            let raw = unsafe { calloc(1, core::mem::size_of::<MtprotoRawMessage>()) }
rust/mtproxy-ffi/src/mtproto/core.rs:2260:                let rc = unsafe { rwm_create(raw, response.as_ptr().cast(), len) };
rust/mtproxy-ffi/src/mtproto/core.rs:2262:                    unsafe { http_flush(c, raw) };
rust/mtproxy-ffi/src/mtproto/core.rs:2264:                    unsafe { free(raw.cast()) };
rust/mtproxy-ffi/src/mtproto/core.rs:2270:        if (unsafe { (*d).data_size } & 3) != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2274:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2303:        let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2307:        let remote_ip = unsafe { (*conn).remote_ip };
rust/mtproxy-ffi/src/mtproto/core.rs:2311:            let x_real_ip_len = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2321:            let x_real_port_len = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2335:                    unsafe { mtproto_parse_text_ipv4_ffi(x_real_ip.as_ptr(), &mut real_ip) };
rust/mtproxy-ffi/src/mtproto/core.rs:2336:                let parse_ipv6_rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2353:                        unsafe { libc::atoi(x_real_port.as_ptr()) }
rust/mtproxy-ffi/src/mtproto/core.rs:2363:        let res = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2387:    let d = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2400:            let Some(func) = (unsafe { (*d).func }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:2404:            let custom_bytes = unsafe { (*job_prefix).j_custom_bytes };
rust/mtproxy-ffi/src/mtproto/core.rs:2408:            let data_ptr = unsafe { d.cast::<u8>().add(payload_offset as usize).cast::<c_void>() };
rust/mtproxy-ffi/src/mtproto/core.rs:2411:        JS_FINISH => unsafe { job_free(1, job.cast::<c_void>()) },
rust/mtproxy-ffi/src/mtproto/core.rs:2427:    let hq = unsafe { mtproto_http_query_info_ptr(job) };
rust/mtproxy-ffi/src/mtproto/core.rs:2435:            let conn = unsafe { (*hq).conn };
rust/mtproxy-ffi/src/mtproto/core.rs:2436:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2439:            let tlio_in = unsafe { tl_in_state_alloc() };
rust/mtproxy-ffi/src/mtproto/core.rs:2443:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2451:            let res = unsafe { mtproto_process_http_query_ffi(tlio_in.cast::<c_void>(), job) };
rust/mtproxy-ffi/src/mtproto/core.rs:2452:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2455:            assert!(unsafe { (*hq).msg.magic } == 0);
rust/mtproxy-ffi/src/mtproto/core.rs:2457:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2461:                assert!((unsafe { (*hq).flags } & 1) != 0);
rust/mtproxy-ffi/src/mtproto/core.rs:2462:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2469:            if unsafe { (*job_prefix).j_error } == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2470:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2477:            if unsafe { (*job_prefix).j_error } == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2478:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2485:            if (unsafe { (*hq).flags } & 1) != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2486:                let c = if !unsafe { (*hq).conn }.is_null() {
rust/mtproxy-ffi/src/mtproto/core.rs:2487:                    unsafe { job_incref((*hq).conn) }
rust/mtproxy-ffi/src/mtproto/core.rs:2489:                    unsafe { connection_get_by_fd_generation((*hq).conn_fd, (*hq).conn_generation) }
rust/mtproxy-ffi/src/mtproto/core.rs:2492:                    let c_conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2494:                        assert!(unsafe { (*c_conn).pending_queries } == 1);
rust/mtproxy-ffi/src/mtproto/core.rs:2495:                        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2498:                        let query_flags = unsafe { mtproto_http_query_flags_get(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2500:                            && unsafe { (*c_conn).status } == CONN_STATUS_WORKING
rust/mtproxy-ffi/src/mtproto/core.rs:2502:                            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2507:                    unsafe { mtproto_job_decref(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2509:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2514:            if !unsafe { (*hq).conn }.is_null() {
rust/mtproxy-ffi/src/mtproto/core.rs:2515:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2519:            if unsafe { (*hq).msg.magic } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2520:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2524:            unsafe { mtproxy_ffi_net_connections_job_free(job) }
rust/mtproxy-ffi/src/mtproto/core.rs:2538:    let d = unsafe { mtproto_client_packet_info_ptr(job) };
rust/mtproxy-ffi/src/mtproto/core.rs:2546:            let tlio_in = unsafe { tl_in_state_alloc() };
rust/mtproxy-ffi/src/mtproto/core.rs:2548:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2562:            if unsafe { (*job_prefix).j_error } == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2563:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2570:            if unsafe { (*job_prefix).j_error } == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2571:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2578:            if !unsafe { (*d).conn }.is_null() {
rust/mtproxy-ffi/src/mtproto/core.rs:2579:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2583:            if unsafe { (*d).msg.magic } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2584:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2588:            unsafe { mtproxy_ffi_net_connections_job_free(job.cast::<c_void>()) }
rust/mtproxy-ffi/src/mtproto/core.rs:2599:    unsafe { mtproto_client_packet_job_run_ffi(job.cast::<c_void>(), op, jt) }
rust/mtproxy-ffi/src/mtproto/core.rs:2611:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2616:    if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/mtproto/core.rs:2617:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2626:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2642:            let job = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2654:            let d = unsafe { mtproto_client_packet_info_ptr(job.cast::<c_void>()) };
rust/mtproxy-ffi/src/mtproto/core.rs:2657:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2665:            if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/mtproto/core.rs:2666:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2684:    let d = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2685:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2690:    let fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:2692:    assert!(unsafe { (*d).extra_int == 0 });
rust/mtproxy-ffi/src/mtproto/core.rs:2693:    let tag = unsafe { mtproto_conn_tag(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2695:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2699:    if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/mtproto/core.rs:2700:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2707:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2719:    let d = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2720:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2725:    let fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:2728:    if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/mtproto/core.rs:2729:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2739:    if unsafe { (*d).extra_int } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2740:        assert!(unsafe { (*d).extra_int == mtproto_conn_tag(c) });
rust/mtproxy-ffi/src/mtproto/core.rs:2743:            let rc = unsafe { mtproto_ext_conn_remove_any_by_out_fd_ffi(fd, &mut ex) };
rust/mtproxy-ffi/src/mtproto/core.rs:2748:            unsafe { mtproto_notify_ext_connection_runtime_ffi(&ex, 2) };
rust/mtproxy-ffi/src/mtproto/core.rs:2751:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2761:    let fd = unsafe { *fd_ptr };
rust/mtproxy-ffi/src/mtproto/core.rs:2763:    let rc = unsafe { mtproto_ext_conn_get_by_in_fd_ffi(fd, &mut ex) };
rust/mtproxy-ffi/src/mtproto/core.rs:2766:        unsafe { mtproto_remove_ext_connection_runtime_ffi(&ex, 1) };
rust/mtproxy-ffi/src/mtproto/core.rs:2776:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2780:    let fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:2782:    if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/mtproto/core.rs:2783:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2796:    if unsafe { verbosity } >= 3 {
rust/mtproxy-ffi/src/mtproto/core.rs:2797:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2801:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2812:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2816:    let fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:2818:    if unsafe { verbosity } >= 3 {
rust/mtproxy-ffi/src/mtproto/core.rs:2819:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2828:    let rc = unsafe { mtproto_ext_conn_get_by_in_fd_ffi(fd, &mut ex) };
rust/mtproxy-ffi/src/mtproto/core.rs:2831:        unsafe { mtproto_remove_ext_connection_runtime_ffi(&ex, 1) };
rust/mtproxy-ffi/src/mtproto/core.rs:2841:    let d = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2842:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2846:    let fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:2848:    if unsafe { verbosity } >= 3 {
rust/mtproxy-ffi/src/mtproto/core.rs:2849:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2853:    assert!(unsafe { (*d).extra_int == 0 });
rust/mtproxy-ffi/src/mtproto/core.rs:2854:    let tag = unsafe { mtproto_conn_tag(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2856:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2868:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2872:    let fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:2875:    if unsafe { verbosity } >= 3 {
rust/mtproxy-ffi/src/mtproto/core.rs:2876:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2888:    if unsafe { (*conn).pending_queries } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2889:        assert!(unsafe { (*conn).pending_queries == 1 });
rust/mtproxy-ffi/src/mtproto/core.rs:2890:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2897:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2913:    let d = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2914:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:2919:    let fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:2922:    if unsafe { verbosity } >= 3 {
rust/mtproxy-ffi/src/mtproto/core.rs:2923:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2934:    if unsafe { (*d).extra_int } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:2935:        assert!(unsafe { (*d).extra_int == -mtproto_conn_tag(c) });
rust/mtproxy-ffi/src/mtproto/core.rs:2938:            let rc = unsafe { mtproto_ext_conn_remove_any_by_in_fd_ffi(fd, &mut ex) };
rust/mtproxy-ffi/src/mtproto/core.rs:2943:            unsafe { mtproto_notify_ext_connection_runtime_ffi(&ex, 1) };
rust/mtproxy-ffi/src/mtproto/core.rs:2946:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2957:    let conn = unsafe { (*data).conn };
rust/mtproxy-ffi/src/mtproto/core.rs:2958:    unsafe { lru_insert_conn(conn) };
rust/mtproxy-ffi/src/mtproto/core.rs:2960:    let len = unsafe { (*data).msg.total_bytes };
rust/mtproxy-ffi/src/mtproto/core.rs:2961:    let tlio_in = unsafe { tl_in_state_alloc() };
rust/mtproxy-ffi/src/mtproto/core.rs:2963:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2967:    let res = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2976:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2981:    if res == 0 && unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/mtproto/core.rs:2982:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:2994:    unsafe { mtproto_do_rpcs_execute_ffi(data, s_len) }
rust/mtproxy-ffi/src/mtproto/core.rs:3005:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3010:    let len = unsafe { (*msg).total_bytes };
rust/mtproxy-ffi/src/mtproto/core.rs:3012:    if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/mtproto/core.rs:3013:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3026:        if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/mtproto/core.rs:3027:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3039:    if unsafe { check_conn_buffers(c) } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:3043:    let c_data = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3047:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3070:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3075:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3107:    if unsafe { mtproto_ext_conn_counts_ffi(&mut ext_connections, &mut ext_connections_created) }
rust/mtproxy-ffi/src/mtproto/core.rs:3114:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3122:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3130:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3137:        let pop_rc = unsafe { mtproto_ext_conn_lru_pop_oldest_ffi(core::ptr::addr_of_mut!(ext)) };
rust/mtproxy-ffi/src/mtproto/core.rs:3142:        if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/mtproto/core.rs:3143:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3155:        let d = unsafe { connection_get_by_fd_generation(ext.in_fd, ext.in_gen) };
rust/mtproxy-ffi/src/mtproto/core.rs:3157:            let conn = unsafe { mtproto_conn_info_ptr(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:3159:                let tot_used_bytes = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3167:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3172:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3183:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3187:    let tot_used_bytes = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3194:        if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/mtproto/core.rs:3195:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3206:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3221:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3420:    if unsafe { workers } == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:3424:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3428:    let workers_count = usize::try_from(unsafe { workers }).unwrap_or(0);
rust/mtproxy-ffi/src/mtproto/core.rs:3435:            f = unsafe { WStats.add(i.saturating_mul(2)) };
rust/mtproxy-ffi/src/mtproto/core.rs:3438:                f = unsafe { f.add(1) };
rust/mtproxy-ffi/src/mtproto/core.rs:3439:                s_cnt = unsafe { (*f).cnt };
rust/mtproxy-ffi/src/mtproto/core.rs:3443:                f = unsafe { f.sub(1) };
rust/mtproxy-ffi/src/mtproto/core.rs:3444:                s_cnt = unsafe { (*f).cnt };
rust/mtproxy-ffi/src/mtproto/core.rs:3450:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3454:            if s_cnt == unsafe { (*f).cnt } {
rust/mtproxy-ffi/src/mtproto/core.rs:3458:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3471:    let cur_conf = unsafe { CurConf };
rust/mtproxy-ffi/src/mtproto/core.rs:3482:    let uptime = now_unix.wrapping_sub(unsafe { start_time });
rust/mtproxy-ffi/src/mtproto/core.rs:3486:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3493:    if unsafe { mtproto_ext_conn_counts_ffi(&mut ext_connections, &mut ext_connections_created) }
rust/mtproxy-ffi/src/mtproto/core.rs:3500:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3505:    let use_worker_totals = unsafe { workers != 0 };
rust/mtproxy-ffi/src/mtproto/core.rs:3506:    let total_get_queries = unsafe { get_queries.wrapping_add(SumStats.get_queries) };
rust/mtproxy-ffi/src/mtproto/core.rs:3507:    let total_http_queries = unsafe { http_queries.wrapping_add(SumStats.http_queries) };
rust/mtproxy-ffi/src/mtproto/core.rs:3510:        unsafe { SumStats.conn.ready_targets }
rust/mtproxy-ffi/src/mtproto/core.rs:3513:            .wrapping_add(unsafe { SumStats.conn.ready_targets })
rust/mtproxy-ffi/src/mtproto/core.rs:3516:        unsafe { SumStats.conn.allocated_targets }
rust/mtproxy-ffi/src/mtproto/core.rs:3519:            .wrapping_add(unsafe { SumStats.conn.allocated_targets })
rust/mtproxy-ffi/src/mtproto/core.rs:3522:        unsafe { SumStats.conn.active_targets }
rust/mtproxy-ffi/src/mtproto/core.rs:3525:            .wrapping_add(unsafe { SumStats.conn.active_targets })
rust/mtproxy-ffi/src/mtproto/core.rs:3528:        unsafe { SumStats.conn.inactive_targets }
rust/mtproxy-ffi/src/mtproto/core.rs:3531:            .wrapping_add(unsafe { SumStats.conn.inactive_targets })
rust/mtproxy-ffi/src/mtproto/core.rs:3534:        unsafe { SumStats.conn.active_special_connections }
rust/mtproxy-ffi/src/mtproto/core.rs:3537:            .wrapping_add(unsafe { SumStats.conn.active_special_connections })
rust/mtproxy-ffi/src/mtproto/core.rs:3540:        unsafe { SumStats.conn.max_special_connections }
rust/mtproxy-ffi/src/mtproto/core.rs:3543:            .wrapping_add(unsafe { SumStats.conn.max_special_connections })
rust/mtproxy-ffi/src/mtproto/core.rs:3546:        unsafe { SumStats.bufs.total_used_buffers_size }
rust/mtproxy-ffi/src/mtproto/core.rs:3549:            .wrapping_add(unsafe { SumStats.bufs.total_used_buffers_size })
rust/mtproxy-ffi/src/mtproto/core.rs:3552:        unsafe { SumStats.bufs.allocated_buffer_bytes }
rust/mtproxy-ffi/src/mtproto/core.rs:3555:            .wrapping_add(unsafe { SumStats.bufs.allocated_buffer_bytes })
rust/mtproxy-ffi/src/mtproto/core.rs:3558:        unsafe { SumStats.bufs.total_used_buffers }
rust/mtproxy-ffi/src/mtproto/core.rs:3561:            .wrapping_add(unsafe { SumStats.bufs.total_used_buffers })
rust/mtproxy-ffi/src/mtproto/core.rs:3564:        unsafe { SumStats.bufs.allocated_buffer_chunks }
rust/mtproxy-ffi/src/mtproto/core.rs:3567:            .wrapping_add(unsafe { SumStats.bufs.allocated_buffer_chunks })
rust/mtproxy-ffi/src/mtproto/core.rs:3570:        unsafe { SumStats.bufs.max_allocated_buffer_chunks }
rust/mtproxy-ffi/src/mtproto/core.rs:3573:            .wrapping_add(unsafe { SumStats.bufs.max_allocated_buffer_chunks })
rust/mtproxy-ffi/src/mtproto/core.rs:3575:    let cfg_filename = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3582:    let cfg_md5 = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3590:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3737:    let d = unsafe { mtproto_hts_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3738:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3743:    if unsafe { check_conn_buffers(c) } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:3747:    if op != HTQT_GET || unsafe { (*d).data_size } != -1 {
rust/mtproxy-ffi/src/mtproto/core.rs:3748:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3753:    if unsafe { (*conn).remote_ip } != 0x7f00_0001 {
rust/mtproxy-ffi/src/mtproto/core.rs:3757:    if unsafe { (*d).uri_size } != 6 {
rust/mtproxy-ffi/src/mtproto/core.rs:3761:    let header_size = unsafe { (*d).header_size };
rust/mtproxy-ffi/src/mtproto/core.rs:3767:        unsafe { rwm_fetch_data(msg, req_hdr.as_mut_ptr().cast(), header_size) } == header_size
rust/mtproxy-ffi/src/mtproto/core.rs:3770:    let uri_offset = usize::try_from(unsafe { (*d).uri_offset }).ok();
rust/mtproxy-ffi/src/mtproto/core.rs:3787:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3792:    let raw = unsafe { libc::calloc(1, core::mem::size_of::<MtprotoRawMessage>()) }
rust/mtproxy-ffi/src/mtproto/core.rs:3795:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3800:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3827:    let d = unsafe { mtproto_hts_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3828:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3833:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3849:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3855:    if unsafe { check_conn_buffers(c) } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:3858:    if unsafe { (*d).data_size } >= MAX_POST_SIZE {
rust/mtproxy-ffi/src/mtproto/core.rs:3862:    if !((unsafe { (*d).query_type } == HTQT_POST && unsafe { (*d).data_size } > 0)
rust/mtproxy-ffi/src/mtproto/core.rs:3863:        || (unsafe { (*d).query_type } == HTQT_OPTIONS && unsafe { (*d).data_size } < 0))
rust/mtproxy-ffi/src/mtproto/core.rs:3865:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3871:    if unsafe { (*d).data_size } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:3872:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3877:    if unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3883:    if unsafe { (*d).data_size } > 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:3884:        let need_bytes = unsafe { (*d).data_size + (*d).header_size - (*msg).total_bytes };
rust/mtproxy-ffi/src/mtproto/core.rs:3886:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3896:    assert!(unsafe { (*msg).total_bytes } == unsafe { (*d).header_size + (*d).data_size });
rust/mtproxy-ffi/src/mtproto/core.rs:3904:        .saturating_add(usize::try_from(unsafe { (*d).header_size }).unwrap_or(0))
rust/mtproxy-ffi/src/mtproto/core.rs:3906:    let job = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3918:    let hq = unsafe { mtproto_http_query_info_ptr(job.cast()) };
rust/mtproxy-ffi/src/mtproto/core.rs:3921:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3959:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3960:    let d = unsafe { mtproto_hts_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:3965:    if unsafe { verbosity } >= 2 {
rust/mtproxy-ffi/src/mtproto/core.rs:3966:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3974:    assert!(unsafe { (*conn).status == CONN_STATUS_WORKING });
rust/mtproxy-ffi/src/mtproto/core.rs:3975:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3980:    if unsafe { (*conn).pending_queries } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:3981:        assert!(unsafe { (*conn).pending_queries == 1 });
rust/mtproxy-ffi/src/mtproto/core.rs:3982:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3988:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:3996:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4082:        OPT_C => unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4088:        OPT_W => unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4091:        OPT_H => unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4118:        OPT_M => unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4122:        OPT_T => unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4128:        2000 => unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4135:        OPT_D => unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4139:        OPT_S | OPT_P => unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4192:    let workers_count = usize::try_from(unsafe { workers })
rust/mtproxy-ffi/src/mtproto/core.rs:4199:            if unsafe { pids[i] } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4201:                let res = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4204:                if res == unsafe { pids[i] } {
rust/mtproxy-ffi/src/mtproto/core.rs:4206:                        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4214:                } else if res != -1 || unsafe { *libc::__errno_location() } != libc::EINTR {
rust/mtproxy-ffi/src/mtproto/core.rs:4215:                    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4228:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4238:            if unsafe { pids[i] } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4240:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4245:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4257:    if unsafe { workers } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4258:        let workers_count = usize::try_from(unsafe { workers })
rust/mtproxy-ffi/src/mtproto/core.rs:4264:                unsafe { libc::waitpid(pids[i], core::ptr::addr_of_mut!(status), libc::WNOHANG) };
rust/mtproxy-ffi/src/mtproto/core.rs:4265:            if res == unsafe { pids[i] } {
rust/mtproxy-ffi/src/mtproto/core.rs:4267:                    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4275:                        if unsafe { pids[j] } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4276:                            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4281:                    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4287:            } else if res != -1 || unsafe { *libc::__errno_location() } != libc::EINTR {
rust/mtproxy-ffi/src/mtproto/core.rs:4288:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4299:                    if unsafe { pids[j] } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4300:                        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4305:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4311:    } else if unsafe { slave_mode } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4312:        let ppid = unsafe { libc::getppid() };
rust/mtproxy-ffi/src/mtproto/core.rs:4313:        if ppid != unsafe { parent_pid } {
rust/mtproxy-ffi/src/mtproto/core.rs:4314:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4327:    if unsafe { max_special_connections == 0 || slave_mode != 0 } {
rust/mtproxy-ffi/src/mtproto/core.rs:4330:    let max_user_conn = if unsafe { workers } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4331:        unsafe { SumStats.conn.max_special_connections }
rust/mtproxy-ffi/src/mtproto/core.rs:4333:        unsafe { max_special_connections }
rust/mtproxy-ffi/src/mtproto/core.rs:4335:    let cur_user_conn = if unsafe { workers } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4336:        unsafe { SumStats.conn.active_special_connections }
rust/mtproxy-ffi/src/mtproto/core.rs:4338:        unsafe { active_special_connections }
rust/mtproxy-ffi/src/mtproto/core.rs:4341:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4354:    let workers_count = unsafe { workers };
rust/mtproxy-ffi/src/mtproto/core.rs:4358:        let pid = unsafe { pids[i] };
rust/mtproxy-ffi/src/mtproto/core.rs:4360:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4368:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4377:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4395:    if argc != 1 || argv.is_null() || unsafe { (*argv).is_null() } {
rust/mtproxy-ffi/src/mtproto/core.rs:4396:        unsafe { mtproto_usage_ffi() };
rust/mtproxy-ffi/src/mtproto/core.rs:4398:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4408:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4417:    if unsafe { workers } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4418:        if unsafe { signal_check_pending(libc::SIGTERM) } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4419:            unsafe { mtproto_kill_children_ffi(libc::SIGTERM) };
rust/mtproxy-ffi/src/mtproto/core.rs:4421:        unsafe { mtproto_check_children_dead_ffi() };
rust/mtproxy-ffi/src/mtproto/core.rs:4426:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4443:        if unsafe { check() } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4444:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4450:    let res = unsafe { mtproto_cfg_do_reload_config_ffi(0x26) };
rust/mtproxy-ffi/src/mtproto/core.rs:4453:        unsafe { libc::exit(-res) };
rust/mtproxy-ffi/src/mtproto/core.rs:4456:    unsafe { kprintf(b"config loaded!\n\0".as_ptr().cast()) };
rust/mtproxy-ffi/src/mtproto/core.rs:4458:    if unsafe { domain_count != 0 } {
rust/mtproxy-ffi/src/mtproto/core.rs:4459:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4479:    let enable_ipv6 = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4487:    let settings_addr = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4494:    let backlog = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4501:    let http_ports_count = unsafe { http_ports_num };
rust/mtproxy-ffi/src/mtproto/core.rs:4506:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4521:    let workers_count = unsafe { workers };
rust/mtproxy-ffi/src/mtproto/core.rs:4523:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4568:    let res = unsafe { mtproto_cfg_do_reload_config_ffi(0x17) };
rust/mtproxy-ffi/src/mtproto/core.rs:4571:        unsafe { libc::exit(-res) };
rust/mtproxy-ffi/src/mtproto/core.rs:4574:    let cur_conf = unsafe { CurConf };
rust/mtproxy-ffi/src/mtproto/core.rs:4576:    assert!(unsafe { (*cur_conf).have_proxy != 0 });
rust/mtproxy-ffi/src/mtproto/core.rs:4578:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4587:    let enable_ipv6 = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4595:    if unsafe { domain_count } == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4596:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4604:    if unsafe { workers } == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4605:        let ports_count = usize::try_from(unsafe { http_ports_num })
rust/mtproxy-ffi/src/mtproto/core.rs:4611:                | if unsafe { domain_count } == 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4616:                | if unsafe { max_special_connections } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4621:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4630:            let clamp = unsafe { window_clamp };
rust/mtproxy-ffi/src/mtproto/core.rs:4632:                let fd = unsafe { http_sfd[i] };
rust/mtproxy-ffi/src/mtproto/core.rs:4635:                let lc = unsafe { Events[fd_u].data };
rust/mtproxy-ffi/src/mtproto/core.rs:4637:                let lc_info = unsafe { mtproto_listening_conn_info_ptr(lc) };
rust/mtproxy-ffi/src/mtproto/core.rs:4639:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4642:                let set_rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4651:                if set_rc < 0 && unsafe { verbosity } >= 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4652:                    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4680:    let conn = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:4687:    let is_ext_server = unsafe { (*conn).type_ == ext_type_ptr };
rust/mtproxy-ffi/src/mtproto/core.rs:4688:    let is_http_server = unsafe { (*conn).type_ == http_type_ptr };
rust/mtproxy-ffi/src/mtproto/core.rs:4691:        let c_data = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:4695:        flags |= unsafe { (*c_data).flags & RPC_F_DROPPED };
rust/mtproxy-ffi/src/mtproto/core.rs:4701:    let c_fd = unsafe { (*conn).fd };
rust/mtproxy-ffi/src/mtproto/core.rs:4703:    let ex_lookup_rc = unsafe { mtproto_ext_conn_get_by_in_fd_ffi(c_fd, &mut ex) };
rust/mtproxy-ffi/src/mtproto/core.rs:4711:            unsafe { mtproto_ext_conn_update_auth_key_ffi(ex.in_fd, ex.in_conn_id, auth_key_id) };
rust/mtproxy-ffi/src/mtproto/core.rs:4720:        d = unsafe { connection_get_by_fd_generation(ex.out_fd, ex.out_gen) };
rust/mtproxy-ffi/src/mtproto/core.rs:4722:            let d_conn = unsafe { mtproto_conn_info_ptr(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4723:            if d_conn.is_null() || unsafe { (*d_conn).target.is_null() } {
rust/mtproxy-ffi/src/mtproto/core.rs:4724:                unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4729:            unsafe { mtproto_remove_ext_connection_runtime_ffi(&ex, 1) };
rust/mtproxy-ffi/src/mtproto/core.rs:4735:        d = unsafe { mtproto_forward_pick_connection(target) };
rust/mtproxy-ffi/src/mtproto/core.rs:4737:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4741:                let c_data = unsafe { mtproto_rpc_data_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:4745:                    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4755:            unsafe { fail_connection(c, -35) };
rust/mtproxy-ffi/src/mtproto/core.rs:4759:        let d_conn = unsafe { mtproto_conn_info_ptr(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4761:            unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4762:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4767:        let create_rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4779:            unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4780:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4788:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4791:    if unsafe { proxy_tag_set } != 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:4795:    let payload_len = unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_unread(tlio_in) };
rust/mtproxy-ffi/src/mtproto/core.rs:4797:        unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4803:        let fetched = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4811:            unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4818:        unsafe { mtproto_forward_endpoint(conn, remote_ip_port, false, &mut remote_ipv6) };
rust/mtproxy-ffi/src/mtproto/core.rs:4820:    let our_port = unsafe { mtproto_forward_endpoint(conn, our_ip_port, true, &mut our_ipv6) };
rust/mtproxy-ffi/src/mtproto/core.rs:4823:        unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4826:    let Some(req) = (unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:4837:        unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4841:    if !unsafe { mtproto_forward_send_req(d, &req) } {
rust/mtproxy-ffi/src/mtproto/core.rs:4842:        unsafe { mtproto_job_decref(d) };
rust/mtproxy-ffi/src/mtproto/core.rs:4847:        let conn_after = unsafe { mtproto_conn_info_ptr(c) };
rust/mtproxy-ffi/src/mtproto/core.rs:4848:        if !conn_after.is_null() && unsafe { (*conn_after).pending_queries == 1 } {
rust/mtproxy-ffi/src/mtproto/core.rs:4849:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5326:    unsafe { syntax(msg.as_ptr().cast()) };
rust/mtproxy-ffi/src/mtproto/core.rs:5359:            unsafe { syntax(b"too many targets (%d)\0".as_ptr().cast(), tot_targets) };
rust/mtproxy-ffi/src/mtproto/core.rs:5412:    let Some(mc_ref) = (unsafe { mut_ref_from_ptr(mc) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5421:            if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/mtproto/core.rs:5422:                unsafe { kprintf(b"destroying target %p\n\0".as_ptr().cast(), target) };
rust/mtproxy-ffi/src/mtproto/core.rs:5424:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5450:    let Some(mc_ref) = (unsafe { mut_ref_from_ptr(mc) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5478:    let host = unsafe { cfg_gethost() };
rust/mtproxy-ffi/src/mtproto/core.rs:5482:    let host_ref = unsafe { &*host };
rust/mtproxy-ffi/src/mtproto/core.rs:5486:    let addr = unsafe { *host_ref.h_addr_list };
rust/mtproxy-ffi/src/mtproto/core.rs:5492:        let in_addr = unsafe { *(addr.cast::<MtproxyInAddr>()) };
rust/mtproxy-ffi/src/mtproto/core.rs:5493:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5500:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5521:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5531:    let Some(mc_ref) = (unsafe { mut_ref_from_ptr(mc) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5541:    let target = unsafe { create_target(&raw mut default_cfg_ct, &raw mut was_created) };
rust/mtproxy-ffi/src/mtproto/core.rs:5544:    if unsafe { verbosity } >= 3 {
rust/mtproxy-ffi/src/mtproto/core.rs:5545:        let ipv4 = unsafe { default_cfg_ct.target.s_addr.to_ne_bytes() };
rust/mtproxy-ffi/src/mtproto/core.rs:5546:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5564:    unsafe { time(core::ptr::null_mut()) as c_int }
rust/mtproxy-ffi/src/mtproto/core.rs:5571:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_ip) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5587:    let Some(out_ip_slice) = (unsafe { mut_slice_from_ptr(out_ip, 16) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5590:    let Some(out_consumed_ref) = (unsafe { mut_ref_from_ptr(out_consumed) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5606:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5609:    let Some(bytes) = (unsafe { slice_from_ptr(header, header_len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5641:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5644:    let Some(bytes) = (unsafe { slice_from_ptr(data, len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5662:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5665:    let Some(bytes) = (unsafe { slice_from_ptr(data, len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5682:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5685:    let unread = unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_unread(tlio_in) };
rust/mtproxy-ffi/src/mtproto/core.rs:5687:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5701:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5711:        let got = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5719:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5731:    let rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5744:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5759:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5778:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5793:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:5807:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5810:    let Some(bytes) = (unsafe { slice_from_ptr(data, len) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5823:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5856:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5865:    let Some(cluster_ids_slice) = (unsafe { slice_from_ptr(cluster_ids, clusters_len_usize) })
rust/mtproxy-ffi/src/mtproto/core.rs:5893:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5915:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5948:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:5960:    let Some(cluster_ids_slice) = (unsafe { slice_from_ptr(cluster_ids, clusters_len_usize) })
rust/mtproxy-ffi/src/mtproto/core.rs:6016:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:6037:    let Some(cluster_ids_slice) = (unsafe { slice_from_ptr(cluster_ids, clusters_len_usize) })
rust/mtproxy-ffi/src/mtproto/core.rs:6043:        let Some(state_ref) = (unsafe { ref_from_ptr(last_cluster_state) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:6140:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:6186:                    (unsafe { mut_slice_from_ptr(actions, actions_capacity_usize) })
rust/mtproxy-ffi/src/mtproto/core.rs:6300:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_advance) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:6331:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_cluster_index) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:6348:    let Some(cluster_ids_slice) = (unsafe { slice_from_ptr(cluster_ids, clusters_len_usize) })
rust/mtproxy-ffi/src/mtproto/core.rs:6375:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:6381:    let Some(cluster_ids_slice) = (unsafe { slice_from_ptr(cluster_ids, clusters_len_usize) })
rust/mtproxy-ffi/src/mtproto/core.rs:6418:    let Some(mc_ref) = (unsafe { mut_ref_from_ptr(mc.cast::<MtproxyMfConfig>()) }) else {
rust/mtproxy-ffi/src/mtproto/core.rs:6423:    if (flags & 17) == 0 && unsafe { load_config(config_filename.cast_const(), config_fd) } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:6427:    unsafe { reset_config() };
rust/mtproxy-ffi/src/mtproto/core.rs:6428:    let parse_start = unsafe { cfg_cur };
rust/mtproxy-ffi/src/mtproto/core.rs:6429:    let parse_end = unsafe { cfg_end };
rust/mtproxy-ffi/src/mtproto/core.rs:6434:    let parse_delta = unsafe { parse_end.offset_from(parse_start) };
rust/mtproxy-ffi/src/mtproto/core.rs:6441:    let actions = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6456:        let pass_rc = unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6495:            let action = unsafe { *actions.add(i) };
rust/mtproxy-ffi/src/mtproto/core.rs:6509:            let host_cur = unsafe { parse_start.add(action.host_offset) };
rust/mtproxy-ffi/src/mtproto/core.rs:6510:            unsafe { cfg_cur = host_cur };
rust/mtproxy-ffi/src/mtproto/core.rs:6511:            if unsafe { mtproto_cfg_resolve_default_target_from_cfg_cur_ffi() } < 0 {
rust/mtproxy-ffi/src/mtproto/core.rs:6521:            unsafe { cfg_cur = host_cur.add(action.step.advance) };
rust/mtproxy-ffi/src/mtproto/core.rs:6522:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6532:                unsafe { mtproto_cfg_create_target_ffi(mc_ptr, action.step.target_index) };
rust/mtproxy-ffi/src/mtproto/core.rs:6588:                if unsafe { verbosity } >= 3 {
rust/mtproxy-ffi/src/mtproto/core.rs:6589:                    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6600:                && unsafe { verbosity } >= 3
rust/mtproxy-ffi/src/mtproto/core.rs:6602:                unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6634:    unsafe { free(actions.cast()) };
rust/mtproxy-ffi/src/mtproto/core.rs:6645:        fd = unsafe { open(config_filename.cast_const(), O_RDONLY_FLAG) };
rust/mtproxy-ffi/src/mtproto/core.rs:6647:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6656:        let reload_hosts = unsafe { kdb_load_hosts() };
rust/mtproxy-ffi/src/mtproto/core.rs:6657:        if reload_hosts > 0 && unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/mtproto/core.rs:6658:            unsafe { kprintf(b"/etc/hosts changed, reloaded\n\0".as_ptr().cast()) };
rust/mtproxy-ffi/src/mtproto/core.rs:6662:    let mut res = unsafe { mtproto_cfg_parse_config_ffi(NextConf.cast(), flags & !1, fd) };
rust/mtproxy-ffi/src/mtproto/core.rs:6665:        unsafe { close(fd) };
rust/mtproxy-ffi/src/mtproto/core.rs:6669:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6684:    res = unsafe { mtproto_cfg_parse_config_ffi(NextConf.cast(), flags | 1, -1) };
rust/mtproxy-ffi/src/mtproto/core.rs:6686:        unsafe { clear_config_ffi(NextConf, 0) };
rust/mtproxy-ffi/src/mtproto/core.rs:6687:        unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6695:        unsafe { exit(-res) };
rust/mtproxy-ffi/src/mtproto/core.rs:6698:    let old_cur_conf = unsafe { CurConf };
rust/mtproxy-ffi/src/mtproto/core.rs:6699:    unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6704:    unsafe { clear_config_ffi(NextConf, 1) };
rust/mtproxy-ffi/src/mtproto/core.rs:6706:        unsafe { create_all_outbound_connections() };
rust/mtproxy-ffi/src/mtproto/core.rs:6709:    let cur_conf = unsafe { CurConf };
rust/mtproxy-ffi/src/mtproto/core.rs:6711:        let cur_conf_ref = unsafe { &mut *cur_conf };
rust/mtproxy-ffi/src/mtproto/core.rs:6712:        let cur_now = unsafe { mtproto_cfg_now_or_time_ffi() };
rust/mtproxy-ffi/src/mtproto/core.rs:6714:        cur_conf_ref.config_bytes = unsafe { config_bytes };
rust/mtproxy-ffi/src/mtproto/core.rs:6715:        cur_conf_ref.config_md5_hex = unsafe { malloc(33).cast() };
rust/mtproxy-ffi/src/mtproto/core.rs:6717:            unsafe {
rust/mtproxy-ffi/src/mtproto/core.rs:6724:    unsafe {
rust/mtproxy-ffi/src/engine/ffi.rs:11:    unsafe { engine_init_impl(pwd_filename, do_not_open_port) };
rust/mtproxy-ffi/src/engine/ffi.rs:16:    unsafe { check_server_functions_impl() };
rust/mtproxy-ffi/src/engine/ffi.rs:21:    unsafe { do_precise_cron_impl() };
rust/mtproxy-ffi/src/engine/ffi.rs:26:    unsafe { default_engine_server_start_impl() };
rust/mtproxy-ffi/src/engine/ffi.rs:34:    unsafe { create_main_thread_pipe_impl(pipe_read_end, pipe_write_end) };
rust/mtproxy-ffi/src/engine/ffi.rs:39:    unsafe { wakeup_main_thread_impl(pipe_write_end) };
rust/mtproxy-ffi/src/engine/ffi.rs:44:    unsafe { server_exit_impl() };
rust/mtproxy-ffi/src/engine/ffi.rs:53:    unsafe {
rust/mtproxy-ffi/src/engine/ffi.rs:64:    unsafe { engine_startup_impl(e, f) };
rust/mtproxy-ffi/src/engine/ffi.rs:69:    unsafe { engine_add_engine_parse_options_impl() };
rust/mtproxy-ffi/src/engine/ffi.rs:74:    unsafe { default_parse_option_func_impl(a) }
rust/mtproxy-ffi/src/engine/ffi.rs:79:    unsafe { engine_prepare_stats_impl() }
rust/mtproxy-ffi/src/engine/ffi.rs:84:    unsafe { engine_rpc_stats_impl(tlio_out) };
rust/mtproxy-ffi/src/engine/ffi.rs:92:    unsafe { default_parse_extra_args_impl(argc, argv) };
rust/mtproxy-ffi/src/engine/ffi.rs:97:    unsafe { default_cron_impl() };
rust/mtproxy-ffi/src/engine/ffi.rs:102:    unsafe { set_signals_handlers_impl() };
rust/mtproxy-ffi/src/engine/ffi.rs:107:    unsafe { engine_set_epoll_wait_timeout_impl(epoll_wait_timeout) };
rust/mtproxy-ffi/src/engine/ffi.rs:114:    unsafe { precise_cron_function_insert_impl(ev) };
rust/mtproxy-ffi/src/engine/ffi.rs:121:    unsafe { precise_cron_function_remove_impl(ev) };
rust/mtproxy-ffi/src/engine/ffi.rs:126:    unsafe { update_job_stats_gw_impl(ex) }
rust/mtproxy-ffi/src/engine/ffi.rs:135:    unsafe { precise_cron_job_run_impl(job, op, jt) }
rust/mtproxy-ffi/src/engine/ffi.rs:144:    unsafe { terminate_job_run_impl(job, op, jt) }
rust/mtproxy-ffi/src/engine/ffi.rs:149:    unsafe { default_get_op_impl(tlio_in) }
rust/mtproxy-ffi/src/engine/ffi.rs:158:    unsafe { default_main_impl(f, argc, argv) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:15:    unsafe { rpc_target_insert_conn_impl(c, tree_slot, module_stat_tls, default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:25:    unsafe { rpc_target_delete_conn_impl(c, tree_slot, module_stat_tls, default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:34:    unsafe { rpc_target_lookup_runtime_impl(tree, pid, default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:42:    unsafe { rpc_target_choose_connection_runtime_impl(target, pid) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:52:    unsafe { rpc_target_choose_random_connections_runtime_impl(target, pid, limit, buf) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:61:    unsafe { rpc_targets_prepare_stat_runtime_impl(sb, module_stat_array, module_stat_len) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:70:    unsafe { rpc_target_lookup_impl(tree, pid, default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:80:    unsafe { rpc_target_lookup_hp_impl(tree, ip, port, default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:89:    unsafe { rpc_target_lookup_target_runtime_impl(target, tree, default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/ffi.rs:97:    unsafe { rpc_target_get_state_runtime_impl(target, pid) }
rust/mtproxy-ffi/src/net_events/ffi.rs:8:    unsafe { init_epoll_ffi() }
rust/mtproxy-ffi/src/net_events/ffi.rs:16:    unsafe { remove_event_from_heap_ffi(ev, allow_hole) }
rust/mtproxy-ffi/src/net_events/ffi.rs:21:    unsafe { put_event_into_heap_ffi(ev) }
rust/mtproxy-ffi/src/net_events/ffi.rs:29:    unsafe { put_event_into_heap_tail_ffi(ev, ts_delta) }
rust/mtproxy-ffi/src/net_events/ffi.rs:39:    unsafe { epoll_sethandler_ffi(fd, prio, handler, data) }
rust/mtproxy-ffi/src/net_events/ffi.rs:44:    unsafe { epoll_insert_ffi(fd, flags) }
rust/mtproxy-ffi/src/net_events/ffi.rs:49:    unsafe { epoll_remove_ffi(fd) }
rust/mtproxy-ffi/src/net_events/ffi.rs:54:    unsafe { epoll_close_ffi(fd) }
rust/mtproxy-ffi/src/net_events/ffi.rs:59:    unsafe { epoll_fetch_events_ffi(timeout) }
rust/mtproxy-ffi/src/net_events/ffi.rs:64:    unsafe { epoll_work_ffi(timeout) }
rust/mtproxy-ffi/src/net_events/ffi.rs:69:    unsafe { maximize_sndbuf_ffi(socket_fd, max) }
rust/mtproxy-ffi/src/net_events/ffi.rs:74:    unsafe { maximize_rcvbuf_ffi(socket_fd, max) }
rust/mtproxy-ffi/src/net_events/ffi.rs:84:    unsafe { server_socket_ffi(port, in_addr, backlog, mode) }
rust/mtproxy-ffi/src/net_events/ffi.rs:93:    unsafe { client_socket_ffi(in_addr, port, mode) }
rust/mtproxy-ffi/src/net_events/ffi.rs:102:    unsafe { client_socket_ipv6_ffi(in6_addr_ptr, port, mode) }
rust/mtproxy-ffi/src/net_events/ffi.rs:107:    unsafe { get_my_ipv4_ffi() }
rust/mtproxy-ffi/src/net_events/ffi.rs:112:    unsafe { get_my_ipv6_ffi(ipv6) }
rust/mtproxy-ffi/src/net_events/ffi.rs:120:    unsafe { conv_addr_ffi(a, buf) }
rust/mtproxy-ffi/src/net_events/ffi.rs:128:    unsafe { conv_addr6_ffi(a, buf) }
rust/mtproxy-ffi/src/net_events/ffi.rs:133:    unsafe { show_ip_ffi(ip) }
rust/mtproxy-ffi/src/net_events/ffi.rs:138:    unsafe { show_ipv6_ffi(ipv6) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:354:    let conn = unsafe { mtproxy_ffi_net_tcp_rpc_server_conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:361:    let data = unsafe { mtproxy_ffi_net_tcp_rpc_server_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:368:    let funcs = unsafe { mtproxy_ffi_net_tcp_rpc_server_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:376:    unsafe { ptr::read_unaligned((*secret).secret.as_ptr().cast::<c_int>()) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:381:    unsafe { mtproxy_ffi_net_tcp_rpc_server_precise_now() }
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:386:    let now = unsafe { libc::time(ptr::null_mut()) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:392:    let now = unsafe { mtproxy_ffi_net_tcp_rpc_server_now() };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:403:    unsafe { mtproxy_ffi_net_tcp_rpc_server_send_data(c, len_i32, data.cast()) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:409:    unsafe { mtproxy_ffi_net_tcp_rpc_server_send_data_im(c, len_i32, data.cast()) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:415:    unsafe { mtproxy_ffi_net_tcp_rpc_server_send_data_init(c, len_i32, data.cast()) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:456:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:458:    if core_default_execute_should_pong(op, unsafe { (*raw).total_bytes }) {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:459:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:464:            unsafe { rwm_fetch_data(raw, words.as_mut_ptr().cast(), 12) },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:468:        unsafe { send_data(c, words.as_ptr().cast(), 12) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:475:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:476:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:478:    let packet_num = unsafe { (*data).in_packet_num };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:481:        unsafe { rwm_fetch_lookup(msg, ptr::addr_of_mut!(packet_type).cast(), 4) },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:484:    let packet_len = unsafe { (*msg).total_bytes };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:499:        unsafe { rwm_fetch_data(msg, packet.as_mut_ptr().cast(), packet_len) },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:518:        (unsafe { (*data).crypto_flags } & RPCF_ALLOW_UNENC) != 0,
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:519:        (unsafe { (*data).crypto_flags } & RPCF_ALLOW_ENC) != 0,
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:541:            if unsafe { ((*data).crypto_flags & RPCF_ALLOW_UNENC) == 0 } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:544:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:549:            if processed_has_dh_params == 0 || unsafe { dh_params_select } == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:550:                let _ = unsafe { init_dh_params() };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:554:                && parsed.dh_params_select == unsafe { dh_params_select }
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:558:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:562:        RPC_CRYPTO_AES_EXT | RPC_CRYPTO_AES => unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:566:            if unsafe { ((*data).crypto_flags & RPCF_ALLOW_UNENC) != 0 } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:567:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:577:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:582:    if unsafe { (*data).crypto_flags & (RPCF_REQ_DH | RPCF_ALLOW_ENC) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:586:        if unsafe { ((*data).crypto_flags & RPCF_ALLOW_SKIP_DH) != 0 } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:587:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:595:    let Some(rpc_init_crypto) = (unsafe { (*funcs).rpc_init_crypto }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:599:    let res = unsafe { rpc_init_crypto(c, packet.as_mut_ptr().cast::<TcpRpcNoncePacket>()) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:608:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:610:        unsafe { (*data).crypto_flags } & RPCF_USE_CRC32C,
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:611:        ffi_pid_to_core(unsafe { PID }),
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:612:        ffi_pid_to_core(unsafe { (*data).remote_pid }),
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:616:    unsafe { send_data_im(c, bytes.as_ptr(), bytes.len()) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:621:    let packet = HandshakeErrorPacket::new(error_code, ffi_pid_to_core(unsafe { PID }));
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:624:    unsafe { send_data(c, bytes.as_ptr(), bytes.len()) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:629:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:630:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:631:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:633:    if unsafe { PID.ip } == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:634:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:642:    let packet_num = unsafe { (*data).in_packet_num };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:645:        unsafe { rwm_fetch_lookup(msg, ptr::addr_of_mut!(packet_type).cast(), 4) },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:648:    let packet_len = unsafe { (*msg).total_bytes };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:660:        let _ = unsafe { tcp_rpcs_send_handshake_error_packet_impl(c, -3) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:666:        unsafe { rwm_fetch_data(msg, packet.as_mut_ptr().cast(), packet_len) },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:673:            let _ = unsafe { tcp_rpcs_send_handshake_error_packet_impl(c, -3) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:678:        let _ = unsafe { tcp_rpcs_send_handshake_error_packet_impl(c, -3) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:682:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:687:    let mut local_pid = unsafe { PID };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:689:    let peer_pid_matches = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:700:        (unsafe { (*funcs).mode_flags } & TCP_RPC_IGNORE_PID) != 0,
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:701:        unsafe { tcp_get_default_rpc_flags() as c_int },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:707:            let _ = unsafe { tcp_rpcs_send_handshake_error_packet_impl(c, code) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:713:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:722:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:723:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:724:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:727:        if (unsafe { (*conn).flags } & C_ERROR) != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:730:        if (unsafe { (*conn).flags } & C_STOPPARSE) != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:734:        let len = unsafe { (*conn).in_data.total_bytes };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:744:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:754:        if (unsafe { (*data).crypto_flags } & RPCF_QUICKACK) != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:755:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:762:            if unsafe { (*data).in_packet_num } <= -2
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:764:                && !unsafe { (*funcs).http_fallback_type.is_null() }
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:766:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:776:                let ctype = unsafe { (*conn).type_.cast::<ConnFunctions>() };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:777:                let Some(init_accepted) = (unsafe { (*ctype).init_accepted }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:778:                    unsafe { fail_connection(c, -33) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:782:                if unsafe { init_accepted(c) } < 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:783:                    unsafe { fail_connection(c, -33) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:787:                let Some(parse_execute) = (unsafe { (*ctype).parse_execute }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:788:                    unsafe { fail_connection(c, -33) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:792:                return unsafe { parse_execute(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:795:            unsafe { fail_connection(c, -1) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:800:            core_packet_len_state(packet_len, unsafe { (*funcs).max_packet_len });
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:803:            unsafe { fail_connection(c, -1) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:809:                unsafe { rwm_skip_data(ptr::addr_of_mut!((*conn).in_data), 4) },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:820:        let _ = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:830:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:836:        let packet_crc32 = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:845:            let _ = unsafe { rwm_dump(ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:846:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:855:        assert_eq!(unsafe { rwm_skip_data(ptr::addr_of_mut!(msg), 4) }, 4);
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:857:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:867:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:877:        if unsafe { verbosity > 2 } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:878:            let _ = unsafe { rwm_dump(ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:883:        if unsafe { (*data).in_packet_num } == -3 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:884:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:889:        if (unsafe { (*data).crypto_flags } & RPCF_SEQNO_HOLES) == 0
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:890:            && packet_num != unsafe { (*data).in_packet_num }
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:892:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:899:                res = unsafe { tcp_rpcs_process_nonce_packet_impl(c, ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:901:                res = unsafe { tcp_rpcs_process_handshake_packet_impl(c, ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:903:                    res = unsafe { tcp_rpcs_send_handshake_packet_impl(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:904:                    if (unsafe { (*data).crypto_flags } & RPCF_USE_CRC32C) != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:905:                        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:909:                    unsafe { notification_event_insert_tcp_conn_ready(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:913:            let _ = unsafe { rwm_free(ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:915:                unsafe { fail_connection(c, res) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:919:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:924:                res = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:927:            } else if let Some(execute) = unsafe { (*funcs).execute } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:928:                res = unsafe { execute(c, packet_type, ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:932:                let _ = unsafe { rwm_free(ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:936:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:943:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:945:    unsafe { notification_event_insert_tcp_conn_wakeup(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:947:    if core_should_set_wantwr(unsafe { (*conn).out_p.total_bytes }) {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:948:        unsafe { mtproxy_ffi_net_tcp_rpc_server_flags_or(c, C_WANTWR) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:951:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:959:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:961:    unsafe { notification_event_insert_tcp_conn_alarm(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:963:    if core_should_set_wantwr(unsafe { (*conn).out_p.total_bytes }) {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:964:        unsafe { mtproxy_ffi_net_tcp_rpc_server_flags_or(c, C_WANTWR) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:967:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:975:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:977:    if core_should_notify_close(unsafe { (*funcs).rpc_close.is_some() }) {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:978:        unsafe { notification_event_insert_tcp_conn_close(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:981:    unsafe { cpu_server_close_connection(c, who) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:989:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:990:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:991:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:993:    let has_perm_callback = i32::from(unsafe { (*funcs).rpc_check_perm.is_some() });
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:996:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1001:    if let Some(rpc_check_perm) = unsafe { (*funcs).rpc_check_perm } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1002:        perm_flags = unsafe { rpc_check_perm(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1009:        Ok((crypto_flags, in_packet_num, out_packet_num)) => unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1021:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1022:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1025:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1030:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1034:    if unsafe { (*funcs).rpc_ready.is_some() } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1035:        unsafe { notification_event_insert_tcp_conn_ready(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1042:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1044:    let current_flags = unsafe { (*data).crypto_flags };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1058:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1062:    unsafe { send_data_init(c, ptr::addr_of!(packet).cast::<u8>(), NONCE_PACKET_LEN) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1068:    core_default_check_perm(unsafe { tcp_get_default_rpc_flags() as c_int })
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1075:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1076:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1082:    if unsafe { !(*conn).crypto.is_null() } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1086:    if unsafe { (*data).crypto_flags & (RPCF_ALLOW_ENC | RPCF_ALLOW_UNENC) } == RPCF_ALLOW_UNENC {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1087:        return unsafe { tcp_rpcs_init_fake_crypto_impl(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1090:    if unsafe { (*data).crypto_flags & (RPCF_ALLOW_ENC | RPCF_ALLOW_UNENC) } != RPCF_ALLOW_ENC {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1094:    if unsafe { main_secret_key_signature() } != unsafe { (*packet).key_select } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1103:    if (unsafe { (*data).crypto_flags } & RPCF_REQ_DH) != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1104:        if unsafe { (*packet).crypto_schema } != RPC_CRYPTO_AES_DH {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1109:        let extra_keys_count = unsafe { (*packet_dh).extra_keys_count };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1112:        let old_dh = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1119:        if unsafe { (*old_dh).dh_params_select != dh_params_select || dh_params_select == 0 } {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1123:        if unsafe { tcp_add_dh_accept() } < 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1127:        temp_dh_len = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1136:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1144:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1150:    if unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1176:    let mut aes_keys = unsafe { aes_keys.assume_init() };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1177:    if unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1189:        unsafe { (*data).crypto_flags & (RPCF_ALLOW_ENC | RPCF_ENC_SENT) },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1192:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1199:            key_select: unsafe { main_secret_key_signature() },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1201:            crypto_ts: unsafe { (*data).nonce_time },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1202:            crypto_nonce: unsafe { (*data).nonce },
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1205:        unsafe { send_data_init(c, ptr::addr_of!(out_packet).cast::<u8>(), NONCE_PACKET_LEN) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1211:    write_i32_ne(&mut out_packet, 4, unsafe { main_secret_key_signature() });
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1213:    write_i32_ne(&mut out_packet, 12, unsafe { (*data).nonce_time });
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1214:    out_packet[16..32].copy_from_slice(unsafe { &(*data).nonce });
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1216:    write_i32_ne(&mut out_packet, 36, unsafe { dh_params_select });
rust/mtproxy-ffi/src/net_tcp_rpc_server/core.rs:1219:    unsafe { send_data_init(c, out_packet.as_ptr(), out_packet.len()) };
rust/mtproxy-ffi/src/engine/core.rs:426:    !e.is_null() && (unsafe { (*e).modules & ENGINE_ENABLE_MULTITHREAD }) != 0
rust/mtproxy-ffi/src/engine/core.rs:431:    !e.is_null() && (unsafe { (*e).modules & ENGINE_ENABLE_TCP }) != 0
rust/mtproxy-ffi/src/engine/core.rs:436:    !e.is_null() && (unsafe { (*e).modules & ENGINE_ENABLE_IPV6 }) != 0
rust/mtproxy-ffi/src/engine/core.rs:441:    !unsafe { engine_state }.is_null()
rust/mtproxy-ffi/src/engine/core.rs:442:        && (unsafe { (*engine_state).modules & ENGINE_ENABLE_SLAVE_MODE }) != 0
rust/mtproxy-ffi/src/engine/core.rs:454:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:470:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:475:    let optarg_value = if unsafe { optarg }.is_null() {
rust/mtproxy-ffi/src/engine/core.rs:478:        Some(unsafe { libc::atoi(optarg) })
rust/mtproxy-ffi/src/engine/core.rs:485:            unsafe {
rust/mtproxy-ffi/src/engine/core.rs:491:            unsafe {
rust/mtproxy-ffi/src/engine/core.rs:497:            unsafe {
rust/mtproxy-ffi/src/engine/core.rs:503:            unsafe {
rust/mtproxy-ffi/src/engine/core.rs:512:            unsafe {
rust/mtproxy-ffi/src/engine/core.rs:530:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:539:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:556:    if unsafe {
rust/mtproxy-ffi/src/engine/core.rs:559:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:566:    let new_precise_now_diff = unsafe { get_utime_monotonic() - get_double_time() };
rust/mtproxy-ffi/src/engine/core.rs:567:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:573:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:582:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:584:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:592:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:602:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:611:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:625:    if op == JS_ALARM && unsafe { job_timer_check(job) } == 0 {
rust/mtproxy-ffi/src/engine/core.rs:629:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:648:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:650:    let f = unsafe { (*e).f };
rust/mtproxy-ffi/src/engine/core.rs:653:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:663:    unsafe { crate::tl_parse::abi::mtproxy_ffi_tl_fetch_lookup_int(tlio_in.cast()) }
rust/mtproxy-ffi/src/engine/core.rs:668:    if unsafe { libc::getuid() } != 0 {
rust/mtproxy-ffi/src/engine/core.rs:669:        let mut rlim: libc::rlimit = unsafe { zeroed() };
rust/mtproxy-ffi/src/engine/core.rs:670:        if unsafe { libc::getrlimit(libc::RLIMIT_NOFILE, &mut rlim) } < 0 {
rust/mtproxy-ffi/src/engine/core.rs:671:            unsafe {
rust/mtproxy-ffi/src/engine/core.rs:686:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:689:    } else if unsafe { raise_file_rlimit(maxconn_local + RAISE_FILE_GAP) } < 0 {
rust/mtproxy-ffi/src/engine/core.rs:690:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:707:    if unsafe { *pipe_read_end > 0 } {
rust/mtproxy-ffi/src/engine/core.rs:708:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:717:    if unsafe { *pipe_write_end > 0 } {
rust/mtproxy-ffi/src/engine/core.rs:718:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:729:    let rc = unsafe { libc::pipe2(pipefd.as_mut_ptr(), libc::O_NONBLOCK) };
rust/mtproxy-ffi/src/engine/core.rs:731:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:742:    let r = unsafe {
rust/mtproxy-ffi/src/engine/core.rs:758:        let r = unsafe {
rust/mtproxy-ffi/src/engine/core.rs:777:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:779:    let f = unsafe { (*e).f };
rust/mtproxy-ffi/src/engine/core.rs:782:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:788:    if unsafe { daemonize } != 0 {
rust/mtproxy-ffi/src/engine/core.rs:789:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:796:        unsafe { (*e).do_not_open_port != 0 },
rust/mtproxy-ffi/src/engine/core.rs:797:        unsafe { (*e).port },
rust/mtproxy-ffi/src/engine/core.rs:798:        unsafe { (*e).sfd },
rust/mtproxy-ffi/src/engine/core.rs:799:        unsafe { engine_tcp_enabled(e) },
rust/mtproxy-ffi/src/engine/core.rs:800:        unsafe { engine_ipv6_enabled(e) },
rust/mtproxy-ffi/src/engine/core.rs:805:        mtproxy_core::runtime::engine::EngineServerListenPlan::FatalPortUndefined => unsafe {
rust/mtproxy-ffi/src/engine/core.rs:815:                assert!(unsafe { try_open_port((*e).port, 1) } >= 0);
rust/mtproxy-ffi/src/engine/core.rs:820:                        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:831:                        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:844:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:851:    if unsafe { daemonize } != 0 {
rust/mtproxy-ffi/src/engine/core.rs:852:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:859:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:861:    let f = unsafe { (*e).f };
rust/mtproxy-ffi/src/engine/core.rs:864:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:878:    if unsafe { engine_state }.is_null() {
rust/mtproxy-ffi/src/engine/core.rs:882:    let mut sb: StatsBuffer = unsafe { zeroed() };
rust/mtproxy-ffi/src/engine/core.rs:883:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:891:    let f = unsafe { (*engine_state).f };
rust/mtproxy-ffi/src/engine/core.rs:893:        if let Some(prepare_stats) = unsafe { (*f).prepare_stats } {
rust/mtproxy-ffi/src/engine/core.rs:894:            unsafe {
rust/mtproxy-ffi/src/engine/core.rs:904:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:918:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:936:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:948:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:963:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:998:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:1002:    let f = unsafe { (*e).f };
rust/mtproxy-ffi/src/engine/core.rs:1006:    match unsafe { (*f).parse_option } {
rust/mtproxy-ffi/src/engine/core.rs:1007:        Some(parse_option) => unsafe { parse_option(a) },
rust/mtproxy-ffi/src/engine/core.rs:1014:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1022:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:1028:        unsafe { engine_do_open_port() };
rust/mtproxy-ffi/src/engine/core.rs:1031:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1035:    let aes_load_res = unsafe { aes_load_pwd_file(pwd_filename) };
rust/mtproxy-ffi/src/engine/core.rs:1039:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1045:    if unsafe { change_user_group(username, groupname) } < 0 {
rust/mtproxy-ffi/src/engine/core.rs:1046:        let username_str = if unsafe { username }.is_null() {
rust/mtproxy-ffi/src/engine/core.rs:1049:            unsafe { username }
rust/mtproxy-ffi/src/engine/core.rs:1051:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1059:        unsafe { (*e).port },
rust/mtproxy-ffi/src/engine/core.rs:1060:        unsafe { (*e).start_port },
rust/mtproxy-ffi/src/engine/core.rs:1061:        unsafe { (*e).end_port },
rust/mtproxy-ffi/src/engine/core.rs:1064:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1077:    let bind_plan = mtproxy_core::runtime::engine::engine_bind_ipv4_plan(c_uint::from_be(unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1085:        mtproxy_core::runtime::engine::EngineBindIpv4Plan::RejectProvided(addr) => unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1096:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1135:    let pid = unsafe { PID };
rust/mtproxy-ffi/src/engine/core.rs:1136:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1151:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:1153:    let f = unsafe { (*e).f };
rust/mtproxy-ffi/src/engine/core.rs:1156:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1217:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:1219:    let f = unsafe { (*e).f };
rust/mtproxy-ffi/src/engine/core.rs:1222:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1265:    let mut current = unsafe { (*f).custom_ops };
rust/mtproxy-ffi/src/engine/core.rs:1267:        let op = unsafe { ptr::read_unaligned(current) };
rust/mtproxy-ffi/src/engine/core.rs:1271:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1279:    let e = unsafe { engine_state };
rust/mtproxy-ffi/src/engine/core.rs:1281:    let f = unsafe { (*e).f };
rust/mtproxy-ffi/src/engine/core.rs:1284:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1371:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1375:    let e = unsafe { libc::calloc(1, size_of::<EngineState>()) }.cast::<EngineState>();
rust/mtproxy-ffi/src/engine/core.rs:1377:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1381:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1386:    if unsafe { !(*f).tcp_methods.is_null() } {
rust/mtproxy-ffi/src/engine/core.rs:1387:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1392:    if unsafe { !(*f).http_functions.is_null() } {
rust/mtproxy-ffi/src/engine/core.rs:1393:        let mut http_type = unsafe { (*f).http_type };
rust/mtproxy-ffi/src/engine/core.rs:1397:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1403:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1410:        unsafe { *argv }
rust/mtproxy-ffi/src/engine/core.rs:1412:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1417:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1421:    if let Some(prepare_parse_options) = unsafe { (*f).prepare_parse_options } {
rust/mtproxy-ffi/src/engine/core.rs:1422:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1427:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1431:    let optind_val = unsafe { optind };
rust/mtproxy-ffi/src/engine/core.rs:1435:        unsafe { argv.add(optind_val as usize) }
rust/mtproxy-ffi/src/engine/core.rs:1437:    if let Some(parse_extra_args) = unsafe { (*f).parse_extra_args } {
rust/mtproxy-ffi/src/engine/core.rs:1438:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1443:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1447:    if let Some(pre_init) = unsafe { (*f).pre_init } {
rust/mtproxy-ffi/src/engine/core.rs:1448:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1453:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1457:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1461:    if let Some(pre_start) = unsafe { (*f).pre_start } {
rust/mtproxy-ffi/src/engine/core.rs:1462:        unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1467:    unsafe {
rust/mtproxy-ffi/src/engine/core.rs:1471:    if let Some(run_script) = unsafe { (*f).run_script } {
rust/mtproxy-ffi/src/engine/core.rs:1472:        let rc = unsafe { run_script() };
rust/mtproxy-ffi/src/engine/core.rs:1479:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:263:    unsafe { libc::abort() }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:282:    unsafe { ptr::addr_of_mut!((*job.cast::<AsyncJob>()).j_custom).cast::<T>() }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:287:    unsafe { job_custom_ptr(c) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:292:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:301:    unsafe { job_custom_ptr(target) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:306:    unsafe { job_custom_ptr(target) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:311:    unsafe { mtproxy_ffi_rpc_target_is_fast_thread() != 0 }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:319:    pid.is_null() || unsafe { matches_pid(remote_pid, pid as *mut MtproxyProcessId) } >= 1
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:324:    if unsafe { verbosity } < 2 {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:328:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:347:    unsafe { assert_engine_thread() };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:351:    let target = unsafe { libc::calloc(total_bytes, 1) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:354:    let info = unsafe { rpc_target_info(target) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:355:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:359:    let old = unsafe { mtproxy_ffi_rpc_target_tree_acquire(*tree_slot) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:360:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:364:    unsafe { mtproxy_ffi_rpc_target_tree_release(old) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:380:    if unsafe { *best_unr } < 0 {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:385:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:386:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:388:    let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:390:    let Some(check_ready) = (unsafe { (*type_).check_ready }) else {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:393:    let ready = unsafe { check_ready(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:395:    if (unsafe { (*conn).flags } & (C_ERROR | C_FAILED | C_NET_FAILED)) != 0
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:396:        || unsafe { (*conn).error } != 0
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:402:        if unsafe { pid_matches_filter(ptr::addr_of_mut!((*data).remote_pid), pid) } {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:403:            unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:408:    } else if ready == CR_STOPPED && unsafe { (*conn).unreliability } < unsafe { *best_unr } {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:409:        if unsafe { pid_matches_filter(ptr::addr_of_mut!((*data).remote_pid), pid) } {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:410:            unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:423:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:424:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:426:    let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:428:    let Some(check_ready) = (unsafe { (*type_).check_ready }) else {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:431:    let ready = unsafe { check_ready(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:433:    if (unsafe { (*conn).flags } & (C_ERROR | C_FAILED | C_NET_FAILED)) != 0
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:434:        || unsafe { (*conn).error } != 0
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:439:    if !pid.is_null() && unsafe { matches_pid(ptr::addr_of_mut!((*data).remote_pid), pid) } < 1 {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:443:    if unsafe { (*extra).pos } < unsafe { (*extra).limit } {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:444:        unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:449:        let t = unsafe { lrand48_j() } % (unsafe { (*extra).count + 1 }) as c_long;
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:450:        if (t as c_int) < unsafe { (*extra).limit } {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:451:            unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:456:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:471:    unsafe { assert_engine_thread() };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:472:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:473:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:475:    if (unsafe { (*conn).flags } & (C_ERROR | C_NET_FAILED | C_FAILED)) != 0 {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:478:    if unsafe { (*data).in_rpc_target } != 0 {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:482:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:484:    let mut pid = unsafe { (*data).remote_pid };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:486:    unsafe { rpc_target_log(&pid, (*conn).fd) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:488:    let mut target = unsafe { mtproxy_ffi_rpc_target_tree_lookup(*tree_slot, &pid) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:490:        target = unsafe { rpc_target_alloc(tree_slot, module_stat_tls, pid, default_ip) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:493:    let info = unsafe { rpc_target_info(target) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:494:    let existing_conn = unsafe { tree_lookup_ptr_connection((*info).conn_tree, c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:497:    let old = unsafe { get_tree_ptr_connection(ptr::addr_of_mut!((*info).conn_tree)) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:498:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:505:    unsafe { free_tree_ptr_connection(old) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:507:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:524:    unsafe { assert_engine_thread() };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:525:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:526:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:528:    if unsafe { (*data).in_rpc_target } == 0 {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:532:    unsafe { assert_net_cpu_thread() };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:534:    let mut pid = unsafe { (*data).remote_pid };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:536:    unsafe { rpc_target_log(&pid, (*conn).fd) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:538:    let mut target = unsafe { mtproxy_ffi_rpc_target_tree_lookup(*tree_slot, &pid) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:540:        target = unsafe { rpc_target_alloc(tree_slot, module_stat_tls, pid, default_ip) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:543:    let info = unsafe { rpc_target_info(target) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:544:    let existing_conn = unsafe { tree_lookup_ptr_connection((*info).conn_tree, c) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:547:    let old = unsafe { get_tree_ptr_connection(ptr::addr_of_mut!((*info).conn_tree)) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:548:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:554:    unsafe { free_tree_ptr_connection(old) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:556:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:570:    let mut normalized = unsafe { *pid };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:577:        unsafe { mtproxy_ffi_rpc_target_tree_acquire(tree) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:580:    let target = unsafe { mtproxy_ffi_rpc_target_tree_lookup(active_tree, &normalized) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:582:        unsafe { mtproxy_ffi_rpc_target_tree_release(active_tree) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:596:    let info = unsafe { rpc_target_info(target) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:598:        unsafe { (*info).conn_tree }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:600:        unsafe { get_tree_ptr_connection(ptr::addr_of_mut!((*info).conn_tree)) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:604:            unsafe { tree_free_connection(tree) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:611:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:622:        unsafe { job_incref(result) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:625:        unsafe { tree_free_connection(tree) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:649:    let info = unsafe { rpc_target_info(target) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:651:        unsafe { (*info).conn_tree }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:653:        unsafe { get_tree_ptr_connection(ptr::addr_of_mut!((*info).conn_tree)) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:657:            unsafe { tree_free_connection(tree) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:662:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:673:        unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:680:        unsafe { tree_free_connection(tree) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:698:        let stat_ptr = unsafe { *module_stat_array.add(i as usize) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:701:            total_rpc_targets += unsafe { (*stat).total_rpc_targets };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:702:            total_connections += unsafe { (*stat).total_connections_in_rpc_targets };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:721:        unsafe { rpc_targets_stats_totals(module_stat_array, module_stat_len) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:722:    unsafe {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:730:    unsafe { (*sb).pos }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:738:    unsafe { rpc_target_lookup_runtime_impl(tree, pid, default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:753:    unsafe { rpc_target_lookup_runtime_impl(tree, ptr::addr_of!(pid), default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:765:    let info = unsafe { conn_target_info(target) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:766:    let ip = unsafe { (*info).custom_field };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:771:    unsafe { rpc_target_lookup_hp_impl(tree, ip as u32, (*info).port, default_ip) }
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:778:    let connection = unsafe { rpc_target_choose_connection_runtime_impl(target, pid) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:783:    let conn = unsafe { conn_info(connection) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:784:    let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:787:    let Some(check_ready) = (unsafe { (*type_).check_ready }) else {
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:790:    let ready = unsafe { check_ready(connection) };
rust/mtproxy-ffi/src/net_rpc_targets/core.rs:791:    unsafe { job_decref(1, connection) };
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:12:    unsafe { tcp_rpcs_default_execute_impl(c, op, raw) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:17:    unsafe { tcp_rpcs_parse_execute_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:22:    unsafe { tcp_rpcs_wakeup_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:27:    unsafe { tcp_rpcs_alarm_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:32:    unsafe { tcp_rpcs_do_wakeup_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:37:    unsafe { tcp_rpcs_init_accepted_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:45:    unsafe { tcp_rpcs_close_connection_impl(c, who) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:52:    unsafe { tcp_rpcs_init_accepted_nohs_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:59:    unsafe { tcp_rpcs_default_check_perm_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_server/ffi.rs:67:    unsafe { tcp_rpcs_init_crypto_impl(c, packet) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:12:    unsafe { mtproto_proxy_usage_ffi(program_name) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:24:    unsafe { mtproto_proxy_main_ffi(argc, argv) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:34:    unsafe { clear_config_ffi(mc, do_destroy_targets) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:48:    unsafe { mf_cluster_lookup_ffi(mc, cluster_id, force) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:57:    unsafe { mtproto_cfg_resolve_default_target_from_cfg_cur_ffi() }
rust/mtproxy-ffi/src/mtproto/ffi.rs:67:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:87:    unsafe { mtproto_cfg_create_target_ffi(mc, target_index) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:92:    unsafe { mtproto_cfg_now_or_time_ffi() }
rust/mtproxy-ffi/src/mtproto/ffi.rs:104:    unsafe { mtproto_parse_text_ipv4_ffi(str, out_ip) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:118:    unsafe { mtproto_parse_text_ipv6_ffi(str, out_ip, out_consumed) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:133:    unsafe { mtproto_inspect_packet_header_ffi(header, header_len, packet_len, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:146:    unsafe { mtproto_parse_client_packet_ffi(data, len, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:157:    unsafe { mtproto_process_client_packet_ffi(data, len, conn_fd, conn_gen, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:165:    unsafe { mtproto_process_client_packet_runtime_ffi(tlio_in, c) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:174:    unsafe { mtproto_push_rpc_confirmation_runtime_ffi(c_tag_int, c, confirm) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:182:    unsafe { mtproto_mtfront_parse_function_runtime_ffi(tlio_in, actor_id) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:190:    unsafe { mtproto_process_http_query_ffi(tlio_in, hqj) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:199:    unsafe { mtproto_http_query_job_run_ffi(job, op, jt) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:208:    unsafe { mtproto_callback_job_run_ffi(job, op, jt) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:217:    unsafe { mtproto_client_packet_job_run_ffi(job, op, jt) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:228:    unsafe { mtproto_client_send_message_runtime_ffi(c_tag_int, c, in_conn_id, tlio_in, flags) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:233:    unsafe { mtproto_add_stats_ffi(w) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:238:    unsafe { mtproto_compute_stats_sum_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:243:    unsafe { mtproto_check_all_conn_buffers_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:248:    unsafe { mtproto_check_conn_buffers_runtime_ffi(c) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:253:    unsafe { mtproto_update_local_stats_copy_ffi(s) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:258:    unsafe { mtproto_mtfront_prepare_stats_ffi(sb) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:267:    unsafe { mtproto_hts_stats_execute_ffi(c, msg, op) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:276:    unsafe { mtproto_hts_execute_ffi(c, msg, op) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:285:    unsafe { mtproto_rpcc_execute_ffi(c, op, msg) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:290:    unsafe { mtproto_mtfront_client_ready_ffi(c) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:299:    unsafe { mtproto_ext_rpcs_execute_ffi(c, op, msg) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:307:    unsafe { mtproto_mtfront_client_close_ffi(c, who) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:315:    unsafe { mtproto_do_close_in_ext_conn_ffi(data, s_len) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:320:    unsafe { mtproto_ext_rpc_ready_ffi(c) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:325:    unsafe { mtproto_ext_rpc_close_ffi(c, who) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:330:    unsafe { mtproto_proxy_rpc_ready_ffi(c) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:335:    unsafe { mtproto_proxy_rpc_close_ffi(c, who) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:343:    unsafe { mtproto_do_rpcs_execute_ffi(data, s_len) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:351:    unsafe { mtproto_finish_postponed_http_response_ffi(data, len) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:356:    unsafe { mtproto_http_alarm_ffi(c) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:361:    unsafe { mtproto_http_close_ffi(c, who) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:366:    unsafe { mtproto_f_parse_option_ffi(val) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:371:    unsafe { mtproto_mtfront_prepare_parse_options_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:376:    unsafe { mtproto_check_children_dead_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:381:    unsafe { mtproto_check_children_status_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:386:    unsafe { mtproto_check_special_connections_overflow_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:391:    unsafe { mtproto_kill_children_ffi(signal) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:396:    unsafe { mtproto_cron_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:401:    unsafe { mtproto_usage_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:409:    unsafe { mtproto_mtfront_parse_extra_args_ffi(argc, argv) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:414:    unsafe { mtproto_mtfront_sigusr1_handler_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:419:    unsafe { mtproto_mtfront_on_exit_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:424:    unsafe { mtproto_mtfront_pre_init_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:429:    unsafe { mtproto_mtfront_pre_start_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:434:    unsafe { mtproto_mtfront_pre_loop_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:439:    unsafe { mtproto_ext_conn_reset_ffi() };
rust/mtproxy-ffi/src/mtproto/ffi.rs:452:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:462:    unsafe { mtproto_ext_conn_get_by_in_fd_ffi(in_fd, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:470:    unsafe { mtproto_ext_conn_get_by_out_conn_id_ffi(out_conn_id, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:479:    unsafe { mtproto_ext_conn_update_auth_key_ffi(in_fd, in_conn_id, auth_key_id) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:487:    unsafe { mtproto_ext_conn_remove_by_out_conn_id_ffi(out_conn_id, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:496:    unsafe { mtproto_ext_conn_remove_by_in_conn_id_ffi(in_fd, in_conn_id, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:504:    unsafe { mtproto_ext_conn_remove_any_by_out_fd_ffi(out_fd, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:512:    unsafe { mtproto_ext_conn_remove_any_by_in_fd_ffi(in_fd, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:520:    unsafe { mtproto_ext_conn_lru_insert_ffi(in_fd, in_gen) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:525:    unsafe { mtproto_ext_conn_lru_delete_ffi(in_fd) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:532:    unsafe { mtproto_ext_conn_lru_pop_oldest_ffi(out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:540:    unsafe { mtproto_ext_conn_counts_ffi(out_current, out_created) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:548:    unsafe { mtproto_notify_ext_connection_runtime_ffi(ex, send_notifications) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:556:    unsafe { mtproto_remove_ext_connection_runtime_ffi(ex, send_notifications) };
rust/mtproxy-ffi/src/mtproto/ffi.rs:582:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:616:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:633:    unsafe { mtproto_client_send_non_http_wrap_ffi(tlio_in, tlio_out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:642:    unsafe { mtproto_http_send_message_ffi(c, tlio_in, flags) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:655:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:676:    unsafe { mtproto_forward_mtproto_packet_ffi(tlio_in, c, len, remote_ip_port, rpc_flags) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:681:    unsafe { mtproto_choose_proxy_target_ffi(target_dc) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:695:    unsafe { mtproto_parse_function_ffi(data, len, actor_id, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:708:    unsafe { mtproto_cfg_preinit_ffi(default_min_connections, default_max_connections, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:724:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:745:    unsafe { mtproto_cfg_getlex_ext_ffi(cur, len, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:760:    unsafe { mtproto_cfg_scan_directive_token_ffi(cur, len, min_connections, max_connections, out) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:780:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:819:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:859:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:885:    unsafe { mtproto_cfg_expect_semicolon_ffi(cur, len, out_advance) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:903:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:929:    unsafe {
rust/mtproxy-ffi/src/mtproto/ffi.rs:950:    unsafe { mtproto_cfg_parse_config_ffi(mc, flags, config_fd) }
rust/mtproxy-ffi/src/mtproto/ffi.rs:959:    unsafe { mtproto_cfg_do_reload_config_ffi(flags) }
rust/mtproxy-ffi/src/crypto/core.rs:144:        unsafe { core::arch::x86_64::_rdtsc() as i64 }
rust/mtproxy-ffi/src/crypto/core.rs:149:        unsafe { core::arch::x86::_rdtsc() as i64 }
rust/mtproxy-ffi/src/crypto/core.rs:158:        if unsafe { clock_gettime(CLOCK_MONOTONIC_ID, &raw mut ts) } < 0 {
rust/mtproxy-ffi/src/crypto/core.rs:184:    seed ^= unsafe { lrand48() };
rust/mtproxy-ffi/src/crypto/core.rs:187:    unsafe { srand48(seed) };
rust/mtproxy-ffi/src/crypto/core.rs:866:            return unsafe { gf32_combine_clmul_hw_x86_64(powers.as_ptr(), crc1, len2 as u64) };
rust/mtproxy-ffi/src/net_connections/core.rs:28:    let Some(out_remaining_ref) = (unsafe { mut_ref_from_ptr(out_remaining) }) else {
rust/mtproxy-ffi/src/net_connections/core.rs:31:    let Some(out_time_ref) = (unsafe { mut_ref_from_ptr(out_time) }) else {
rust/mtproxy-ffi/src/net_connections/core.rs:57:    let Some(out_next_reconnect_ref) = (unsafe { mut_ref_from_ptr(out_next_reconnect) }) else {
rust/mtproxy-ffi/src/net_connections/core.rs:61:        (unsafe { mut_ref_from_ptr(out_next_reconnect_timeout) })
rust/mtproxy-ffi/src/net_connections/core.rs:113:    let Some(addr) = (unsafe { copy_bytes::<16>(addr_ipv6) }) else {
rust/mtproxy-ffi/src/net_connections/core.rs:131:        (unsafe { mut_ref_from_ptr(out_ready_outbound_delta) })
rust/mtproxy-ffi/src/net_connections/core.rs:135:    let Some(out_ready_targets_delta_ref) = (unsafe { mut_ref_from_ptr(out_ready_targets_delta) })
rust/mtproxy-ffi/src/net_connections/core.rs:194:        (unsafe { mut_ref_from_ptr(out_active_outbound_delta) })
rust/mtproxy-ffi/src/net_connections/core.rs:198:    let Some(out_outbound_delta_ref) = (unsafe { mut_ref_from_ptr(out_outbound_delta) }) else {
rust/mtproxy-ffi/src/net_connections/core.rs:250:        (unsafe { mut_ref_from_ptr(out_active_targets_delta) })
rust/mtproxy-ffi/src/net_connections/core.rs:255:        (unsafe { mut_ref_from_ptr(out_inactive_targets_delta) })
rust/mtproxy-ffi/src/net_connections/core.rs:275:        (unsafe { mut_ref_from_ptr(out_active_targets_delta) })
rust/mtproxy-ffi/src/net_connections/core.rs:280:        (unsafe { mut_ref_from_ptr(out_inactive_targets_delta) })
rust/mtproxy-ffi/src/net_connections/core.rs:284:    let Some(out_was_created_ref) = (unsafe { mut_ref_from_ptr(out_was_created) }) else {
rust/mtproxy-ffi/src/net_connections/core.rs:310:    unsafe {
rust/mtproxy-ffi/src/net_connections/core.rs:333:    unsafe {
rust/mtproxy-ffi/src/net_connections/core.rs:376:    unsafe {
rust/mtproxy-ffi/src/net_connections/core.rs:400:    unsafe {
rust/mtproxy-ffi/src/net_connections/core.rs:453:    unsafe {
rust/mtproxy-ffi/src/net_connections/core.rs:486:    unsafe {
rust/mtproxy-ffi/src/net_connections/core.rs:504:    unsafe {
rust/mtproxy-ffi/src/net_connections/core.rs:533:    unsafe {
rust/mtproxy-ffi/src/net_connections/core.rs:560:    unsafe {
rust/mtproxy-ffi/src/tl_parse/abi.rs:204:    unsafe { crate::ffi_util::mut_ref_from_ptr(ptr) }
rust/mtproxy-ffi/src/tl_parse/abi.rs:209:    unsafe { crate::ffi_util::ref_from_ptr(ptr) }
rust/mtproxy-ffi/src/tl_parse/abi.rs:1352:        if unsafe { tl_out_clean(tlio_out) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1355:        if unsafe { tl_out_store_int(tlio_out, RPC_REQ_ERROR) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1358:        if unsafe { tl_out_store_long(tlio_out, ctx.out_qid) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1361:        if unsafe { tl_out_store_int(tlio_out, ctx.errnum) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1364:        if unsafe { tl_out_store_string0(tlio_out, ctx.error.cast::<i8>()) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1389:        let ptr_ = unsafe { store_get_prepend_ptr_fn(tlio_out, reserve) }.cast::<c_int>();
rust/mtproxy-ffi/src/tl_parse/abi.rs:1406:        unsafe {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1413:        unsafe { store_prefix_fn(tlio_out) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1419:        unsafe { store_flush_fn(tlio_out) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1738:    let checked = unsafe { tl_in_check(tlio_in, nbytes) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1746:    if unsafe { tl_in_check(tlio_in, 4) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1750:    if unsafe { tl_in_lookup_data(tlio_in, (&raw mut value).cast::<c_void>(), 4) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1757:    if unsafe { tl_in_check(tlio_in, 8) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1761:    if unsafe { tl_in_lookup_data(tlio_in, values.as_mut_ptr().cast::<c_void>(), 8) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1768:    if unsafe { tl_in_check(tlio_in, 8) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1772:    if unsafe { tl_in_lookup_data(tlio_in, (&raw mut value).cast::<c_void>(), 8) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1792:    if unsafe { tl_in_check(tlio_in, len) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1795:    let looked = unsafe { tl_in_lookup_data(tlio_in, data, len) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1823:    if unsafe { tl_in_check(tlio_in, 4) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1827:    if unsafe { tl_in_fetch_raw_any(tlio_in, (&raw mut value).cast::<c_void>(), 4) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1834:    if unsafe { tl_in_check(tlio_in, 8) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1838:    if unsafe { tl_in_fetch_raw_any(tlio_in, (&raw mut value).cast::<c_void>(), 8) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1845:    if unsafe { tl_in_check(tlio_in, 8) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1849:    if unsafe { tl_in_fetch_raw_any(tlio_in, (&raw mut value).cast::<c_void>(), 8) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1862:    if buf.is_null() || unsafe { tl_in_check(tlio_in, len) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1865:    let fetched = unsafe { tl_in_fetch_raw_any(tlio_in, buf, len) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1907:    unsafe { fetch_mark(tlio_in) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1915:    unsafe { fetch_mark_restore(tlio_in) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1923:    unsafe { fetch_mark_delete(tlio_in) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1928:    let len = unsafe { tl_fetch_string_len_impl(tlio_in, max_len) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1936:    let pad = unsafe { tl_fetch_pad_impl(tlio_in) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:1950:    if unsafe { tl_in_check(tlio_in, len) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1953:    if len > 0 && unsafe { tl_in_fetch_raw_any(tlio_in, buf.cast::<c_void>(), len) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:1956:    if unsafe { tl_fetch_pad_impl(tlio_in) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2001:        || unsafe { tl_in_check(tlio_in, len) } < 0
rust/mtproxy-ffi/src/tl_parse/abi.rs:2002:        || unsafe { tl_in_skip(tlio_in, len) } < 0
rust/mtproxy-ffi/src/tl_parse/abi.rs:2006:    if unsafe { tl_fetch_pad_impl(tlio_in) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2013:    let len = unsafe { tl_fetch_string_len_impl(tlio_in, max_len) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2021:    let len = unsafe { tl_fetch_string_len_impl(tlio_in, max_len) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2029:    let len = unsafe { tl_fetch_string_len_impl(tlio_in, max_len) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2037:    unsafe {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2052:        unsafe {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2084:    if len < 0 || unsafe { tl_in_check(tlio_in, len) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2087:    let skipped = unsafe { tl_in_skip(tlio_in, len) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2099:        unsafe {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2207:    if unsafe { tl_in_check(tlio_in, bytes) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2219:    unsafe { fetch_raw_message(tlio_in, raw_ref as *mut RawMessage, bytes) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2230:    if unsafe { tl_in_check(tlio_in, bytes) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2239:    unsafe { fetch_lookup_raw_message(tlio_in, raw_ref as *mut RawMessage, bytes) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2325:    if size <= 0 || unsafe { tl_out_check(tlio_out, size) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2334:    let p = unsafe { store_get_ptr(tlio_out, size) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2344:    if size <= 0 || unsafe { tl_out_check(tlio_out, size) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2353:    let p = unsafe { store_get_prepend_ptr(tlio_out, size) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2363:    let rc = unsafe { tl_out_store_int(tlio_out, x) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2371:    let rc = unsafe { tl_out_store_long(tlio_out, x) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2388:    let rc = unsafe { tl_out_store_raw_data(tlio_out, data, len) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2404:    if len < 0 || unsafe { tl_out_check(tlio_out, len) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2414:        unsafe { store_raw_msg(tlio_out, raw_ref as *mut RawMessage) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2417:        unsafe { rwm_clone(&mut cloned, raw_ref as *mut RawMessage) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2418:        unsafe { store_raw_msg(tlio_out, &mut cloned) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2429:    let rc = unsafe { tl_out_store_string_len(tlio_out, usize::try_from(len).unwrap_or(0)) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2437:    let rc = unsafe { tl_out_store_pad(tlio_out) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2451:    if len > 0 && unsafe { tl_out_store_raw_data(tlio_out, s.cast::<c_void>(), len) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2465:    if unsafe { tl_out_store_string_len(tlio_out, len_usize) } < 0 {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2469:        && unsafe {
rust/mtproxy-ffi/src/tl_parse/abi.rs:2492:    unsafe { store_clear(tlio_out) };
rust/mtproxy-ffi/src/tl_parse/abi.rs:2503:    let rc = unsafe { tl_out_clean(tlio_out) };
rust/mtproxy-ffi/src/net_timers/core.rs:180:    unsafe {
rust/mtproxy-ffi/src/net_timers/core.rs:216:        let first = unsafe { state.first_timer() };
rust/mtproxy-ffi/src/net_timers/core.rs:217:        Some((unsafe { (*first).wakeup_time }, state.heap_size))
rust/mtproxy-ffi/src/net_timers/core.rs:238:            let first = unsafe { state.first_timer() };
rust/mtproxy-ffi/src/net_timers/core.rs:239:            if unsafe { (*first).wakeup_time > precise_now_value() } {
rust/mtproxy-ffi/src/net_timers/core.rs:243:            assert_eq!(unsafe { (*first).h_idx }, 1);
rust/mtproxy-ffi/src/net_timers/core.rs:244:            let _ = unsafe { state.remove_impl(first) };
rust/mtproxy-ffi/src/net_timers/core.rs:252:        let Some(wakeup) = (unsafe { (*et).wakeup }) else {
rust/mtproxy-ffi/src/net_timers/core.rs:255:        let _ = unsafe { wakeup(et) };
rust/mtproxy-ffi/src/net_timers/core.rs:264:        let first = unsafe { state.first_timer() };
rust/mtproxy-ffi/src/net_timers/core.rs:265:        Some((unsafe { (*first).wakeup_time }, state.heap_size))
rust/mtproxy-ffi/src/net_timers/core.rs:290:        let first = unsafe { state.first_timer() };
rust/mtproxy-ffi/src/net_timers/core.rs:291:        unsafe { (*first).wakeup_time }
rust/mtproxy-ffi/src/net_timers/core.rs:356:        unsafe {
rust/mtproxy-ffi/src/net_timers/core.rs:362:        let first = unsafe { state.first_timer() };
rust/mtproxy-ffi/src/net_timers/core.rs:373:        let rc = unsafe { state.remove_impl(&mut t1) };
rust/mtproxy-ffi/src/net_timers/core.rs:385:        unsafe {
rust/mtproxy-ffi/src/net_timers/core.rs:392:        let first = unsafe { state.first_timer() };
rust/mtproxy-ffi/src/net_timers/core.rs:400:        unsafe {
rust/mtproxy-ffi/src/net_timers/core.rs:416:        unsafe {
rust/mtproxy-ffi/src/kprintf/core.rs:152:    let logname_ptr = unsafe { logname };
rust/mtproxy-ffi/src/kprintf/core.rs:177:    unsafe { mtproxy_ffi_reopen_logs_ext(0) };
rust/mtproxy-ffi/src/crypto/ffi.rs:24:    let rc = unsafe { mtproxy_ffi_md5(input.cast_const(), len, output) };
rust/mtproxy-ffi/src/crypto/ffi.rs:39:    let rc = unsafe { mtproxy_ffi_md5_hex(input.cast_const().cast(), len, output) };
rust/mtproxy-ffi/src/crypto/ffi.rs:54:    let rc = unsafe { mtproxy_ffi_sha256(input, len, output) };
rust/mtproxy-ffi/src/crypto/ffi.rs:80:    let rc = unsafe {
rust/mtproxy-ffi/src/crypto/ffi.rs:98:    let rc = unsafe {
rust/mtproxy-ffi/src/crypto/ffi.rs:120:    let rc = unsafe { mtproxy_ffi_aesni_ctx_free(ctx) };
rust/mtproxy-ffi/src/crypto/ffi.rs:135:    let rc = unsafe { mtproxy_ffi_aesni_crypt(ctx, input.cast(), output.cast(), size) };
rust/mtproxy-ffi/src/crypto/ffi.rs:148:    if let Some(allocated_aes_crypto_ref) = unsafe { mut_ref_from_ptr(allocated_aes_crypto) } {
rust/mtproxy-ffi/src/crypto/ffi.rs:153:        unsafe { mut_ref_from_ptr(allocated_aes_crypto_temp) }
rust/mtproxy-ffi/src/crypto/ffi.rs:173:    let Some(slot) = (unsafe { mut_ref_from_ptr(conn_crypto_slot) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:176:    let Some(key) = (unsafe { ref_from_ptr(key_data) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:239:    if let Some(slot_ref) = unsafe { mut_ref_from_ptr(conn_crypto_slot) } {
rust/mtproxy-ffi/src/crypto/ffi.rs:250:    if let Some(temp_slot_ref) = unsafe { mut_ref_from_ptr(conn_crypto_temp_slot) } {
rust/mtproxy-ffi/src/crypto/ffi.rs:281:    let Some(cfg_out) = (unsafe { mut_slice_from_ptr(pwd_config_buf, buf_capacity) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:284:    let Some(pwd_config_len_out_ref) = (unsafe { mut_ref_from_ptr(pwd_config_len_out) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:288:        (unsafe { mut_ref_from_ptr(pwd_config_md5_out.cast::<[u8; 33]>()) })
rust/mtproxy-ffi/src/crypto/ffi.rs:292:    let Some(main_secret_ref) = (unsafe { mut_ref_from_ptr(main_secret) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:299:        let Some(filename_ref) = (unsafe { ref_from_ptr(filename) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:354:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out.cast::<[u8; 16]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:440:    let Some(out_dh_params_select_ref) = (unsafe { mut_ref_from_ptr(out_dh_params_select) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:476:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out_rounds.cast::<[i64; 3]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:495:    let Some(dh_params_ref) = (unsafe { mut_ref_from_ptr(dh_params) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:540:    let Some(dh_params_ref) = (unsafe { ref_from_ptr(dh_params) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:564:    let Some(data_ref) = (unsafe { slice_from_ptr(data, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:567:    let Some(prime_ref) = (unsafe { slice_from_ptr(prime_prefix, prime_prefix_len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:595:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:598:    let Some(nonce_server_ref) = (unsafe { ref_from_ptr(nonce_server.cast::<[u8; 16]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:601:    let Some(nonce_client_ref) = (unsafe { ref_from_ptr(nonce_client.cast::<[u8; 16]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:604:    let Some(server_ipv6_ref) = (unsafe { ref_from_ptr(server_ipv6.cast::<[u8; 16]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:607:    let Some(client_ipv6_ref) = (unsafe { ref_from_ptr(client_ipv6.cast::<[u8; 16]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:616:    let Some(secret_ref) = (unsafe { slice_from_ptr(secret, secret_count) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:623:    let Some(temp_ref) = (unsafe { slice_from_ptr(temp_key, temp_count) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:661:    let Some(ctx) = (unsafe { mut_ref_from_ptr(evp_ctx.cast::<AesniCipherCtx>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:664:    let Some(input_ref) = (unsafe { slice_from_ptr(input, size_usize) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:667:    let Some(output_ref) = (unsafe { mut_slice_from_ptr(output, size_usize) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:692:    let Some(out_ref) = (unsafe { mut_slice_from_ptr(out, size) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:709:        (unsafe { mut_ref_from_ptr(out.cast::<[u8; TLS_REQUEST_PUBLIC_KEY_BYTES]>()) })
rust/mtproxy-ffi/src/crypto/ffi.rs:728:    let Some(g_a_ref) = (unsafe { mut_ref_from_ptr(g_a.cast::<[u8; DH_KEY_BYTES]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:731:    let Some(a_out_ref) = (unsafe { mut_ref_from_ptr(a_out.cast::<[u8; DH_KEY_BYTES]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:748:    let Some(g_ab_ref) = (unsafe { mut_ref_from_ptr(g_ab.cast::<[u8; DH_KEY_BYTES]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:751:    let Some(g_a_ref) = (unsafe { mut_ref_from_ptr(g_a.cast::<[u8; DH_KEY_BYTES]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:754:    let Some(g_b_ref) = (unsafe { ref_from_ptr(g_b.cast::<[u8; DH_KEY_BYTES]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:786:    let Some(g_ab_ref) = (unsafe { mut_ref_from_ptr(g_ab.cast::<[u8; DH_KEY_BYTES]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:789:    let Some(g_b_ref) = (unsafe { ref_from_ptr(g_b.cast::<[u8; DH_KEY_BYTES]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:792:    let Some(a_ref) = (unsafe { ref_from_ptr(a.cast::<[u8; DH_KEY_BYTES]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:819:    let Some(key_ref) = (unsafe { ref_from_ptr(key.cast::<[u8; 32]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:822:    let Some(iv_ref) = (unsafe { ref_from_ptr(iv.cast::<[u8; 16]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:825:    let Some(out_ctx_ref) = (unsafe { mut_ref_from_ptr(out_ctx) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:875:    let Some(bytes) = (unsafe { slice_from_ptr(data, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:891:    let Some(bytes) = (unsafe { slice_from_ptr(data, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:919:    let Some(bytes) = (unsafe { slice_from_ptr(data, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:950:    let Some(table) = (unsafe { mut_slice_from_ptr(powers, size) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:962:    let Some(table) = (unsafe { mut_slice_from_ptr(powers, GF32_CLMUL_POWERS_LEN) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:981:    let Some(table) = (unsafe { slice_from_ptr(powers, GF32_GENERIC_POWERS_MAX_LEN) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1000:    let Some(table) = (unsafe { slice_from_ptr(powers, GF32_CLMUL_POWERS_LEN) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1021:    let Some(bytes) = (unsafe { mut_slice_from_ptr(input, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1041:    let Some(bytes) = (unsafe { mut_slice_from_ptr(input, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1044:    let Some(crc_ref) = (unsafe { mut_ref_from_ptr(input_crc32) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1056:    let Some(pid_ref) = (unsafe { mut_ref_from_ptr(pid) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1085:    let Some(pid_ref) = (unsafe { mut_ref_from_ptr(pid) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1105:    let Some(pid_ref) = (unsafe { mut_ref_from_ptr(pid) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1128:    let Some(x_ref) = (unsafe { ref_from_ptr(x) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1131:    let Some(y_ref) = (unsafe { ref_from_ptr(y) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1155:    let Some(a_ref) = (unsafe { ref_from_ptr(a) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1158:    let Some(b_ref) = (unsafe { ref_from_ptr(b) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1182:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(out) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1219:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(output.cast::<[u8; DIGEST_MD5_LEN]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1222:    let Some(input_ref) = (unsafe { slice_from_ptr(input, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1246:    let Some(out) = (unsafe { mut_slice_from_ptr(output.cast::<u8>(), DIGEST_MD5_LEN * 2) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1268:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(output.cast::<[u8; DIGEST_MD5_LEN]>()) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1271:    let Some(key_ref) = (unsafe { slice_from_ptr(key, key_len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1274:    let Some(input_ref) = (unsafe { slice_from_ptr(input, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1294:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(output.cast::<[u8; DIGEST_SHA1_LEN]>()) })
rust/mtproxy-ffi/src/crypto/ffi.rs:1298:    let Some(input_ref) = (unsafe { slice_from_ptr(input, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1320:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(output.cast::<[u8; DIGEST_SHA1_LEN]>()) })
rust/mtproxy-ffi/src/crypto/ffi.rs:1324:    let Some(first) = (unsafe { slice_from_ptr(input1, len1) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1327:    let Some(second) = (unsafe { slice_from_ptr(input2, len2) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1344:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(output.cast::<[u8; DIGEST_SHA256_LEN]>()) })
rust/mtproxy-ffi/src/crypto/ffi.rs:1348:    let Some(input_ref) = (unsafe { slice_from_ptr(input, len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1370:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(output.cast::<[u8; DIGEST_SHA256_LEN]>()) })
rust/mtproxy-ffi/src/crypto/ffi.rs:1374:    let Some(first) = (unsafe { slice_from_ptr(input1, len1) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1377:    let Some(second) = (unsafe { slice_from_ptr(input2, len2) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1400:    let Some(out_ref) = (unsafe { mut_ref_from_ptr(output.cast::<[u8; DIGEST_SHA256_LEN]>()) })
rust/mtproxy-ffi/src/crypto/ffi.rs:1404:    let Some(key_ref) = (unsafe { slice_from_ptr(key, key_len) }) else {
rust/mtproxy-ffi/src/crypto/ffi.rs:1407:    let Some(input_ref) = (unsafe { slice_from_ptr(input, len) }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:299:    let conn = unsafe { mtproxy_ffi_net_tcp_rpc_client_conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:306:    let data = unsafe { mtproxy_ffi_net_tcp_rpc_client_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:313:    let funcs = unsafe { mtproxy_ffi_net_tcp_rpc_client_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:321:    unsafe { ptr::read_unaligned((*secret).secret.as_ptr().cast::<c_int>()) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:326:    let now = unsafe { libc::time(ptr::null_mut()) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:353:    unsafe { mtproxy_ffi_net_tcp_rpc_client_send_data(c, len_i32, data.cast()) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:358:    unsafe { mtproxy_ffi_net_tcp_rpc_client_precise_now() }
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:367:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:368:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:370:    if unsafe { PID.ip } == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:371:        unsafe { init_client_PID((*conn).our_ip) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:374:    if unsafe { (*data).remote_pid.port } == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:375:        let remote_ip = if unsafe { (*conn).remote_ip } == 0x7f00_0001 {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:378:            unsafe { (*conn).remote_ip }
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:380:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:386:    let flags = (unsafe { tcp_get_default_rpc_flags() } as c_int) & RPCF_USE_CRC32C;
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:389:        pid_to_core(unsafe { PID }),
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:390:        pid_to_core(unsafe { (*data).remote_pid }),
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:392:    unsafe { send_data(c, packet.to_bytes().as_ptr(), HandshakePacket::size()) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:398:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:399:    if unsafe { PID.pid } == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:400:        unsafe { init_client_PID((*conn).our_ip) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:403:    let packet = HandshakeErrorPacket::new(error_code, pid_to_core(unsafe { PID }));
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:404:    unsafe { send_data(c, packet.to_bytes().as_ptr(), HandshakeErrorPacket::size()) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:409:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:410:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:411:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:413:    let packet_num = unsafe { (*data).in_packet_num - 1 };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:416:        unsafe { rwm_fetch_lookup(msg, ptr::addr_of_mut!(packet_type).cast(), 4) },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:419:    let packet_len = unsafe { (*msg).total_bytes };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:437:        unsafe { rwm_fetch_data(msg, packet.as_mut_ptr().cast(), packet_len) },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:450:    let main_secret_len = unsafe { main_secret.secret_len };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:451:    let main_key_signature = unsafe { main_secret_key_signature() };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:455:        unsafe { ((*data).crypto_flags & RPCF_ALLOW_UNENC) != 0 },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:456:        unsafe { ((*data).crypto_flags & RPCF_ALLOW_ENC) != 0 },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:457:        unsafe { ((*data).crypto_flags & RPCF_REQ_DH) != 0 },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:458:        unsafe { !(*conn).crypto_temp.is_null() },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:459:        unsafe { (*data).nonce_time },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:475:            if unsafe { ((*data).crypto_flags & RPCF_ALLOW_UNENC) == 0 } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:478:            if unsafe { ((*data).crypto_flags & RPCF_ALLOW_ENC) != 0 } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:479:                assert_eq!(unsafe { (*conn).out_p.total_bytes }, 0);
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:481:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:490:                if processed_has_dh_params == 0 || unsafe { dh_params_select } == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:491:                    let _ = unsafe { init_dh_params() };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:494:                    || parsed.dh_params_select != unsafe { dh_params_select }
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:498:                if unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:504:                temp_dh_len = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:514:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:520:            if unsafe { !(*conn).crypto_temp.is_null() } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:521:                let tmp = unsafe { (*conn).crypto_temp.cast::<CryptoTempDhParams>() };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:522:                let free_len = if unsafe { (*tmp).magic } == CRYPTO_TEMP_DH_PARAMS_MAGIC {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:527:                unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:533:            let Some(rpc_start_crypto) = (unsafe { (*funcs).rpc_start_crypto }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:542:            let res = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:564:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:565:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:567:    let packet_num = unsafe { (*data).in_packet_num - 1 };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:568:    let packet_len = unsafe { (*msg).total_bytes };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:571:        unsafe { rwm_fetch_lookup(msg, ptr::addr_of_mut!(packet_type).cast(), 4) },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:585:        let _ = unsafe { tcp_rpcc_send_handshake_error_packet_impl(c, -3) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:591:        unsafe { rwm_fetch_data(msg, packet.as_mut_ptr().cast(), packet_len) },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:595:        let _ = unsafe { tcp_rpcc_send_handshake_error_packet_impl(c, -3) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:600:    let mut expected_remote = unsafe { (*data).remote_pid };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:601:    let sender_matches = unsafe { matches_pid(&mut sender_pid, &mut expected_remote) != 0 };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:603:        sender_pid.ip = unsafe { (*data).remote_pid.ip };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:606:    let mut local_pid = unsafe { PID };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:608:    let peer_pid_matches = unsafe { matches_pid(&mut local_pid, &mut peer_pid) != 0 };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:612:        (unsafe { (*funcs).mode_flags } & TCP_RPC_IGNORE_PID) != 0,
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:614:        unsafe { tcp_get_default_rpc_flags() as c_int },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:618:            let _ = unsafe { tcp_rpcc_send_handshake_error_packet_impl(c, code) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:623:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:628:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:637:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:638:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:639:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:642:        let len = unsafe { (*conn).in_data.total_bytes };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:652:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:663:            core_packet_len_state(packet_len, unsafe { (*funcs).max_packet_len });
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:665:            unsafe { fail_connection(c, -1) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:670:                unsafe { rwm_skip_data(ptr::addr_of_mut!((*conn).in_data), 4) },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:676:            unsafe { fail_connection(c, -2) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:685:        if unsafe { (*conn).in_data.total_bytes } == packet_len {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:686:            msg = unsafe { ptr::read(ptr::addr_of!((*conn).in_data)) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:687:            let _ = unsafe { rwm_init(ptr::addr_of_mut!((*conn).in_data), 0) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:689:            let _ = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:700:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:706:        let packet_crc32 = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:714:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:721:        assert_eq!(unsafe { rwm_skip_data(ptr::addr_of_mut!(msg), 4) }, 4);
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:726:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:736:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:746:        if unsafe { verbosity > 2 } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:747:            let _ = unsafe { rwm_dump(ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:750:        if packet_num != unsafe { (*data).in_packet_num } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:751:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:759:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:764:                    unsafe { tcp_rpcc_process_nonce_packet_impl(c, ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:766:                    rc = unsafe { tcp_rpcc_send_handshake_packet_impl(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:771:                    unsafe { tcp_rpcc_process_handshake_packet_impl(c, ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:772:                if rc >= 0 && unsafe { (*funcs).rpc_ready.is_some() } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:773:                    unsafe { notification_event_insert_tcp_conn_ready(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:780:            let _ = unsafe { rwm_free(ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:782:                unsafe { fail_connection(c, res) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:788:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:793:            unsafe { tcp_rpc_default_execute(c, packet_type, ptr::addr_of_mut!(msg)) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:794:        } else if let Some(execute) = unsafe { (*funcs).execute } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:795:            unsafe { execute(c, packet_type, ptr::addr_of_mut!(msg)) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:801:            let _ = unsafe { rwm_free(ptr::addr_of_mut!(msg)) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:809:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:810:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:811:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:813:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:818:    if let Some(rpc_check_perm) = unsafe { (*funcs).rpc_check_perm } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:819:        let res = unsafe { rpc_check_perm(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:826:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:830:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:835:    let Some(rpc_init_crypto) = (unsafe { (*funcs).rpc_init_crypto }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:838:    let res = unsafe { rpc_init_crypto(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:840:        assert!((unsafe { (*data).crypto_flags } & RPCF_ENC_SENT) != 0);
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:845:    let Some(flush_packet) = (unsafe { (*funcs).flush_packet }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:848:    let _ = unsafe { flush_packet(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:854:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:855:    if unsafe { (*funcs).rpc_close.is_some() } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:856:        unsafe { notification_event_insert_tcp_conn_close(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:858:    unsafe { cpu_server_close_connection(c, who) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:862:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:863:    let Some(check_ready) = (unsafe { (*funcs).check_ready }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:866:    unsafe { check_ready(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:870:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:871:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:875:        (unsafe { (*conn).flags } & C_ERROR) != 0,
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:876:        unsafe { (*conn).status == CONN_CONNECTING },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:877:        unsafe { (*data).in_packet_num },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:878:        unsafe { (*conn).last_query_sent_time },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:881:        unsafe { (*conn).status == CONN_WORKING },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:885:        DefaultReadyState::NotYet => unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:889:        DefaultReadyState::Ok => unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:895:                unsafe { fail_connection(c, code) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:897:            unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:906:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:907:    let Ok(next_flags) = core_init_fake_crypto_state(unsafe { (*data).crypto_flags }) else {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:914:    unsafe { send_data(c, packet.as_ptr(), packet.len()) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:916:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:924:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:925:    let funcs = unsafe { rpc_funcs(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:926:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:928:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:933:    if let Some(rpc_check_perm) = unsafe { (*funcs).rpc_check_perm } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:934:        let res = unsafe { rpc_check_perm(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:941:        if core_requires_dh_accept(res) && unsafe { tcp_add_dh_accept() } < 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:944:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:948:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:953:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:964:    core_default_check_perm(unsafe { tcp_get_default_rpc_flags() as c_int })
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:968:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:969:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:971:    if unsafe { ((*data).crypto_flags & RPCF_ALLOW_ENC) == 0 } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:972:        return unsafe { tcp_rpcc_init_fake_crypto_impl(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:975:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:980:    if unsafe { dh_params_select } == 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:981:        assert!(unsafe { init_dh_params() } >= 0);
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:982:        assert!(unsafe { dh_params_select } != 0);
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:987:    write_i32_ne(&mut packet, 4, unsafe { main_secret_key_signature() });
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:989:    write_i32_ne(&mut packet, 12, unsafe { (*data).nonce_time });
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:990:    packet[16..32].copy_from_slice(unsafe { &(*data).nonce });
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:995:    if (unsafe { (*data).crypto_flags } & RPCF_REQ_DH) != 0 {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:997:        write_i32_ne(&mut packet, 36, unsafe { dh_params_select });
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:999:        assert!(unsafe { (*conn).crypto_temp.is_null() });
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1000:        unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1010:    unsafe { send_data(c, packet.as_ptr(), len) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1013:        unsafe { (*data).crypto_flags & (RPCF_ALLOW_ENC | RPCF_ENC_SENT) },
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1016:    unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1020:    assert!(unsafe { (*conn).crypto.is_null() });
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1032:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1033:    let data = unsafe { rpc_data(c) };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1035:    if unsafe { !(*conn).crypto.is_null() } {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1038:    if unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1048:    let create_res = unsafe {
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1070:    let mut aes_keys = unsafe { aes_keys.assume_init() };
rust/mtproxy-ffi/src/net_tcp_rpc_client/core.rs:1071:    if unsafe {
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:11:    unsafe { register_custom_op_cb_impl(op, func) };
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:26:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:48:    unsafe { process_act_atom_subjob_impl(job.cast::<AsyncJob>(), op, jt) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:57:    unsafe { process_query_job_impl(job.cast::<AsyncJob>(), op, jt) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:66:    unsafe { tl_aio_init_store_impl(type_, pid, qid).cast() }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:74:    unsafe { engine_work_rpc_req_result_impl(tlio_in, params) };
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:79:    unsafe { tl_result_new_flags_impl(old_flags) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:86:    unsafe { tl_result_get_header_len_impl(h) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:94:    unsafe { tl_result_make_header_impl(ptr, h) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:99:    unsafe { tl_default_act_free_impl(extra) };
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:106:    unsafe { tl_default_act_dup_impl(extra) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:114:    unsafe { tl_query_result_fun_set_impl(func, query_type_id) };
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:124:    unsafe { engine_tl_init_impl(parse, stat, get_op, timeout) };
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:129:    unsafe { tl_engine_store_stats_impl(tlio_out) };
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:138:    unsafe { process_query_custom_subjob_impl(job.cast::<AsyncJob>(), op, jt) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:152:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:174:    unsafe { create_query_custom_job_impl(job.cast::<AsyncJob>(), raw, timeout, fd, generation) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:184:    unsafe { do_create_query_job_impl(raw, type_, pid, conn) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:192:    unsafe { default_tl_close_conn_impl(c) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:201:    unsafe { default_tl_tcp_rpcs_execute_impl(c, op, raw) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:208:    unsafe { tl_generate_next_qid_impl(query_type_id) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:217:    unsafe { tl_store_stats_impl(tlio_out, s, raw) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:226:    unsafe { query_job_run_impl(job.cast::<AsyncJob>(), fd, generation) }
rust/mtproxy-ffi/src/engine_rpc/ffi.rs:235:    unsafe { do_query_job_run_impl(job.cast::<AsyncJob>(), op, jt) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:292:    let ticks = unsafe { core::arch::x86_64::_rdtsc() };
rust/mtproxy-ffi/src/engine_rpc/core.rs:294:    let ticks = unsafe { core::arch::x86::_rdtsc() };
rust/mtproxy-ffi/src/engine_rpc/core.rs:491:    (unsafe { (*job).j_status } & JSP_PARENT_INCOMPLETE) != 0
rust/mtproxy-ffi/src/engine_rpc/core.rs:492:        && !unsafe { (*job).j_parent }.is_null()
rust/mtproxy-ffi/src/engine_rpc/core.rs:493:        && (unsafe { (*(*job).j_parent).j_flags } & JF_COMPLETED) != 0
rust/mtproxy-ffi/src/engine_rpc/core.rs:498:    if unsafe { (*job).j_error } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:499:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:508:    unsafe { (*job).j_custom.as_mut_ptr().cast::<T>() }
rust/mtproxy-ffi/src/engine_rpc/core.rs:513:    unsafe { job_custom_ptr::<QueryWorkParams>(job) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:518:    unsafe { job_custom_ptr::<QueryInfo>(job) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:524:    let info = unsafe { job_custom_ptr::<ConnectionInfo>(conn.cast::<AsyncJob>()) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:531:    unsafe { (*conn_info(conn)).fd }
rust/mtproxy-ffi/src/engine_rpc/core.rs:536:    unsafe { (*conn_info(conn)).generation }
rust/mtproxy-ffi/src/engine_rpc/core.rs:546:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:553:    let info = unsafe { conn_info(conn) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:564:    let remote = unsafe { ptr::read_unaligned(ptr::addr_of!((*tcp_rpc_data(conn)).remote_pid)) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:565:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:575:    unsafe { mtproxy_ffi_engine_rpc_call_default_parse_function(tlio_in, actor_id) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:580:    if unsafe { verbosity } >= 1 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:581:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:596:        unsafe { libc::strdup(s) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:606:        let io = unsafe { c_tl_out_state_alloc() }.cast::<TlOutState>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:608:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:614:        let d = unsafe { rpc_target_choose_connection(rpc_target_lookup(pid), pid) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:618:        let io = unsafe { c_tl_out_state_alloc() }.cast::<TlOutState>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:620:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:631:    let entry = unsafe { libc::malloc(size_of::<RpcCustomOp>()) }.cast::<RpcCustomOp>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:634:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:639:    let rc = unsafe { mtproxy_ffi_engine_rpc_custom_op_insert(op, entry.cast()) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:651:    let len = if unsafe { (*h).flags } == 0 { 0 } else { 8 };
rust/mtproxy-ffi/src/engine_rpc/core.rs:659:    if unsafe { (*h).flags } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:664:    let new_flags = unsafe { tl_result_new_flags_impl((*h).flags) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:665:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:676:    if !unsafe { (*extra).header }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:677:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:681:    if (unsafe { (*extra).flags } & 1) == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:684:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:691:    let size = unsafe { (*extra).size };
rust/mtproxy-ffi/src/engine_rpc/core.rs:694:    let new_extra = unsafe { libc::malloc(size as usize) }.cast::<TlActExtra>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:696:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:707:    let h = unsafe { libc::malloc(size_of::<TlQueryHeader>()) }.cast::<TlQueryHeader>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:710:    if unsafe { c_tlf_query_answer_header(tlio_in.cast(), h) } < 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:711:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:717:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:720:    let query_type_id = unsafe { mtproxy_ffi_engine_rpc_query_result_type_id_from_qid((*h).qid) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:721:    let has_table = c_int::from(unsafe { TL_QUERY_RESULT_TABLE_ALLOCATED });
rust/mtproxy-ffi/src/engine_rpc/core.rs:725:            unsafe { TL_QUERY_RESULT_FUNCTIONS[idx] }
rust/mtproxy-ffi/src/engine_rpc/core.rs:734:        unsafe { mtproxy_ffi_engine_rpc_query_result_dispatch_decision(has_table, has_handler) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:738:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:743:        unsafe { log_unknown_query_type(query_type_id, (*h).qid) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:746:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:752:    let op = unsafe { tlf_lookup_int_rust(tlio_in.cast()) } as c_uint;
rust/mtproxy-ffi/src/engine_rpc/core.rs:753:    let custom = unsafe { mtproxy_ffi_engine_rpc_custom_op_lookup(op) }.cast::<RpcCustomOp>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:757:    let func = unsafe { ptr::read_unaligned(ptr::addr_of!((*custom).func)) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:759:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:770:    let p = unsafe { query_work_params(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:774:        let io = unsafe { c_tl_in_state_alloc() }.cast::<TlInState>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:776:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:792:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:801:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:809:            assert!(unsafe { (*job).j_refcnt } == 1);
rust/mtproxy-ffi/src/engine_rpc/core.rs:810:            if unsafe { (*p).src.magic } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:811:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:815:            unsafe { c_job_free(1, job.cast()) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:822:    let p = unsafe { query_work_params(parent) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:824:    assert!(!unsafe { (*p).h }.is_null());
rust/mtproxy-ffi/src/engine_rpc/core.rs:826:    let root = unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:842:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:850:    let p = unsafe { query_work_params(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:855:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:858:            let io = unsafe { c_tl_in_state_alloc() }.cast::<TlInState>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:861:            let rc = unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:870:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:879:        JS_ABORT | JS_ALARM | JS_FINISH => unsafe { process_query_job_impl(job, op, jt) },
rust/mtproxy-ffi/src/engine_rpc/core.rs:894:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:898:    let pd = unsafe { ptr::read_unaligned(remote_pid) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:899:    let p = unsafe { query_work_params(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:902:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:924:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:928:    let q = unsafe { query_info(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:930:    let p = unsafe { query_work_params(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:933:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:960:    let job = unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:974:    let q = unsafe { query_info(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:976:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:987:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:998:    unsafe { touch_conn_last_response_time(c) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1000:    let mut remote_pid: ProcessId = unsafe { core::mem::zeroed() };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1001:    unsafe { copy_tcp_remote_pid(c, &raw mut remote_pid) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1002:    let conn_ref = if unsafe { mtproxy_ffi_engine_rpc_tcp_should_hold_conn(op) } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1003:        unsafe { c_job_incref(c) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1007:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1017:        let initial = unsafe { lrand48_j() } as u32;
rust/mtproxy-ffi/src/engine_rpc/core.rs:1022:    let high_random = (unsafe { lrand48_j() } as c_int) & 0x0fff_ffff;
rust/mtproxy-ffi/src/engine_rpc/core.rs:1030:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1042:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1051:    let stat = unsafe { TL_STAT_FUNCTION };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1053:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1060:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1075:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1080:    let cnt_ptr = unsafe { c_tls_get_ptr_rust(tlio_out, 4) }.cast::<c_int>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:1082:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1086:    let bytes = unsafe { CStr::from_ptr(s) }.to_bytes();
rust/mtproxy-ffi/src/engine_rpc/core.rs:1095:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1112:    unsafe { *cnt_ptr }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1120:    unsafe { process_act_atom_subjob_impl(job.cast::<AsyncJob>(), op, jt) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1124:    unsafe { process_query_job_impl(job, op, jt) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1128:    unsafe { process_parse_subjob_impl(job, op, jt) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1136:    unsafe { process_query_custom_subjob_impl(job, op, jt) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1144:    unsafe { do_query_job_run_impl(job.cast::<AsyncJob>(), op, jt) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1158:    let get_op = unsafe { TL_GET_OP_FUNCTION }.expect("tl_get_op_function must be initialized");
rust/mtproxy-ffi/src/engine_rpc/core.rs:1159:    let fop = unsafe { get_op(tlio_in) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1161:    let mut extra = unsafe { call_default_parse_function(tlio_in, actor_id) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1162:    if extra.is_null() && unsafe { tlf_error_rust(tlio_in.cast()) } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1163:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1170:        if let Some(parse_fn) = unsafe { TL_PARSE_FUNCTION } {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1171:            extra = unsafe { parse_fn(tlio_in, actor_id) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1175:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1188:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1219:        unsafe { c_job_incref(parent.cast()) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1222:    let job = unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1239:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1244:        let job_ref = unsafe { c_job_incref(job.cast()) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1245:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1254:    if op != JS_FINISH && unsafe { parent_job_aborted(job) } {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1255:        return unsafe { job_fatal(job, libc::ECANCELED) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1258:    let e = unsafe { *job_custom_ptr::<*mut TlActExtra>(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1263:            if unsafe { (*e).raw }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1264:                if !unsafe { (*e).extra_ref }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1265:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1272:            let io = unsafe { c_tl_out_state_alloc() }.cast::<TlOutState>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:1274:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1280:            let act = unsafe { (*e).act }.expect("tl_act_extra::act must be set");
rust/mtproxy-ffi/src/engine_rpc/core.rs:1281:            let res = unsafe { act(job, e) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1282:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1287:            if res >= 0 && unsafe { (*io).error }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1288:                let raw = unsafe { libc::malloc(size_of::<RawMessage>()) }.cast::<RawMessage>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:1290:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1295:                if !unsafe { (*e).raw }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1296:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1300:                    if !unsafe { (*e).extra_ref }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1301:                        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1309:                && unsafe { (*e).attempt } < 5
rust/mtproxy-ffi/src/engine_rpc/core.rs:1310:                && unsafe { (*io).error }.is_null()
rust/mtproxy-ffi/src/engine_rpc/core.rs:1311:                && unsafe { (*job).j_children } > 0
rust/mtproxy-ffi/src/engine_rpc/core.rs:1313:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1319:                if unsafe { (*io).error }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1320:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1343:                assert!(!unsafe { (*io).error }.is_null());
rust/mtproxy-ffi/src/engine_rpc/core.rs:1345:                if !unsafe { (*e).raw }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1346:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1351:                    if !unsafe { (*e).extra_ref }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1352:                        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1358:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1361:                unsafe { job_fatal(job, libc::EIO) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1365:            if unsafe { (*job).j_error } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1366:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1370:                if !unsafe { (*e).raw }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1371:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1378:            if !unsafe { (*e).extra_ref }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1379:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1386:            if !unsafe { (*e).extra_ref }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1387:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1391:            let free_fn = unsafe { (*e).free }.expect("tl_act_extra::free must be set");
rust/mtproxy-ffi/src/engine_rpc/core.rs:1392:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1403:    let p = unsafe { query_work_params(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1410:            assert!(unsafe { (*job).j_children } == 0);
rust/mtproxy-ffi/src/engine_rpc/core.rs:1411:            assert!(unsafe { (*p).wait_pos }.is_null());
rust/mtproxy-ffi/src/engine_rpc/core.rs:1413:            if unsafe { (*p).result }.is_null() && unsafe { (*p).error }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1414:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1420:            if unsafe { (*p).answer_sent } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1421:                if unsafe { (*p).fd } != 0 && unsafe { (*p).type_ } == TL_TYPE_RAW_MSG {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1422:                    let c = unsafe { connection_get_by_fd((*p).fd) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1423:                    if !c.is_null() && unsafe { conn_generation(c) } != unsafe { (*p).generation } {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1424:                        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1429:                        io = unsafe { c_tl_out_state_alloc() }.cast::<TlOutState>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:1431:                        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1437:                    io = unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1445:                assert!(unsafe { (*p).answer_sent } == 0);
rust/mtproxy-ffi/src/engine_rpc/core.rs:1446:                if unsafe { (*p).error_code } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1447:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1458:                    let z = unsafe { tl_result_get_header_len_impl((*p).h) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1459:                    let hptr = unsafe { c_tls_get_ptr_rust(io.cast(), z) }.cast::<c_int>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:1460:                    assert_eq!(z, unsafe { tl_result_make_header_impl(hptr, (*p).h) });
rust/mtproxy-ffi/src/engine_rpc/core.rs:1461:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1467:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1473:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1483:            if unsafe { c_job_timer_check(job.cast()) } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1486:            if unsafe { (*p).answer_sent } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1487:                io = unsafe { c_tl_aio_init_store((*p).type_, &raw mut (*p).pid, (*(*p).h).qid) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1491:                if unsafe { (*p).error_code } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1492:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1502:                } else if !unsafe { (*p).wait_pos }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1503:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1511:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1520:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1526:            if unsafe { (*job).j_error } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1527:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1531:            if !unsafe { (*p).all_list }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1532:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1539:            if unsafe { (*p).answer_sent } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1540:                io = unsafe { c_tl_aio_init_store((*p).type_, &raw mut (*p).pid, (*(*p).h).qid) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1544:                if unsafe { (*p).error_code } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1545:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1556:                    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1564:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1570:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1579:            assert!(unsafe { (*p).wait_pos }.is_null());
rust/mtproxy-ffi/src/engine_rpc/core.rs:1580:            assert!(unsafe { (*p).all_list }.is_null());
rust/mtproxy-ffi/src/engine_rpc/core.rs:1581:            assert!(unsafe { (*job).j_refcnt } == 1);
rust/mtproxy-ffi/src/engine_rpc/core.rs:1583:            if !unsafe { (*p).p }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1584:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1589:            if !unsafe { (*p).error }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1590:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1594:            if !unsafe { (*p).result }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1595:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1600:            if unsafe { (*p).src.magic } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1601:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1605:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1615:    let q = unsafe { query_info(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1618:    let io = unsafe { c_tl_in_state_alloc() }.cast::<TlInState>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:1620:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1629:    let op = unsafe { tlf_lookup_int_rust(io.cast()) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1633:    let has_custom_ops = unsafe { mtproxy_ffi_engine_rpc_custom_op_has_any() };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1635:        unsafe { mtproxy_ffi_engine_rpc_query_job_dispatch_decision(op, has_custom_ops) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1646:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1655:        h = unsafe { libc::malloc(size_of::<TlQueryHeader>()) }.cast::<TlQueryHeader>();
rust/mtproxy-ffi/src/engine_rpc/core.rs:1657:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1661:        if unsafe { tlf_error_rust(io.cast()) } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1663:                unsafe { c_tl_aio_init_store((*q).src_type, &raw mut (*q).src_pid, (*h).qid) }
rust/mtproxy-ffi/src/engine_rpc/core.rs:1666:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1687:            unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1705:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1709:    unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1716:    let q = unsafe { query_info(job) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1722:    if !unsafe { (*q).conn }.is_null() {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1723:        unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1732:        return unsafe { query_job_run_impl(job, fd, generation) };
rust/mtproxy-ffi/src/engine_rpc/core.rs:1735:    assert_eq!(unsafe { c_job_timer_active(job.cast()) }, 0);
rust/mtproxy-ffi/src/engine_rpc/core.rs:1739:            if unsafe { (*job).j_error } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1740:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1747:            if unsafe { (*job).j_error } == 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1748:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1755:            if unsafe { (*q).raw.magic } != 0 {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1756:                unsafe {
rust/mtproxy-ffi/src/engine_rpc/core.rs:1760:            unsafe { c_job_free(1, job.cast()) }
rust/mtproxy-ffi/src/net_msg_buffers/ffi.rs:10:    unsafe { raw_msg_buffer_prepare_stat_impl(sb) }
rust/mtproxy-ffi/src/net_msg_buffers/ffi.rs:15:    unsafe { fetch_buffers_stat_impl(bs) }
rust/mtproxy-ffi/src/net_msg_buffers/ffi.rs:20:    unsafe { init_msg_buffers_impl(max_buffer_bytes) }
rust/mtproxy-ffi/src/net_msg_buffers/ffi.rs:28:    unsafe { alloc_msg_buffer_impl(neighbor, size_hint) }
rust/mtproxy-ffi/src/net_msg_buffers/ffi.rs:33:    unsafe { free_msg_buffer_impl(buffer) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:8:    unsafe { tcp_rpcc_parse_execute_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:13:    unsafe { tcp_rpcc_connected_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:21:    unsafe { tcp_rpcc_close_connection_impl(c, who) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:26:    unsafe { tcp_rpc_client_check_ready_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:33:    unsafe { tcp_rpcc_default_check_ready_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:38:    unsafe { tcp_rpcc_init_outbound_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:50:    unsafe { tcp_rpcc_default_check_perm_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:55:    unsafe { tcp_rpcc_init_crypto_impl(c) }
rust/mtproxy-ffi/src/net_tcp_rpc_client/ffi.rs:66:    unsafe { tcp_rpcc_start_crypto_impl(c, nonce, key_select, temp_key, temp_key_len) }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:297:            stat = unsafe { libc::calloc(1, size_of::<RawMsgBufferModuleStat>()) }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:301:            let id = unsafe { get_this_thread_id() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:303:            unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:315:    let max_id = if unsafe { max_job_thread_id } < 0 {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:318:        usize::try_from(unsafe { max_job_thread_id }).unwrap_or(0) + 1
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:323:        let stat = unsafe { RAW_MSG_BUFFER_MODULE_STAT_ARRAY[i] };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:327:        let value_ptr = unsafe { stat.cast::<u8>().add(field_offset).cast::<c_int>() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:328:        sum += unsafe { *value_ptr };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:337:    let max_id = if unsafe { max_job_thread_id } < 0 {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:340:        usize::try_from(unsafe { max_job_thread_id }).unwrap_or(0) + 1
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:345:        let stat = unsafe { RAW_MSG_BUFFER_MODULE_STAT_ARRAY[i] };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:349:        let value_ptr = unsafe { stat.cast::<u8>().add(field_offset).cast::<c_longlong>() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:350:        sum += unsafe { *value_ptr };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:357:    assert_eq!(unsafe { BUFFER_SIZE_VALUES }, 0);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:360:        let ch = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:366:        unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:381:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:387:    assert!(unsafe { BUFFER_SIZE_VALUES } > 0);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:388:    let count = usize::try_from(unsafe { BUFFER_SIZE_VALUES }).unwrap_or(0);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:389:    let sizes = unsafe { &CHUNK_BUFFER_SIZES[..count] };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:391:    assert!(si >= 0 && si < unsafe { BUFFER_SIZE_VALUES });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:396:    let mut x = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:410:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:418:        if unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:427:        let _ = unsafe { libc::usleep(1_000) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:432:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:438:    if unsafe { (*c).magic } != MSG_CHUNK_USED_MAGIC
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:439:        || !unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:451:        let x = unsafe { mpq_pop_nw((*c).free_block_queue, 4) }.cast::<MsgBuffer>();
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:455:        assert_eq!(unsafe { (*x).chunk }, c);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:456:        let Some(free_buffer) = (unsafe { (*c).free_buffer }) else {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:459:        let _ = unsafe { free_buffer(c, x) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:468:            let x = unsafe { mpq_pop_nw((*c).free_block_queue, 4) }.cast::<MsgBuffer>();
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:472:            assert_eq!(unsafe { (*x).chunk }, c);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:473:            let Some(free_buffer) = (unsafe { (*c).free_buffer }) else {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:476:            let _ = unsafe { free_buffer(c, x) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:479:        unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:483:        if unsafe { mpq_is_empty((*c).free_block_queue) != 0 } || !unsafe { try_lock_chunk(c) } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:490:    let magic = unsafe { (*ch).magic };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:493:    if unsafe { allocated_buffer_chunks >= max_buffer_chunks } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:497:    let c = unsafe { libc::malloc(usize::try_from(MSG_BUFFERS_CHUNK_SIZE).unwrap_or(0)) }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:503:    let buffer_size = unsafe { (*ch).buffer_size };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:528:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:554:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:569:    let stat = unsafe { ensure_raw_msg_buffer_module_stat_tls() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:570:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:578:        let keep_max = unsafe { max_allocated_buffer_chunks };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:580:        let keep_allocated = unsafe { allocated_buffer_chunks };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:587:        let _ = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:595:        if unsafe { allocated_buffer_chunks >= max_buffer_chunks - 8 }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:596:            && unsafe { max_buffer_chunks >= 32 }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:597:            && unsafe { verbosity < 3 }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:603:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:629:    assert_eq!(unsafe { (*c).magic }, MSG_CHUNK_USED_LOCKED_MAGIC);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:630:    let free_block_queue = unsafe { (*c).free_block_queue };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:632:    let magic = unsafe { (*ch).magic };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:634:    assert_eq!(unsafe { (*c).buffer_size }, unsafe { (*ch).buffer_size });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:635:    assert_eq!(unsafe { (*c).tot_buffers }, unsafe { free_cnt_get(c, 1) });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:636:    assert_eq!(ch, unsafe { (*c).ch_head });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:638:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:652:    assert!(unsafe { (*ch).tot_chunks >= 0 });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:654:    let _ = unsafe { atomic_fetch_add_i32(ptr::addr_of_mut!(allocated_buffer_chunks), -1) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:655:    let stat = unsafe { ensure_raw_msg_buffer_module_stat_tls() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:656:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:660:    let mut si = unsafe { BUFFER_SIZE_VALUES - 1 };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:662:        && unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:676:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:685:    assert_eq!(unsafe { (*c).magic }, MSG_CHUNK_USED_LOCKED_MAGIC);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:686:    assert_eq!(unsafe { free_cnt_get(c, 1) }, unsafe { (*c).tot_buffers });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:687:    unsafe { free_msg_buffers_chunk_internal(c, (*c).ch_head) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:692:        .wrapping_sub(unsafe { (*c).first_buffer.cast::<u8>() as usize }) as u32;
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:693:    n >>= u32::try_from(unsafe { (*c).bs_shift }).unwrap_or(0);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:694:    n = n.wrapping_mul(u32::from_ne_bytes(unsafe { (*c).bs_inverse }.to_ne_bytes()));
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:696:    assert!(n <= u32::try_from(unsafe { (*c).tot_buffers }).unwrap_or(0));
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:699:        unsafe { (*c).buffer_size } + c_int::try_from(BUFF_HD_BYTES).unwrap_or(c_int::MAX),
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:702:    let expected = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:719:    let magic = unsafe { (*ch).magic };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:724:        c = unsafe { alloc_new_msg_buffers_chunk(ch) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:732:        if unsafe { free_cnt_get(c_hint, 1) > 0 } && unsafe { try_lock_chunk(c_hint) } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:733:            assert_eq!(unsafe { (*c_hint).ch_head }, ch);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:735:            if unsafe { free_cnt_get(c_hint, 1) > 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:738:                unsafe { unlock_chunk(c_hint) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:743:            unsafe { lock_chunk_head(ch) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:745:                unsafe { (*ch).ch_next }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:753:                    selected = unsafe { (*selected).ch_next };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:760:                if unsafe { free_cnt_get(selected, 1) == 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:761:                    selected = unsafe { (*selected).ch_next };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:768:                if !unsafe { try_lock_chunk(selected) } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:769:                    selected = unsafe { (*selected).ch_next };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:776:                if unsafe { free_cnt_get(selected, 1) == 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:777:                    unsafe { unlock_chunk(selected) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:778:                    selected = unsafe { (*selected).ch_next };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:789:            unsafe { unlock_chunk_head(ch) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:792:                selected = unsafe { alloc_new_msg_buffers_chunk(ch) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:799:                let _ = unsafe { atomic_fetch_add_i32(ptr::addr_of_mut!((*c_hint).refcnt), -1) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:807:    assert!(unsafe { free_cnt_get(c, 1) > 0 });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:808:    assert_eq!(unsafe { (*c).magic }, MSG_CHUNK_USED_LOCKED_MAGIC);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:811:    let two_power = unsafe { (*c).two_power };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:814:    if !neighbor.is_null() && unsafe { (*neighbor).chunk == c } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:815:        let x = unsafe { get_buffer_no(c, neighbor) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:818:        if x < two_power - 1 && unsafe { free_cnt_get(c, two_power + x + 1) > 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:830:                    if unsafe { free_cnt_get(c, i) > 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:832:                        if unsafe { free_cnt_get(c, i + 1) > 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:839:                } else if unsafe { free_cnt_get(c, i + 1) > 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:847:                        if unsafe { free_cnt_get(c, i) == 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:850:                        let v = unsafe { free_cnt_get(c, i) - 1 };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:852:                        unsafe { free_cnt_set(c, i, v) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:864:            let v = unsafe { free_cnt_get(c, k) - 1 };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:866:            unsafe { free_cnt_set(c, k, v) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:870:        let mut j = unsafe { free_cnt_get(c, 1) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:875:        j = ((i64::try_from(unsafe { lrand48_j() }).unwrap_or(0) * i64::from(j)) >> 31) as c_int;
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:876:        assert!(j >= 0 && j < unsafe { free_cnt_get(c, 1) });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:879:            let v = unsafe { free_cnt_get(c, i) - 1 };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:881:            unsafe { free_cnt_set(c, i, v) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:884:            if unsafe { free_cnt_get(c, i) <= j } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:885:                j -= unsafe { free_cnt_get(c, i) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:890:        let v = unsafe { free_cnt_get(c, i) - 1 };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:892:        unsafe { free_cnt_set(c, i, v) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:896:    unsafe { unlock_chunk(c) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:899:    assert!(i >= 0 && i < unsafe { (*c).tot_buffers });
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:901:    let x = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:912:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:918:    let stat = unsafe { ensure_raw_msg_buffer_module_stat_tls() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:919:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:931:    assert_eq!(unsafe { (*x).refcnt }, 0);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:932:    assert_eq!(unsafe { (*x).magic }, MSG_BUFFER_USED_MAGIC);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:933:    assert_eq!(unsafe { (*c).magic }, MSG_CHUNK_USED_LOCKED_MAGIC);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:934:    assert_eq!(unsafe { (*x).chunk }, c);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:936:    let mut idx = unsafe { get_buffer_no(c, x) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:937:    let two_power = unsafe { (*c).two_power };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:940:    assert_eq!(unsafe { free_cnt_get(c, idx) }, 0);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:943:        let v = unsafe { free_cnt_get(c, idx) + 1 };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:945:        unsafe { free_cnt_set(c, idx, v) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:953:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:958:    let stat = unsafe { ensure_raw_msg_buffer_module_stat_tls() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:959:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:980:            let x = unsafe { *job_custom_ptr(job) }.cast::<MsgBuffer>();
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:982:            let c = unsafe { (*x).chunk };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:983:            let magic = unsafe { (*c).magic };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:986:            let Some(free_buffer) = (unsafe { (*c).free_buffer }) else {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:989:            let _ = unsafe { free_buffer(c, x) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:993:            assert_eq!(unsafe { (*job).j_refcnt }, 1);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:994:            unsafe { job_free(1, job) }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1008:    let total_used_buffers_size = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1011:    let total_used_buffers = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1014:    let allocated_buffer_bytes = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1017:    let buffer_chunk_alloc_ops = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1021:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1063:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1083:        limit = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1095:            >= c_longlong::from(unsafe { allocated_buffer_chunks })
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1099:    unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1118:    if unsafe { BUFFER_SIZE_VALUES == 0 } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1119:        unsafe { init_buffer_chunk_headers() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1122:    let si = unsafe { msg_buffer_pick_size_index(size_hint) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1123:    let ch = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1130:    unsafe { alloc_msg_buffer_internal(neighbor, ch, c_hint, si) }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1135:    assert_eq!(unsafe { (*x).magic }, MSG_BUFFER_USED_MAGIC);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1136:    assert_eq!(unsafe { (*x).refcnt }, 0);
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1138:    let c = unsafe { (*x).chunk };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1139:    let magic = unsafe { (*c).magic };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1142:    let is_std_free = match unsafe { (*c).free_buffer } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1150:        if unsafe { try_lock_chunk(c) } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1151:            let Some(free_buffer) = (unsafe { (*c).free_buffer }) else {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1154:            let _ = unsafe { free_buffer(c, x) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1155:            unsafe { unlock_chunk(c) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1158:            let _ = unsafe { mpq_push_w((*c).free_block_queue, x.cast::<c_void>(), 0) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1160:            if unsafe { try_lock_chunk(c) } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1161:                unsafe { unlock_chunk(c) };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1166:        let jt = unsafe { jobs_get_this_job_thread_c_impl() };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1167:        if jt.is_null() || unsafe { (*jt).thread_class == (*c).thread_class } {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1168:            let Some(free_buffer) = (unsafe { (*c).free_buffer }) else {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1171:            unsafe { free_buffer(c, x) }
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1173:            let job = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1186:            unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1196:    let used = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1199:    let max = unsafe { max_allocated_buffer_bytes as c_double };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1204:    let used = unsafe {
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1207:    let max = unsafe { max_allocated_buffer_bytes as c_double };
rust/mtproxy-ffi/src/net_msg_buffers/core.rs:1238:        unsafe {
rust/mtproxy-ffi/src/net_http_server/ffi.rs:12:    unsafe { hts_default_execute_impl(c, raw, op) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:17:    unsafe { hts_init_accepted_impl(c) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:25:    unsafe { hts_close_connection_impl(c, who) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:34:    unsafe { write_http_error_raw_impl(c, raw, code) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:42:    unsafe { write_http_error_impl(c, code) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:50:    unsafe { hts_write_packet_impl(c, raw) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:55:    unsafe { hts_parse_execute_impl(c) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:60:    unsafe { hts_std_wakeup_impl(c) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:65:    unsafe { hts_std_alarm_impl(c) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:70:    unsafe { hts_do_wakeup_impl(c) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:78:    unsafe { gen_http_date_impl(date_buffer, time) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:83:    unsafe { cur_http_date_impl() }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:95:    unsafe { get_http_header_impl(q_headers, q_headers_len, buffer, b_len, arg_name, arg_len) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:108:    unsafe { write_basic_http_header_raw_impl(c, raw, code, date, len, add_header, content_type) }
rust/mtproxy-ffi/src/net_http_server/ffi.rs:116:    unsafe { http_flush_impl(c, raw) }
rust/mtproxy-ffi/src/net_http_server/core.rs:238:    let conn = unsafe { mtproxy_ffi_net_http_server_conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:245:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:246:    unsafe { (*conn).custom_data.as_mut_ptr().cast::<HtsData>() }
rust/mtproxy-ffi/src/net_http_server/core.rs:251:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:252:    unsafe { (*conn).extra.cast::<HttpServerFunctions>() }
rust/mtproxy-ffi/src/net_http_server/core.rs:257:    let wlen = unsafe { (*d).wlen };
rust/mtproxy-ffi/src/net_http_server/core.rs:262:        if unsafe { (*d).word[i] } != *expected {
rust/mtproxy-ffi/src/net_http_server/core.rs:271:    let wlen = unsafe { (*d).wlen };
rust/mtproxy-ffi/src/net_http_server/core.rs:276:        if !unsafe { (*d).word[i] }.eq_ignore_ascii_case(expected) {
rust/mtproxy-ffi/src/net_http_server/core.rs:286:    let message = unsafe { mtproxy_ffi_net_http_error_msg_text(&raw mut normalized) };
rust/mtproxy-ffi/src/net_http_server/core.rs:297:    let d = unsafe { hts_data(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:299:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:311:        HTQT_GET | HTQT_POST | HTQT_HEAD | HTQT_OPTIONS => unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:314:        _ => unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:319:    if unsafe { (*d).data_size } >= 0 {
rust/mtproxy-ffi/src/net_http_server/core.rs:327:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:334:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:337:    let funcs = unsafe { hts_funcs(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:340:        if let Some(close_cb) = unsafe { (*funcs).ht_close } {
rust/mtproxy-ffi/src/net_http_server/core.rs:341:            unsafe { close_cb(c, who) };
rust/mtproxy-ffi/src/net_http_server/core.rs:345:    unsafe { cpu_server_close_connection(c, who) }
rust/mtproxy-ffi/src/net_http_server/core.rs:354:        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:361:    let error_message = unsafe { http_get_error_msg_text(&mut code) };
rust/mtproxy-ffi/src/net_http_server/core.rs:362:    let written = unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:376:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:384:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:385:    let raw = unsafe { libc::calloc(1, core::mem::size_of::<RawMessage>()).cast::<RawMessage>() };
rust/mtproxy-ffi/src/net_http_server/core.rs:388:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:391:    let result = unsafe { write_http_error_raw_impl(c, raw, code) };
rust/mtproxy-ffi/src/net_http_server/core.rs:393:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:402:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:403:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:410:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:411:    let funcs = unsafe { hts_funcs(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:414:    let d = unsafe { hts_data(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:416:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:428:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:432:    while unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:435:        if unsafe { ((*conn).flags & (C_ERROR | C_STOPPARSE)) != 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:439:        let len = unsafe { rwm_get_block_ptr_bytes(&raw mut raw) };
rust/mtproxy-ffi/src/net_http_server/core.rs:441:        let ptr_s = unsafe { rwm_get_block_ptr(&raw mut raw).cast::<u8>() };
rust/mtproxy-ffi/src/net_http_server/core.rs:444:        let ptr_e = unsafe { ptr_s.add(usize::try_from(len).unwrap_or(0)) };
rust/mtproxy-ffi/src/net_http_server/core.rs:446:        while ptr_cur < ptr_e && unsafe { (*d).parse_state != HTQP_DONE } {
rust/mtproxy-ffi/src/net_http_server/core.rs:447:            match unsafe { (*d).parse_state } {
rust/mtproxy-ffi/src/net_http_server/core.rs:449:                    let seqno = unsafe { (*d).query_seqno.wrapping_add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:450:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:460:                    while ptr_cur < ptr_e && unsafe { *ptr_cur > b' ' } {
rust/mtproxy-ffi/src/net_http_server/core.rs:461:                        if unsafe { (*d).wlen < 15 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:462:                            let idx = usize::try_from(unsafe { (*d).wlen }).unwrap_or(0);
rust/mtproxy-ffi/src/net_http_server/core.rs:463:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:467:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:470:                        ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:472:                    if unsafe { (*d).wlen > 4096 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:473:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:481:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:485:                    if unsafe { (*d).query_words == 1 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:486:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:489:                        if unsafe { word_eq(d, b"GET") } {
rust/mtproxy-ffi/src/net_http_server/core.rs:490:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:493:                        } else if unsafe { (*d).wlen == 4 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:494:                            if unsafe { word_eq(d, b"HEAD") } {
rust/mtproxy-ffi/src/net_http_server/core.rs:495:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:498:                            } else if unsafe { word_eq(d, b"POST") } {
rust/mtproxy-ffi/src/net_http_server/core.rs:499:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:503:                        } else if unsafe { word_eq(d, b"OPTIONS") } {
rust/mtproxy-ffi/src/net_http_server/core.rs:504:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:508:                        if unsafe { (*d).query_type == HTQT_ERROR } {
rust/mtproxy-ffi/src/net_http_server/core.rs:509:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:514:                    } else if unsafe { (*d).query_words == 2 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:515:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:519:                        if unsafe { (*d).wlen == 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:520:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:525:                    } else if unsafe { (*d).query_words == 3 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:526:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:529:                        if unsafe { (*d).wlen != 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:530:                            if unsafe { (*d).wlen != 8 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:531:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:535:                            } else if unsafe { word_eq(d, b"HTTP/1.0") } {
rust/mtproxy-ffi/src/net_http_server/core.rs:536:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:539:                            } else if unsafe { word_eq(d, b"HTTP/1.1") } {
rust/mtproxy-ffi/src/net_http_server/core.rs:540:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:544:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:550:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:555:                        assert!(unsafe { ((*d).query_flags & (QF_HOST | QF_CONNECTION)) != 0 });
rust/mtproxy-ffi/src/net_http_server/core.rs:556:                        if unsafe { (*d).wlen != 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:557:                            if unsafe { ((*d).query_flags & QF_HOST) != 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:558:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:562:                            } else if unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:565:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:570:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:575:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:580:                    while unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:585:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:588:                        ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:590:                    if unsafe { (*d).header_size >= MAX_HTTP_HEADER_SIZE } {
rust/mtproxy-ffi/src/net_http_server/core.rs:591:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:599:                    if unsafe { (*d).parse_state == HTQP_SKIPSPCTOEOLN } {
rust/mtproxy-ffi/src/net_http_server/core.rs:600:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:605:                    if unsafe { (*d).query_words < 3 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:606:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:611:                        assert!(unsafe { (*d).query_words >= 4 });
rust/mtproxy-ffi/src/net_http_server/core.rs:612:                        if unsafe { ((*d).query_flags & QF_DATASIZE) != 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:613:                            if unsafe { (*d).data_size != -1 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:614:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:619:                                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:624:                        } else if unsafe { ((*d).query_flags & (QF_HOST | QF_CONNECTION)) != 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:625:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:630:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:637:                    while ptr_cur < ptr_e && unsafe { *ptr_cur != b':' && *ptr_cur > b' ' } {
rust/mtproxy-ffi/src/net_http_server/core.rs:638:                        if unsafe { (*d).wlen < 15 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:639:                            let idx = usize::try_from(unsafe { (*d).wlen }).unwrap_or(0);
rust/mtproxy-ffi/src/net_http_server/core.rs:640:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:644:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:647:                        ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:649:                    if unsafe { (*d).wlen > 4096 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:650:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:659:                    if unsafe { *ptr_cur != b':' } {
rust/mtproxy-ffi/src/net_http_server/core.rs:660:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:668:                    ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:670:                    if unsafe { (*d).wlen == 4 && word_eq_ascii_case(d, b"host") } {
rust/mtproxy-ffi/src/net_http_server/core.rs:671:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:674:                    } else if unsafe { (*d).wlen == 10 && word_eq_ascii_case(d, b"connection") } {
rust/mtproxy-ffi/src/net_http_server/core.rs:675:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:678:                    } else if unsafe { (*d).wlen == 14 && word_eq_ascii_case(d, b"content-length") }
rust/mtproxy-ffi/src/net_http_server/core.rs:680:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:684:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:689:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:695:                    let mut tt = i64::from(unsafe { (*d).data_size });
rust/mtproxy-ffi/src/net_http_server/core.rs:696:                    while ptr_cur < ptr_e && unsafe { *ptr_cur >= b'0' && *ptr_cur <= b'9' } {
rust/mtproxy-ffi/src/net_http_server/core.rs:698:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:704:                        tt = tt * 10 + i64::from(unsafe { *ptr_cur - b'0' });
rust/mtproxy-ffi/src/net_http_server/core.rs:705:                        ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:706:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:712:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:719:                    if unsafe { ((*d).query_flags & QF_DATASIZE) != 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:720:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:725:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:731:                    while unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:737:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:740:                        ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:742:                    if unsafe { (*d).header_size >= MAX_HTTP_HEADER_SIZE } {
rust/mtproxy-ffi/src/net_http_server/core.rs:743:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:752:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:761:                    if unsafe { *ptr_cur == b'\r' } {
rust/mtproxy-ffi/src/net_http_server/core.rs:762:                        ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:763:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:767:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:776:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:798:                    ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:799:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:810:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:838:                    if unsafe { *ptr_cur != b'\n' } {
rust/mtproxy-ffi/src/net_http_server/core.rs:839:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:844:                    ptr_cur = unsafe { ptr_cur.add(1) };
rust/mtproxy-ffi/src/net_http_server/core.rs:845:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:856:                HTQP_FATAL => unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:866:        let consumed = c_int::try_from(unsafe { ptr_cur.offset_from(ptr_s) }).unwrap_or(0);
rust/mtproxy-ffi/src/net_http_server/core.rs:867:        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:871:        if unsafe { (*d).parse_state == HTQP_DONE } {
rust/mtproxy-ffi/src/net_http_server/core.rs:872:            if unsafe { (*d).header_size >= MAX_HTTP_HEADER_SIZE } {
rust/mtproxy-ffi/src/net_http_server/core.rs:873:                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:878:            if unsafe { ((*d).query_flags & QF_ERROR) == 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:879:                if unsafe { (*funcs).execute.is_none() } {
rust/mtproxy-ffi/src/net_http_server/core.rs:880:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:885:                let res = if unsafe { (*d).query_type == HTQT_POST && (*d).data_size < 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:887:                } else if unsafe { (*d).query_type != HTQT_POST && (*d).data_size > 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:890:                    let mut bytes = unsafe { (*d).header_size };
rust/mtproxy-ffi/src/net_http_server/core.rs:891:                    if unsafe { (*d).query_type == HTQT_POST } {
rust/mtproxy-ffi/src/net_http_server/core.rs:892:                        bytes += unsafe { (*d).data_size };
rust/mtproxy-ffi/src/net_http_server/core.rs:902:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:905:                    if bytes < unsafe { (*conn).in_data.total_bytes } {
rust/mtproxy-ffi/src/net_http_server/core.rs:906:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:911:                    let exec = unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:916:                    let exec_res = unsafe { exec(c, &raw mut r, (*d).query_type) };
rust/mtproxy-ffi/src/net_http_server/core.rs:917:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:923:                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:929:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:935:                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:942:                    if unsafe { (*d).data_size > 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:943:                        let x = unsafe { (*conn).in_data.total_bytes };
rust/mtproxy-ffi/src/net_http_server/core.rs:944:                        let y = if x > unsafe { (*d).data_size } {
rust/mtproxy-ffi/src/net_http_server/core.rs:945:                            unsafe { (*d).data_size }
rust/mtproxy-ffi/src/net_http_server/core.rs:949:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:953:                            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:962:                        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:966:                    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:972:                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:981:            if unsafe { ((*d).query_flags & QF_ERROR) != 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:982:                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:987:            if unsafe { (*conn).pending_queries == 0 && ((*d).query_flags & QF_KEEPALIVE) == 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:988:                unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:996:            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1004:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1011:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1012:    let funcs = unsafe { hts_funcs(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1015:        if let Some(cb) = unsafe { (*funcs).ht_wakeup } {
rust/mtproxy-ffi/src/net_http_server/core.rs:1016:            unsafe { cb(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1020:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1027:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1028:    let funcs = unsafe { hts_funcs(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1031:        if let Some(cb) = unsafe { (*funcs).ht_alarm } {
rust/mtproxy-ffi/src/net_http_server/core.rs:1032:            unsafe { cb(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1036:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1043:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1049:    let rc = unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1061:    let now_value = unsafe { mtproxy_ffi_net_http_server_now() };
rust/mtproxy-ffi/src/net_http_server/core.rs:1062:    if unsafe { NOW_DATE_UTIME != now_value } {
rust/mtproxy-ffi/src/net_http_server/core.rs:1063:        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1079:    unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1093:    let d = unsafe { hts_data(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1095:    if unsafe { (*d).http_ver >= HTTP_V10 || (*d).http_ver == 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:1099:        let error_message = unsafe { http_get_error_msg_text(&mut code) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1101:            unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1106:        let written = unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1143:        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1155:            let w = unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1166:        let w = unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1175:        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1185:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1187:        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1192:    let d = unsafe { hts_data(c) };
rust/mtproxy-ffi/src/net_http_server/core.rs:1193:    if unsafe { (*conn).pending_queries == 0 && ((*d).query_flags & QF_KEEPALIVE) == 0 } {
rust/mtproxy-ffi/src/net_http_server/core.rs:1194:        unsafe {
rust/mtproxy-ffi/src/net_http_server/core.rs:1200:    unsafe {
rust/mtproxy-ffi/src/vv_tree/core.rs:46:    unsafe { ref_from_ptr(handle.cast::<VvTree>().cast_const()) }
rust/mtproxy-ffi/src/vv_tree/core.rs:71:    let Some(tree) = (unsafe { vv_tree_as_ref(handle) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:84:    let Some(tree) = (unsafe { vv_tree_as_ref(handle) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:98:    let Some(tree) = (unsafe { vv_tree_as_ref(handle) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:108:    let Some(tree) = (unsafe { vv_tree_as_ref(handle) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:117:    let Some(tree) = (unsafe { vv_tree_as_ref(handle) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:129:    let Some(tree) = (unsafe { vv_tree_as_ref(handle) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:310:    let Some(tree_ref) = (unsafe { mut_ref_from_ptr(tree) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:314:    unsafe { conn_tree_acquire_raw(*tree_ref) }
rust/mtproxy-ffi/src/vv_tree/core.rs:391:    let Some(pid_ref) = (unsafe { ref_from_ptr(pid) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:418:    let Some(pid_ref) = (unsafe { ref_from_ptr(pid) }) else {
rust/mtproxy-ffi/src/vv_tree/core.rs:466:        unsafe {
rust/mtproxy-ffi/src/vv_tree/core.rs:486:        unsafe {
rust/mtproxy-ffi/src/vv_tree/core.rs:518:        unsafe {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:6:    let ticks = unsafe { core::arch::x86_64::_rdtsc() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:8:    let ticks = unsafe { core::arch::x86::_rdtsc() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:28:    if unsafe { clock_gettime(clock_id, &raw mut ts) } < 0 {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:39:    if unsafe { gettimeofday(&raw mut tv, core::ptr::null_mut()) } < 0 {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:64:        .unwrap_or_else(|| time_parts_to_f64(unsafe { time(core::ptr::null_mut()) }, 0, 0.0));
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:76:            .unwrap_or_else(|| time_parts_to_f64(unsafe { time(core::ptr::null_mut()) }, 0, 0.0));
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:90:        .unwrap_or_else(|| time_parts_to_f64(unsafe { time(core::ptr::null_mut()) }, 0, 0.0));
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:282:    Some(unsafe { core::slice::from_raw_parts(data, len) })
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:293:    Some(unsafe { core::slice::from_raw_parts(ptr, len) })
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:313:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:319:    let cur = unsafe { cfg_cur };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:320:    let end = unsafe { cfg_end };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:324:    let diff = unsafe { end.offset_from(cur) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:338:    let rc = unsafe {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:349:    unsafe { cfg_cur = cfg_cur.add(out.advance) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:350:    unsafe { cfg_lno = out.line_no };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:371:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:383:    let rc = unsafe {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:394:    unsafe { cfg_cur = cfg_cur.add(out.advance) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:395:    unsafe { cfg_lno = out.line_no };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:417:    let _ = unsafe { mtproxy_ffi_cfg_skspc_global() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:418:    unsafe { mtproxy_ffi_cfg_getword_len(cfg_cur.cast_const(), cfg_remaining_len_global()) }
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:439:    let _ = unsafe { mtproxy_ffi_cfg_skspc_global() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:440:    unsafe { mtproxy_ffi_cfg_getstr_len(cfg_cur.cast_const(), cfg_remaining_len_global()) }
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:449:    let ch = unsafe { mtproxy_ffi_cfg_skipspc_global() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:452:            let cur = unsafe { cfg_cur };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:456:                let c = unsafe { i32::from(*cur.cast::<u8>()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:457:                unsafe { cfg_cur = cfg_cur.add(1) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:464:    unsafe { cfg_lex = lex };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:484:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:495:    let _ = unsafe { mtproxy_ffi_cfg_skspc_global() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:497:    let rc = unsafe {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:507:    unsafe { cfg_cur = cfg_cur.add(out.consumed) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:528:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:546:    let _ = unsafe { mtproxy_ffi_cfg_skspc_global() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:548:    let rc = unsafe {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:561:    unsafe { cfg_cur = cfg_cur.add(out.consumed) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:581:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:592:    let _ = unsafe { mtproxy_ffi_cfg_skspc_global() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:594:    let rc = unsafe {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:607:    unsafe { cfg_cur = cfg_cur.add(out.consumed) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:617:    if unsafe { cfg_lex } == lexem {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:620:        unsafe { syntax(b"%c expected\0".as_ptr().cast(), lexem) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:634:    let l = unsafe { mtproxy_ffi_cfg_getword_global() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:636:        unsafe { syntax(b"Expected %.*s\0".as_ptr().cast(), len, name) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:640:        unsafe { syntax(b"Expected %.*s\0".as_ptr().cast(), len, name) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:643:    let src = unsafe { core::slice::from_raw_parts(name.cast::<u8>(), len_usize) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:644:    let cur = unsafe { cfg_cur };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:646:        unsafe { syntax(b"Expected %.*s\0".as_ptr().cast(), len, name) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:649:    let cur_slice = unsafe { core::slice::from_raw_parts(cur.cast::<u8>(), len_usize) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:651:        unsafe { syntax(b"Expected %.*s\0".as_ptr().cast(), len, name) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:654:    unsafe { cfg_cur = cfg_cur.add(len_usize) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:683:    let end_ptr = unsafe { config_buff_ptr.add(config_len) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:684:    unsafe {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:738:        effective_fd = unsafe { libc::open(file.cast(), libc::O_RDONLY) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:744:    let mut buff = unsafe { *config_buff_ptr };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:749:        let alloc_ptr = unsafe { libc::malloc(alloc_size) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:754:        unsafe { *config_buff_ptr = buff };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:757:    let read_res = unsafe { libc::read(effective_fd, buff.cast(), max_len.saturating_add(1)) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:769:    unsafe { *config_bytes_ptr = read_i32 };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:771:    let prev_name = unsafe { *config_name_ptr };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:773:        unsafe { libc::free(prev_name.cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:775:    unsafe { *config_name_ptr = core::ptr::null_mut() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:777:        let name_dup = unsafe { libc::strdup(file.cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:778:        unsafe { *config_name_ptr = name_dup.cast() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:781:    let reset_rc = unsafe {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:815:    let data = unsafe { core::slice::from_raw_parts(config_buff_ptr.cast::<u8>(), config_len) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:817:    let out_bytes = unsafe { core::slice::from_raw_parts_mut(out.cast::<u8>(), 32) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:856:    let buff = unsafe { *config_buff_ptr };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:858:        unsafe { libc::free(buff.cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:859:        unsafe { *config_buff_ptr = core::ptr::null_mut() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:862:    let name = unsafe { *config_name_ptr };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:864:        unsafe { libc::free(name.cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:865:        unsafe { *config_name_ptr = core::ptr::null_mut() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:868:    unsafe { *config_bytes_ptr = 0 };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:869:    unsafe { *cfg_cur_ptr = core::ptr::null_mut() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:870:    unsafe { *cfg_start_ptr = core::ptr::null_mut() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:871:    unsafe { *cfg_end_ptr = core::ptr::null_mut() };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:874:        let fd = unsafe { *fd_ptr };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:876:            if unsafe { libc::close(fd) } != 0 {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:879:            unsafe { *fd_ptr = -1 };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:887:    let cursor = unsafe { cfg_cur };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:888:    let end = unsafe { cfg_end };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:890:        unsafe { syntax(b"hostname expected\0".as_ptr().cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:894:    let rem = unsafe { end.offset_from(cursor) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:896:        unsafe { syntax(b"hostname expected\0".as_ptr().cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:900:        unsafe { syntax(b"hostname expected\0".as_ptr().cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:904:    let bytes = unsafe { core::slice::from_raw_parts(cursor.cast::<u8>(), rem_len) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:907:        unsafe { syntax(b"hostname expected\0".as_ptr().cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:911:        unsafe { syntax(b"hostname expected\0".as_ptr().cast()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:915:    let host_end = unsafe { cursor.add(word_len) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:916:    let saved = unsafe { *host_end };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:917:    unsafe { *host_end = 0 };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:918:    let host = unsafe { kdb_gethostbyname(cursor.cast_const()) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:922:        let h_addr_list = unsafe { (*host).h_addr_list };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:923:        !h_addr_list.is_null() && !(unsafe { *h_addr_list }).is_null()
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:926:    unsafe { *host_end = saved };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:927:    unsafe { cfg_cur = host_end };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:930:        if unsafe { verbosity } >= verb {
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:931:            unsafe { syntax(b"cannot resolve '%s'\n\0".as_ptr().cast(), cursor) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:945:    unsafe { cfg_gethost_impl(verb) }.cast()
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:954:    unsafe { cfg_gethost_impl(0) }.cast()
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:1030:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:1052:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:1154:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:1183:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:1223:    let out_slice = unsafe { core::slice::from_raw_parts_mut(out_values, count) };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:1297:    let out_ref = unsafe { &mut *out };
rust/mtproxy-ffi/src/time_cfg_observability/core.rs:1327:    let out_bytes = unsafe { core::slice::from_raw_parts_mut(out.cast::<u8>(), out_len) };
rust/mtproxy-ffi/src/net_connections/ffi.rs:29:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:55:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:90:    unsafe { target_bucket_ipv6_ffi(type_addr, addr_ipv6, port, prime_targets) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:104:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:165:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:230:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:252:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:303:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:325:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:358:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:404:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:434:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:520:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:541:    unsafe { socket_free_plan_ffi(has_conn, out_fail_error, out_allocated_socket_delta) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:676:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:905:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:1023:    unsafe { connection_write_close_impl(c) };
rust/mtproxy-ffi/src/net_connections/ffi.rs:1032:    unsafe { set_connection_timeout_impl(c, timeout) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1040:    unsafe { clear_connection_timeout_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1046:    unsafe { fail_connection_impl(c, err) };
rust/mtproxy-ffi/src/net_connections/ffi.rs:1054:    unsafe { cpu_server_free_connection_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1063:    unsafe { cpu_server_close_connection_impl(c, who) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1072:    unsafe { connection_event_incref_impl(fd, val) };
rust/mtproxy-ffi/src/net_connections/ffi.rs:1080:    unsafe { connection_get_by_fd_impl(fd) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1089:    unsafe { connection_get_by_fd_generation_impl(fd, generation) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1097:    unsafe { server_check_ready_conn_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1103:    unsafe { server_noop_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1109:    unsafe { server_failed_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1115:    unsafe { server_flush_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1124:    unsafe { check_conn_functions_impl(type_, listening) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1132:    unsafe { compute_next_reconnect_target_impl(ct) };
rust/mtproxy-ffi/src/net_connections/ffi.rs:1141:    unsafe { conn_target_get_connection_impl(ct, allow_stopped) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1150:    unsafe { fail_socket_connection_impl(c, who) };
rust/mtproxy-ffi/src/net_connections/ffi.rs:1160:    unsafe { do_connection_job_impl(job, op, jt) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1168:    unsafe { alloc_new_socket_connection_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1185:    unsafe {
rust/mtproxy-ffi/src/net_connections/ffi.rs:1197:    unsafe { net_server_socket_free_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1205:    unsafe { net_server_socket_reader_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1213:    unsafe { net_server_socket_writer_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1223:    unsafe { do_socket_connection_job_impl(job, op, jt.cast()) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1231:    unsafe { net_accept_new_connections_impl(lcj) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1243:    unsafe { init_listening_connection_ext_impl(fd, type_, extra, mode, prio) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1253:    unsafe { init_listening_connection_impl(fd, type_, extra) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1264:    unsafe { init_listening_tcpv6_connection_impl(fd, type_, extra, mode) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1272:    unsafe { destroy_dead_target_connections_impl(ctj) };
rust/mtproxy-ffi/src/net_connections/ffi.rs:1280:    unsafe { create_new_connections_impl(ctj) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1290:    unsafe { do_conn_target_job_impl(job, op, jt.cast()) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1298:    unsafe { clean_unused_target_impl(ctj) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1307:    unsafe { destroy_target_impl(ctj_tag_int, ctj) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1316:    unsafe { create_target_impl(source, was_created) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1322:    unsafe { free_target_impl(ctj) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1328:    unsafe { insert_free_later_struct_impl(f) };
rust/mtproxy-ffi/src/net_connections/ffi.rs:1334:    unsafe { free_later_act_impl() };
rust/mtproxy-ffi/src/net_connections/ffi.rs:1344:    unsafe { do_listening_connection_job_impl(job, op, jt.cast()) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1352:    unsafe { net_server_socket_read_write_impl(c) }
rust/mtproxy-ffi/src/net_connections/ffi.rs:1362:    unsafe { net_server_socket_read_write_gateway_impl(fd, data, ev) }
rust/mtproxy-ffi/src/ffi_util/core.rs:18:        unsafe { ptr.as_mut() }
rust/mtproxy-ffi/src/ffi_util/core.rs:31:        unsafe { ptr.as_ref() }
rust/mtproxy-ffi/src/ffi_util/core.rs:44:        let empty = unsafe { slice::from_raw_parts_mut(NonNull::<T>::dangling().as_ptr(), 0) };
rust/mtproxy-ffi/src/ffi_util/core.rs:49:    Some(unsafe { slice::from_raw_parts_mut(ptr.as_ptr(), len) })
rust/mtproxy-ffi/src/ffi_util/core.rs:63:    Some(unsafe { slice::from_raw_parts(ptr.as_ptr(), len) })
rust/mtproxy-ffi/src/ffi_util/core.rs:76:    unsafe { ptr::copy_nonoverlapping(src.as_ptr(), out.as_mut_ptr(), N) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:672:    unsafe { job_custom_ptr(c) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:677:    unsafe { job_custom_ptr(c) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:682:    unsafe { job_custom_ptr(c) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:687:    unsafe { job_custom_ptr(c) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:692:    unsafe { &*ptr.cast::<AtomicI32>() }
rust/mtproxy-ffi/src/net_connections/runtime.rs:697:    unsafe { &*ptr.cast::<AtomicI64>() }
rust/mtproxy-ffi/src/net_connections/runtime.rs:702:    unsafe { job_signal(1, job_incref(job), signo) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:707:    unsafe { job_decref(1, job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:723:    assert_eq!(unsafe { TCP_RECV_BUFFERS_NUM }, 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:726:        let neighbor = if unsafe { TCP_RECV_BUFFERS_NUM } != 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:727:            unsafe { TCP_RECV_BUFFERS[i + 1] }
rust/mtproxy-ffi/src/net_connections/runtime.rs:731:        let x = unsafe { alloc_msg_buffer(neighbor, TCP_RECV_BUFFER_SIZE) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:733:            unsafe { kprintf(FATAL_TCP_RECV_BUFFER_MSG.as_ptr().cast()) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:734:            unsafe { libc::exit(2) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:737:        let chunk = unsafe { (*x).chunk };
rust/mtproxy-ffi/src/net_connections/runtime.rs:739:        let buffer_size = unsafe { (*chunk).buffer_size };
rust/mtproxy-ffi/src/net_connections/runtime.rs:742:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:750:    unsafe { TCP_RECV_BUFFERS_NUM }
rust/mtproxy-ffi/src/net_connections/runtime.rs:759:    let t = unsafe { rwm_prepare_iovec(raw, iov, maxcnt, (*raw).total_bytes) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:761:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:767:            total += c_int::try_from(unsafe { (*iov.add(i)).iov_len }).unwrap_or(c_int::MAX);
rust/mtproxy-ffi/src/net_connections/runtime.rs:769:        assert!(total < unsafe { (*raw).total_bytes });
rust/mtproxy-ffi/src/net_connections/runtime.rs:772:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:780:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:781:    let io_conn = unsafe { (*conn).io_conn };
rust/mtproxy-ffi/src/net_connections/runtime.rs:783:        unsafe { (*conn).status },
rust/mtproxy-ffi/src/net_connections/runtime.rs:791:        let io = unsafe { socket_conn_info(io_conn) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:792:        unsafe { atomic_i32(ptr::addr_of_mut!((*io).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:796:        unsafe { atomic_i32(ptr::addr_of_mut!((*conn).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:800:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:805:        unsafe { job_signal_create_pass(c, JS_RUN) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:810:    let socket = unsafe { socket_conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:811:    assert!((unsafe { (*c.cast::<AsyncJob>()).j_flags } & JF_LOCKED) != 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:813:    let previous_flags = unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:821:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:829:    let type_ = unsafe { (*socket).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:831:    if let Some(socket_close) = unsafe { (*type_).socket_close } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:832:        unsafe { socket_close(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:835:    unsafe { fail_connection_impl((*socket).conn, who) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:839:    let socket = unsafe { socket_conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:840:    assert!(unsafe { (*socket).ev.is_null() });
rust/mtproxy-ffi/src/net_connections/runtime.rs:841:    assert!((unsafe { (*socket).flags } & C_ERROR) != 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:844:        mtproxy_core::runtime::net::connections::socket_free_plan(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:853:        let conn = unsafe { (*socket).conn };
rust/mtproxy-ffi/src/net_connections/runtime.rs:855:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:862:        let raw = unsafe { mtproxy_ffi_net_connections_mpq_pop_nw((*socket).out_packet_queue, 4) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:867:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:873:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:882:    let socket = unsafe { socket_conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:885:        if !mtproxy_core::runtime::net::connections::socket_reader_should_run(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:890:        if unsafe { TCP_RECV_BUFFERS_NUM } == 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:891:            unsafe { prealloc_tcp_buffers_impl() };
rust/mtproxy-ffi/src/net_connections/runtime.rs:894:        let in_msg = unsafe { libc::malloc(size_of::<RawMessage>()).cast::<RawMessage>() };
rust/mtproxy-ffi/src/net_connections/runtime.rs:896:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:900:        let s = unsafe { TCP_RECV_BUFFERS_TOTAL_SIZE };
rust/mtproxy-ffi/src/net_connections/runtime.rs:904:        unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:906:        let r_isize = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:914:            unsafe { *libc::__errno_location() }
rust/mtproxy-ffi/src/net_connections/runtime.rs:918:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:937:            unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:939:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:945:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:953:            unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:959:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:966:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:970:        let mut mp = unsafe { new_msg_part(ptr::null_mut(), TCP_RECV_BUFFERS[p - 1]) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:972:        let first_len = c_int::try_from(unsafe { TCP_RECV_IOVEC[p].iov_len }).unwrap_or(c_int::MAX);
rust/mtproxy-ffi/src/net_connections/runtime.rs:973:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:977:        let mut rem = r - unsafe { (*mp).data_end };
rust/mtproxy-ffi/src/net_connections/runtime.rs:978:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:988:            let next = unsafe { new_msg_part(ptr::null_mut(), TCP_RECV_BUFFERS[p - 1]) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:991:                c_int::try_from(unsafe { TCP_RECV_IOVEC[p].iov_len }).unwrap_or(c_int::MAX);
rust/mtproxy-ffi/src/net_connections/runtime.rs:992:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1007:            let x = unsafe { alloc_msg_buffer(TCP_RECV_BUFFERS[i], TCP_RECV_BUFFER_SIZE) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1009:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1014:            let chunk = unsafe { (*x).chunk };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1016:            let buffer_size = unsafe { (*chunk).buffer_size };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1018:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1025:        let conn_job = unsafe { (*socket).conn };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1027:        let conn = unsafe { conn_info(conn_job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1028:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1037:    let socket = unsafe { socket_conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1038:    let out = unsafe { ptr::addr_of_mut!((*socket).out) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1039:    let check_watermark = unsafe { (*out).total_bytes >= (*socket).write_low_watermark };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1041:    let stop = unsafe { (*socket).flags & C_STOPWRITE };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1044:        if !mtproxy_core::runtime::net::connections::socket_writer_should_run(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1050:        if unsafe { (*out).total_bytes } == 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1051:            unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1061:        let s = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1071:        unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1073:        let r_isize = unsafe { libc::writev((*socket).fd, iov.as_ptr(), iovcnt) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1074:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1079:            unsafe { *libc::__errno_location() }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1088:                unsafe { (*socket).eagain_count },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1100:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1105:            unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1107:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1113:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1122:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1130:            unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1132:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1138:        if unsafe { verbosity > 0 && r < 0 && write_errno != libc::EAGAIN } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1139:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1147:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1150:            let data_sent = unsafe { (*(*socket).type_).data_sent };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1152:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1162:            unsafe { (*out).total_bytes },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1163:            unsafe { (*socket).write_low_watermark },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1166:        if let Some(ready_to_write) = unsafe { (*(*socket).type_).ready_to_write } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1167:            unsafe { ready_to_write(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1174:            unsafe { (*socket).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1177:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1184:    unsafe { (*out).total_bytes }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1189:    let socket = unsafe { socket_conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1196:        unsafe { fail_socket_connection_impl(c, abort_who) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1201:        let run_flags = unsafe { (*socket).flags };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1204:            let type_ = unsafe { (*socket).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1206:            let read_write = unsafe { (*type_).socket_read_write };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1208:            let res = unsafe { read_write.unwrap()(job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1212:                unsafe { (*socket).current_epoll_status },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1214:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1224:        if mtproxy_core::runtime::net::connections::socket_job_aux_should_update_epoll(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1228:                unsafe { (*socket).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1231:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1239:        assert_eq!(unsafe { (*c.cast::<AsyncJob>()).j_refcnt }, 1);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1240:        let type_ = unsafe { (*socket).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1242:        let socket_free = unsafe { (*type_).socket_free };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1244:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1254:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1260:    let s = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1272:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1275:    let socket = unsafe { socket_conn_info(s) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1279:            unsafe { (*conn).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1283:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1297:    let fd_u = usize::try_from(unsafe { (*socket).fd }).unwrap_or(MAX_EVENTS);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1299:    let ev = unsafe { ptr::addr_of_mut!(Events[fd_u]) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1300:    assert!(unsafe { (*ev).data }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:1301:    assert_eq!(unsafe { (*ev).refcnt }, 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1302:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1341:        unsafe { conn_target_info(ctj) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1346:        unsafe { listen_conn_info(lcj) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1349:    let mut flags = if unsafe { libc::fcntl(cfd, libc::F_GETFL, 0) } < 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1354:    if flags != 0 || unsafe { libc::fcntl(cfd, libc::F_SETFL, flags | libc::O_NONBLOCK) } < 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1355:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1364:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1373:    if unsafe { tcp_maximize_buffers } != 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1374:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1380:    let max_connection_fd = unsafe { mtproxy_ffi_net_connections_get_max_connection_fd() };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1385:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1394:        unsafe { mtproxy_ffi_net_connections_get_max_connection() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1396:    unsafe { mtproxy_ffi_net_connections_set_max_connection(updated_max) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1398:    let c = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1414:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1415:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1423:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1435:    assert!(!unsafe { (*conn).type_ }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:1437:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1445:        a4: unsafe { core::mem::zeroed() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1448:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1463:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1468:    if unsafe { self_addr.a4.sin_family as c_int } == libc::AF_INET {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1469:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1475:        assert_eq!(unsafe { self_addr.a6.sin6_family as c_int }, libc::AF_INET6);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1476:        if is_4in6(unsafe { &self_addr.a6.sin6_addr.s6_addr }) && is_4in6(&peer_ipv6_v) {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1477:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1483:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1491:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1498:        unsafe { (*(*conn).type_).init_outbound }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1500:        unsafe { (*(*conn).type_).init_accepted }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1504:    if unsafe { init_fn.unwrap()(c) } >= 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1520:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1535:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1541:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1548:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1554:                        unsafe { (*lc).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1556:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1563:                        unsafe { atomic_i32(ptr::addr_of_mut!(active_special_connections)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1569:                            unsafe { max_special_connections },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1579:                        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1586:            if unsafe { (*conn).window_clamp } != 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1587:                let clamp = unsafe { (*conn).window_clamp };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1588:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1600:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1608:        mtproxy_core::runtime::net::connections::alloc_connection_failure_action(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1622:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1627:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1635:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1641:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1648:        unsafe { mtproxy_ffi_net_connections_job_thread_dec_jobs_active() };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1654:    let listening = unsafe { listen_conn_info(lcj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1657:        let fd_u = usize::try_from(unsafe { (*listening).fd }).unwrap_or(MAX_EVENTS);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1659:        if (unsafe { Events[fd_u].state } & EVT_IN_EPOLL) == 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1664:            a4: unsafe { core::mem::zeroed() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1667:        let cfd = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1677:                unsafe { mtproxy_ffi_net_connections_stats_add(0, 1, 0, 0) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1682:        unsafe { mtproxy_ffi_net_connections_stats_add(0, 0, 1, 0) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1684:        let max_accept_rate = unsafe { mtproxy_ffi_net_connections_accept_rate_get_max() };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1688:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1697:                    unsafe { mtproxy_ffi_net_connections_precise_now() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1701:            unsafe { mtproxy_ffi_net_connections_accept_rate_set_state(new_remaining, new_time) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1703:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1711:        if (unsafe { (*listening).flags } & C_IPV6) != 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1716:            assert_eq!(unsafe { peer.a6.sin6_family as c_int }, libc::AF_INET6);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1722:            assert_eq!(unsafe { peer.a4.sin_family as c_int }, libc::AF_INET);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1725:        let family = unsafe { peer.a4.sin_family as c_int };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1727:            let peer_a4 = unsafe { peer.a4 };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1730:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1744:            let peer_a6 = unsafe { peer.a6 };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1747:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1763:            let conn_info_ptr = unsafe { conn_info(conn) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1764:            assert!(!unsafe { (*conn_info_ptr).io_conn }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:1765:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1781:    if unsafe { check_conn_functions_impl(type_, 1) } < 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1785:    let max_connection_fd = unsafe { mtproxy_ffi_net_connections_get_max_connection_fd() };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1790:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1800:    let max_connection = unsafe { mtproxy_ffi_net_connections_get_max_connection() };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1805:    unsafe { mtproxy_ffi_net_connections_set_max_connection(updated_max) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1809:    let lcj = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1821:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1825:    let listening = unsafe { listen_conn_info(lcj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1826:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1835:    let ev = unsafe { ptr::addr_of_mut!(Events[fd_u]) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1836:    assert!(unsafe { (*ev).data }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:1837:    assert_eq!(unsafe { (*ev).refcnt }, 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1838:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1859:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1868:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1872:        let rc = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1884:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1889:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1894:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1913:    unsafe { init_listening_connection_ext_impl(fd, type_, extra, 0, -10) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1922:    unsafe { init_listening_connection_ext_impl(fd, type_, extra, mode, -10) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:1930:    let listening = unsafe { listen_conn_info(job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1934:        unsafe { net_accept_new_connections_impl(job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1938:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:1948:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1955:            mtproxy_core::runtime::net::connections::conn_job_run_actions(unsafe { (*conn).flags });
rust/mtproxy-ffi/src/net_connections/runtime.rs:1958:                assert!((unsafe { (*conn).flags } & C_CONNECTED) != 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:1959:                unsafe { mtproxy_ffi_net_connections_conn_job_ready_pending_activate(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1962:                    unsafe { (*conn).status },
rust/mtproxy-ffi/src/net_connections/runtime.rs:1964:                    let status_atomic = unsafe { atomic_i32(ptr::addr_of_mut!((*conn).status)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1979:                let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1981:                let connected = unsafe { (*type_).connected };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1983:                unsafe { connected.unwrap()(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1987:            let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1989:            let read_write = unsafe { (*type_).read_write };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1991:            unsafe { read_write.unwrap()(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:1997:        let timer_check_ok = unsafe { job_timer_check(job) != 0 };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2000:            unsafe { (*conn).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2002:            let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2004:            let alarm = unsafe { (*type_).alarm };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2006:            unsafe { alarm.unwrap()(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2013:            mtproxy_core::runtime::net::connections::conn_job_abort_has_error(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2017:        let old_flags = unsafe { atomic_i32(ptr::addr_of_mut!((*conn).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2020:            let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2022:            let close = unsafe { (*type_).close };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2024:            unsafe { close.unwrap()(c, 0) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2030:        assert_eq!(unsafe { (*c.cast::<AsyncJob>()).j_refcnt }, 1);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2031:        let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2033:        let free_cb = unsafe { (*type_).free };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2035:        unsafe { free_cb.unwrap()(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2036:        return unsafe { mtproxy_ffi_net_connections_job_free(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2044:    let socket = unsafe { socket_conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2047:        mtproxy_core::runtime::net::connections::socket_read_write_connect_action(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2055:            unsafe { (*socket).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2060:        unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2062:        unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2064:        let conn = unsafe { conn_info((*socket).conn) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2065:        unsafe { atomic_i32(ptr::addr_of_mut!((*conn).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2068:        let type_ = unsafe { (*socket).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2070:        if let Some(socket_connected) = unsafe { (*type_).socket_connected } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2071:            unsafe { socket_connected(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2073:        unsafe { job_signal_create_pass((*socket).conn, JS_RUN) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2080:    while mtproxy_core::runtime::net::connections::socket_reader_should_run(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2083:        let type_ = unsafe { (*socket).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2085:        let socket_reader = unsafe { (*type_).socket_reader };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2087:        unsafe { socket_reader.unwrap()(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2091:        let raw = unsafe { mtproxy_ffi_net_connections_mpq_pop_nw((*socket).out_packet_queue, 4) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2096:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2102:    if unsafe { (*socket).out.total_bytes } != 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2103:        unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2107:    while mtproxy_core::runtime::net::connections::socket_writer_should_run(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2110:        let type_ = unsafe { (*socket).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2112:        let socket_writer = unsafe { (*type_).socket_writer };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2114:        unsafe { socket_writer.unwrap()(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2117:    mtproxy_core::runtime::net::connections::compute_conn_events(unsafe { (*socket).flags }, true)
rust/mtproxy-ffi/src/net_connections/runtime.rs:2130:    let socket = unsafe { socket_conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2133:    assert!(!unsafe { (*socket).type_ }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:2135:    if (unsafe { (*event).ready } & EVT_FROM_EPOLL) != 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2136:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2141:            unsafe { (*event).state },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2142:            unsafe { (*event).ready },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2145:        unsafe { atomic_i32(ptr::addr_of_mut!((*socket).flags)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2149:            (unsafe { (*event).epoll_ready } & libc::EPOLLERR as c_int) != 0,
rust/mtproxy-ffi/src/net_connections/runtime.rs:2150:            (unsafe { (*event).epoll_ready }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2158:            unsafe { job_signal_create_pass(c, JS_ABORT) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2163:    unsafe { job_signal_create_pass(c, JS_RUN) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2168:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2170:        unsafe { (*conn).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2177:    unsafe { atomic_i32(ptr::addr_of_mut!((*conn).flags)) }.fetch_and(!C_ALARM, Ordering::SeqCst);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2179:        unsafe { job_timer_insert(c, mtproxy_ffi_net_connections_precise_now() + timeout) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2181:        unsafe { job_timer_remove(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2187:    unsafe { set_connection_timeout_impl(c, 0.0) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2191:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2193:        unsafe { atomic_i32(ptr::addr_of_mut!((*conn).flags)) }.fetch_or(C_ERROR, Ordering::SeqCst);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2195:        mtproxy_core::runtime::net::connections::fail_connection_action(previous_flags, unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2200:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2205:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2210:        unsafe { job_signal_create_pass(c, JS_ABORT) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2215:    assert_eq!(unsafe { (*c.cast::<AsyncJob>()).j_refcnt }, 1);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2216:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2218:    assert!((unsafe { (*conn).flags } & C_ERROR) != 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2219:    assert!((unsafe { (*conn).flags } & C_FAILED) != 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2220:    assert!(unsafe { (*conn).target.is_null() });
rust/mtproxy-ffi/src/net_connections/runtime.rs:2221:    assert!(unsafe { (*conn).io_conn.is_null() });
rust/mtproxy-ffi/src/net_connections/runtime.rs:2224:        let raw = unsafe { mtproxy_ffi_net_connections_mpq_pop_nw((*conn).out_queue, 4) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2229:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2234:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2240:        let raw = unsafe { mtproxy_ffi_net_connections_mpq_pop_nw((*conn).in_queue, 4) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2245:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2250:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2255:    let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2257:    if let Some(crypto_free) = unsafe { (*type_).crypto_free } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2258:        unsafe { crypto_free(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2261:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2267:        mtproxy_core::runtime::net::connections::free_connection_allocated_deltas(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2270:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2277:    let free_buffers = unsafe { (*type_).free_buffers };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2279:    unsafe { free_buffers.unwrap()(c) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2283:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2285:    assert!((unsafe { (*conn).flags } & C_ERROR) != 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2286:    assert_eq!(unsafe { (*conn).status }, CONN_ERROR);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2287:    assert!((unsafe { (*conn).flags } & C_FAILED) != 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:2291:            unsafe { (*conn).error },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2292:            unsafe { (*conn).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2294:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2302:    if mtproxy_core::runtime::net::connections::close_connection_has_isdh(unsafe { (*conn).flags })
rust/mtproxy-ffi/src/net_connections/runtime.rs:2304:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2310:    let io_conn = unsafe { (*conn).io_conn };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2312:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2325:        unsafe { (*conn).basic_type },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2326:        unsafe { (*conn).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2327:        unsafe { !(*conn).target.is_null() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2329:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2340:        let target = unsafe { (*conn).target };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2342:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2348:    if mtproxy_core::runtime::net::connections::close_connection_has_special(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2351:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2355:            unsafe { atomic_i32(ptr::addr_of_mut!(active_special_connections)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2359:            unsafe { max_special_connections },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2361:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2367:    unsafe { job_timer_remove(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2374:    let ev = unsafe { ptr::addr_of_mut!(Events[fd_u]) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2376:    let new_refcnt = unsafe { atomic_i64(ptr::addr_of_mut!((*ev).refcnt)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2382:        unsafe { !(*ev).data.is_null() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2384:        let socket_job = unsafe { (*ev).data };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2385:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2400:    let ev = unsafe { ptr::addr_of_mut!(Events[fd_u]) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2401:    if (unsafe { (*ev).refcnt as c_int }) == 0 || unsafe { (*ev).data.is_null() } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2405:    let refcnt = unsafe { atomic_i64(ptr::addr_of_mut!((*ev).refcnt)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2419:    let socket_job = unsafe { job_incref((*ev).data) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2421:    unsafe { connection_event_incref_impl(fd, -1) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2424:        unsafe { (*socket_job_struct).j_execute == Some(do_listening_connection_job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2425:    let is_socket_job = unsafe { (*socket_job_struct).j_execute == Some(do_socket_connection_job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2427:        unsafe { (*socket_conn_info(socket_job)).flags }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2442:    let socket = unsafe { socket_conn_info(socket_job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2444:        unsafe { job_decref_pass(socket_job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2449:    let conn = unsafe { (*socket).conn };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2451:    let out = unsafe { job_incref(conn) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2452:    unsafe { job_decref_pass(socket_job) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2460:    let conn = unsafe { connection_get_by_fd_impl(fd) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2465:    let c = unsafe { conn_info(conn) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2467:        unsafe { (*c).generation },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2471:        unsafe { job_decref_pass(conn) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2478:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2480:        unsafe { (*conn).status },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2481:        unsafe { (*conn).ready },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2484:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2495:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2496:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2508:    if type_.is_null() || unsafe { (*type_).magic != CONN_FUNC_MAGIC } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2513:        unsafe { !(*type_).title.is_null() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2514:        unsafe { (*type_).socket_read_write.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2515:        unsafe { (*type_).socket_reader.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2516:        unsafe { (*type_).socket_writer.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2517:        unsafe { (*type_).socket_close.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2518:        unsafe { (*type_).close.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2519:        unsafe { (*type_).init_outbound.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2520:        unsafe { (*type_).wakeup.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2521:        unsafe { (*type_).alarm.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2522:        unsafe { (*type_).connected.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2523:        unsafe { (*type_).flush.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2524:        unsafe { (*type_).check_ready.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2525:        unsafe { (*type_).read_write.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2526:        unsafe { (*type_).free.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2527:        unsafe { (*type_).socket_connected.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2528:        unsafe { (*type_).socket_free.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2532:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2537:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2542:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2547:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2552:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2559:        unsafe { (*type_).accept.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2560:        unsafe { (*type_).init_accepted.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2564:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2569:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2574:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2579:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2585:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2590:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2595:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2600:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2605:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2610:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2615:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2620:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2625:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2630:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2635:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2642:            (unsafe { (*type_).flags } & C_RAWMSG) != 0,
rust/mtproxy-ffi/src/net_connections/runtime.rs:2643:            unsafe { (*type_).free_buffers.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2644:            unsafe { (*type_).reader.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2645:            unsafe { (*type_).writer.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2646:            unsafe { (*type_).parse_execute.is_some() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2649:    if (unsafe { (*type_).flags } & C_RAWMSG) != 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2651:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2656:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2664:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2684:    let target = unsafe { conn_target_info(ct) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2686:        unsafe { (*target).reconnect_timeout },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2687:        unsafe { (*target).next_reconnect_timeout },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2688:        unsafe { (*target).active_outbound_connections },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2689:        unsafe { mtproxy_ffi_net_connections_precise_now() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2690:        unsafe { drand48_j() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2692:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2700:    let selected_slot = unsafe { (*ctx).selected };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2701:    let allow_stopped = unsafe { (*ctx).allow_stopped != 0 };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2702:    let has_selected = unsafe { !(*selected_slot).is_null() };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2704:        unsafe { conn_info(*selected_slot) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2709:        unsafe { (*selected).ready }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2714:    let candidate = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2715:    let type_ = unsafe { (*candidate).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2717:    let check_ready = unsafe { (*type_).check_ready };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2719:    let candidate_ready = unsafe { check_ready.unwrap()(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2722:        unsafe { (*selected).unreliability }
rust/mtproxy-ffi/src/net_connections/runtime.rs:2732:        unsafe { (*candidate).unreliability },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2744:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2756:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2757:    let type_ = unsafe { (*conn).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2759:    let check_ready = unsafe { (*type_).check_ready };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2761:    let cr = unsafe { check_ready.unwrap()(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2765:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2774:    let conn = unsafe { conn_info(c) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2776:        unsafe { !(*selected).is_null() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2777:        unsafe { (*conn).flags },
rust/mtproxy-ffi/src/net_connections/runtime.rs:2780:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2806:    let mut prev: *mut ConnTargetJob = unsafe { ptr::addr_of_mut!(HTarget[bucket]) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2808:        let cur = unsafe { *prev };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2812:        let s = unsafe { conn_target_info(cur) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2813:        if unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2824:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2844:        prev = unsafe { ptr::addr_of_mut!((*s).hnext) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2849:        let new_target_info = unsafe { conn_target_info(new_target) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2850:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2887:    let mut prev: *mut ConnTargetJob = unsafe { ptr::addr_of_mut!(HTarget[bucket]) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2889:        let cur = unsafe { *prev };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2893:        let s = unsafe { conn_target_info(cur) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2894:        if unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2906:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2926:        prev = unsafe { ptr::addr_of_mut!((*s).hnext) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2931:        let new_target_info = unsafe { conn_target_info(new_target) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2932:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2950:    unsafe { fail_connection_impl(c, -17) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2954:    let target = unsafe { conn_target_info(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2955:    let mut tree = unsafe { get_tree_ptr_connection(ptr::addr_of_mut!((*target).conn_tree)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2959:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2970:        let conn = unsafe { conn_info(bad_conn) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2972:            mtproxy_core::runtime::net::connections::target_remove_dead_connection_deltas(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2975:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2987:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:2998:    let was_ready = unsafe { (*target).ready_outbound_connections };
rust/mtproxy-ffi/src/net_connections/runtime.rs:2999:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3003:        mtproxy_core::runtime::net::connections::target_ready_transition(was_ready, unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3006:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3011:        tree != unsafe { (*target).conn_tree },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3016:        unsafe { tree_free_connection(tree) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3022:        let old = unsafe { (*target).conn_tree };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3023:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3033:    let target = unsafe { conn_target_info(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3034:    assert!(!unsafe { (*target).type_ }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:3036:        unsafe { (*target).global_refcnt },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3037:        unsafe { !(*target).conn_tree.is_null() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3045:        unsafe { tree_act_connection((*target).conn_tree, Some(target_fail_connection_callback)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3052:    unsafe { job_timer_remove(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3057:    unsafe { destroy_dead_target_connections_impl(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3058:    let target = unsafe { conn_target_info(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3064:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3074:    let was_ready = unsafe { (*target).ready_outbound_connections };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3075:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3079:        mtproxy_core::runtime::net::connections::target_ready_transition(was_ready, unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3082:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3087:        unsafe { (*target).min_connections },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3088:        unsafe { (*target).max_connections },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3092:    assert!(need_c <= unsafe { (*target).max_connections });
rust/mtproxy-ffi/src/net_connections/runtime.rs:3095:        unsafe { mtproxy_ffi_net_connections_precise_now() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3096:        unsafe { (*target).next_reconnect },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3097:        unsafe { (*target).active_outbound_connections },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3099:        let mut tree = unsafe { get_tree_ptr_connection(ptr::addr_of_mut!((*target).conn_tree)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3101:        while unsafe { (*target).outbound_connections < need_c } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3103:                mtproxy_core::runtime::net::connections::target_connect_socket_action(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3109:                unsafe { client_socket((*target).target.s_addr, (*target).port, 0) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:3111:                unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3119:            let conn = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3141:            let conn_info_ptr = unsafe { conn_info(conn) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3142:            assert!(!unsafe { (*conn_info_ptr).io_conn }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:3144:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3152:                tree != unsafe { (*target).conn_tree },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3157:            unsafe { tree_free_connection(tree) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3163:            let old = unsafe { (*target).conn_tree };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3164:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3171:        unsafe { compute_next_reconnect_target_impl(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3178:    let target = unsafe { conn_target_info(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3180:    assert!(!unsafe { (*target).type_ }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:3181:    assert!(unsafe { (*target).global_refcnt } > 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:3183:    let r = unsafe { atomic_i32(ptr::addr_of_mut!((*target).global_refcnt)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:3188:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3193:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3197:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3211:    if unsafe { check_conn_functions_impl((*source).type_, 0) } < 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3215:    let lock_rc = unsafe { libc::pthread_mutex_lock(ptr::addr_of_mut!(TargetsLock)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3218:    let source_ref = unsafe { &*source };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3226:        mtproxy_core::runtime::net::connections::TargetLookupFamily::Ipv4 => unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3236:        mtproxy_core::runtime::net::connections::TargetLookupFamily::Ipv6 => unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3253:        let t_info = unsafe { conn_target_info(t) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3254:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3260:        let old_global_refcnt = unsafe { atomic_i32(ptr::addr_of_mut!((*t_info).global_refcnt)) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:3267:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3274:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3278:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3291:        let t_new = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3303:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3307:        let t_info = unsafe { conn_target_info(t_new) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3308:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3315:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3331:            mtproxy_core::runtime::net::connections::TargetLookupFamily::Ipv4 => unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3341:            mtproxy_core::runtime::net::connections::TargetLookupFamily::Ipv6 => unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3354:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3358:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3365:    let unlock_rc = unsafe { libc::pthread_mutex_unlock(ptr::addr_of_mut!(TargetsLock)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3371:    let lock_rc = unsafe { libc::pthread_mutex_lock(ptr::addr_of_mut!(TargetsLock)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3374:    let target = unsafe { conn_target_info(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3376:        unsafe { (*target).global_refcnt },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3377:        unsafe { !(*target).conn_tree.is_null() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3378:        unsafe { (*target).target.s_addr != 0 },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3381:        let unlock_rc = unsafe { libc::pthread_mutex_unlock(ptr::addr_of_mut!(TargetsLock)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3394:    assert!(!unsafe { (*target).type_ }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:3395:    assert_eq!(unsafe { (*target).global_refcnt }, 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:3396:    assert!(unsafe { (*target).conn_tree.is_null() });
rust/mtproxy-ffi/src/net_connections/runtime.rs:3400:            let ad = unsafe { (*target).target };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3401:            let port = unsafe { (*target).port };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3402:            let type_ = unsafe { (*target).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3403:            let extra = unsafe { (*target).extra };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3404:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3411:            let removed = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3424:            let ad_ipv6 = unsafe { (*target).target_ipv6 };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3425:            let port = unsafe { (*target).port };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3426:            let type_ = unsafe { (*target).type_ };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3427:            let extra = unsafe { (*target).extra };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3428:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3435:            let removed = unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3449:    let unlock_rc = unsafe { libc::pthread_mutex_unlock(ptr::addr_of_mut!(TargetsLock)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3452:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3460:    if unsafe { epoll_fd } <= 0 {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3461:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3472:    let target = unsafe { conn_target_info(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3482:            unsafe { job_timer_check(job) != 0 }
rust/mtproxy-ffi/src/net_connections/runtime.rs:3493:        let update_mode = mtproxy_core::runtime::net::connections::target_job_update_mode(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3497:            unsafe { destroy_dead_target_connections_impl(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3498:            unsafe { clean_unused_target_impl(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3499:            unsafe { compute_next_reconnect_target_impl(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3502:            unsafe { create_new_connections_impl(ctj) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3506:            (unsafe { (*ctj.cast::<AsyncJob>()).j_flags } & JF_COMPLETED) != 0,
rust/mtproxy-ffi/src/net_connections/runtime.rs:3507:            unsafe { (*target).global_refcnt },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3508:            unsafe { !(*target).conn_tree.is_null() },
rust/mtproxy-ffi/src/net_connections/runtime.rs:3517:            unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3528:            mtproxy_core::runtime::net::connections::target_job_finalize_decision(unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3535:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3542:        assert!((unsafe { (*ctj.cast::<AsyncJob>()).j_flags } & JF_COMPLETED) != 0);
rust/mtproxy-ffi/src/net_connections/runtime.rs:3543:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3563:    let target = unsafe { conn_target_info(ct) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3564:    let tree = unsafe { get_tree_ptr_connection(ptr::addr_of_mut!((*target).conn_tree)) };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3571:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3580:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3584:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3592:    if unsafe { FREE_LATER_QUEUE.is_null() } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3593:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3596:        assert!(!unsafe { FREE_LATER_QUEUE }.is_null());
rust/mtproxy-ffi/src/net_connections/runtime.rs:3598:    unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3605:    if unsafe { FREE_LATER_QUEUE.is_null() } {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3609:        let f = unsafe { mtproxy_ffi_net_connections_mpq_pop_nw(FREE_LATER_QUEUE, 4) }
rust/mtproxy-ffi/src/net_connections/runtime.rs:3614:        unsafe {
rust/mtproxy-ffi/src/net_connections/runtime.rs:3617:        let free_fn = unsafe { (*f).free };
rust/mtproxy-ffi/src/net_connections/runtime.rs:3619:        unsafe {
